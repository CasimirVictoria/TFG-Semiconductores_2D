\documentclass[12pt]{article} %,twoside,a4paper

\usepackage[a4paper,margin=24.5mm]{geometry} %\usepackage[left=2cm,right=2cm,top=1.5cm, bottom=2cm]

\usepackage[utf8]{inputenc}
\usepackage[english,catalan]{babel}
%%%\usepackage[english,spanish]{babel}
\usepackage{natbib}
\usepackage{float} 
\usepackage{graphicx}


% Establim el format de la p√†gina:
%\usepackage{fancyhdr}

%\setlength{\parskip}{0.2cm}
%\usepackage[T1]{fontenc}
%\usepackage{newunicodechar}
%\newunicodechar{ƒø}{\L.}
%\newunicodechar{≈Ä}{\l.}
\usepackage{siunitx}
\usepackage{amsmath}
%\usepackage{adjustbox}
%\usepackage{tabularx}
\usepackage{mathtools}
\usepackage{color}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[colorlinks=true,urlcolor=blue,linkcolor=blue,citecolor=blue]{hyperref}
%\usepackage{booktabs} %Publication quality tables in LaTeX.
%\usepackage{pdflscape}
%\usepackage{attachfile}
\usepackage{todonotes}
%\usepackage{pdfpages}

\usepackage{sagetex}
%\definecolor{gris}{RGB}{220,220,220}
\let\vec\mathbf %vectors en negreta en compte de arrow

\author{Casimiro Victoria Castillo}


\begin{document}

\newgeometry{margin=1in}
\begin{titlepage}
   \noindent\raisebox{0pt}[0pt][0pt]{
	\includegraphics[width=10.5cm]{./portada-TFG-LaTeX/marca-Facultat-Fisica-UV-1-linia.pdf}}\par
   \vspace{8.5cm}
   % Titles
   {\centering
      \scalebox{1.125}{\bfseries\sffamily\Huge
		Treball de Fi de Grau en F√≠sica}\par
      \rule{16.13cm}{1.5pt}\par
      \vspace{4.5cm}
      {\bfseries\sffamily\LARGE Fonons i espectrosc√≤pia Ramman en semiconductors bidimensionals}\par
   }
   \vfill
   {\raggedleft\sffamily
		AGOST de 2021\par
      \vspace{\baselineskip}
		Alumne/a: Casimiro Victoria Castillo\par
      \vspace{\baselineskip}
		Tutor/a (1): Alberto Garc√≠a Crist√≥bal\par
		Tutor/a (2): Alejandro Molina Sanchez\par
   }
\end{titlepage}
\restoregeometry

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{abstract}
\subsection*{Resum / \emph{Abstract}}

Els materials bidimensionals ($2D$) com el graf√® s√≥n de gran inter√®s tant per les seues propietats f√≠siques exclusives com per les seues aplicacions potencials. L'estudi de la din√†mica de la xarxa cristal¬∑lina (\textit{fonons}) d'estos materials √©s un requisit previ per entendre la seua estabilitat estructural i propietats t√®rmiques, aix√≠ com les seues propietats de transport i √≤ptiques.   


Este Treball de Fi de Grau consisteix en la computaci√≥ dels modes vibracionals de materials semiconductors 2D y la seua correlaci√≥ amb els observables rellevants per a la interpretaci√≥ dels experiments de dispersi√≥ de la llum.
\vspace{\baselineskip}

\begin{otherlanguage}{english}\itshape

\noindent Abstract\ldots
The long-range character of the dynamical matrix limits the validity of
force-constant approaches that take only interaction with few neighboring atoms into account. However, by fitting the force-
constants to the ab initio dispersion relation, we show that the popular 4th-nearest-neighbor force-constant approach yields an
excellent fit for the low frequency modes and a moderately good fit (with a 
maximum deviation of $6 \%$) for the high-frequency modes \cite{wirtz04_phonon_disper_graph_revis}
\end{otherlanguage}

%\textit{Nota: s'ajunta el codi font del document: \attachfile[author=Casimir]{TFG-Casimir.tex}}

%\newpage
%\end{abstract}

\section{Introducci√≥}

En este treball s'empra el m√®tode de constants de for√ßa (\emph{FCM} per les seues sigles en angl√©s, \foreignlanguage{english}{force constant method}), per descriure la din√†mica reticular de un material bidimensional, el nitrur de bor monocapa, \emph{BN}.\\

En este model la din√†mica dels √†toms es descriu per un conjunt de simples constants de for√ßa de molls que conecten cada √†tom amb els del seu entorn, fins a un nombre determinat de ve√Øns. Altres m√©todes com els c√†lculs realitzats a partir de primers principis (\emph{ab initio}) emprant la teor√≠a del funcional densitat (DFT, per les seues sigles en angl√©s \foreignlanguage{english}{density-functional density}) o el m√®tode de camp de for√ßa de val√®ncia (\emph{VFF}, \foreignlanguage{english}{valence force field}) necessiten temps de c√†lcul molt m√©s llargs. El m√©tode de constants de for√ßa empra un conjunt redu√Øt de par√°metres que poden ajustar-se a les mesures experimentals o b√©, com s'ha fet en este treball, a la relaci√≥ de dispersi√≥ calculada per primers principis.  I encara que estem tractant amb un m√®tode sencill, este ha demostat que pot proporcionar resultats fiables \cite{wirtz04_phonon_disper_graph_revis}.


\subsection{Xarxa cristal¬∑lina}

Abans d'explicar el m√®tode emprat en este treball repassem alguns conceptes i aclarim la notaci√≥ emprada.

Sabem que els √†toms que constitueixen un s√≤lid cristal¬∑l√≠ estan distribu√Øts de una manera regular en l'espai, y per descriure esta distribuci√≥ regular s'empra el concepte matem√†tic de \emph{xarxa cristal¬∑lina}, introdu√Øt per A. Bravais en 1845: una xarxa cristal¬∑lina es defineix com una distribuci√≥ discreta i regular de punts que t√© sempre la mateixa aparen√ßa independentment de quin punt escollim com origen de coordenades.

En el cas que anem a tractar, un cristall bidimensional, la xarxa cristal¬∑lina bidimensional pot generar-se a partir de dos vectors base, de manera que els vectors de posici√≥ dels \emph{nucs de la xarxa}, els vectors de translaci√≥ cristal¬∑lina,  tenen la forma:
\begin{equation}
 \vec R_\vec l=\vec R_{l_1 l_2}=l_1 \vec a_1 +l_2\vec a_2
\end{equation}

on $\vec l$ es denomina √≠ndex del nuc.

Els cristalls o \emph{estructures cristallines} s√≥n distribucions regulars d'√†toms en l'espai de posicions i els podem descriure associant a cadascun dels nucs d'una xarxa cristallina en l'espai de posicions un conjunt d'√†toms o base (\emph{producte de convoluci√≥ de la base y la xarxa de nucs}. En el cas del \emph{BN} tractem amb una base diat√≤mica. 

\subsubsection{Xarxa rec√≠proca. Primera zona de Brillouin.}
Donat un conjunt de vectors base primitius, $p_i$, de la xarxa cristalina en l'espai de posicions, la condici√≥:

\begin{equation}
\label{eq:rec1}
\vec p_i\cdot\vec p_j^{*}=\delta_{ij}
\end{equation}

on $\delta_{ij}$ √©s la delta de Kronecker, defineix un altre conjunt de vector $p_j^*$, coneguts com vectors primitius rec√≠procs, i qu√® son els vectors primitius que defineixen una altra xarxa coneguda com coneguda com \textit{xarxa rec√≠proca}. Els  vectors rec√≠procs, i els vectors de translaci√≥ cristal¬∑lina rec√≠procs, tenen dimensions de inversa de longitud i es representen en l'\textit{espai rec√≠proc} o de n√∫meros d'ona. \textbf{Les xarxes cristal¬∑lines real y rec√≠proca s√≥n dues descripcions equivalents del mateix sistema f√≠sic: el s√≤lid cristal¬∑l√≠} que s'est√† estudiant.

L'espai $2\pi$-rec√≠proc √©s el fonamental en l'estudi dels s√≤lids cristal¬∑lins, ja que els estats de les part√≠cules i les interaccions f√≠siques de inter√©s es descriuen en l'espai de vectors d'ona, $\vec k$.



Podem interpretar que 

\begin{equation}
\label{eq:rec3}
\vec K_{h_1h_2}=2\pi\left(h_1\vec a_1^{*}+h_2\vec a_2^{*}\right)
\end{equation}

s√≥n els vectors de traslaci√≥ cristal¬∑lina que defineixen una xarxa cristal¬∑lina en aquest espai $2\pi$-rec√≠proc (s√≥ls es diferencia de l'espai rec√≠proc en un factor d'escala $2\pi$). En t√©rmes f√≠sics, l'espai $2\pi$-rec√≠proc √©s l'\emph{espai de vectors d'ona} $\vec k$, i a falta d'un factors d'escala $\hbar$, coincideix amb l'espai de moments  $\vec p=\hbar\vec k$. 

\paragraph{Cel¬∑les de Wigner-Seitz (WS) y primera zona de Brillouin (ZB)}

Per descriure la xarxa $2\pi$-rec√≠proca, emprarem el criteri de \textit{Wigner-Seitz}. Las \textit{cel¬∑les de Wigner-Seitz} estan centrades en un nuc de la xarxa i es defineixen com la regi√≥ m√©s pr√≤xima a un nuc (el del centre de la cel¬∑la) que a qualsevol altre. Per determinar la seua forma, partim d'un nuc qualsevol com a origen, constru√Øm els segments que uneixen este nuc amb els seus ve√Øns i es tracen els plans que bisecten cadascun d'estos segments: la cel¬∑la de WS √©s la cel¬∑la de menor volum al voltant de l'origen que est√† delimitada per estos plans (rectes en el caso d'una xarxa bidimensional).

Notem que en l'espai de $\vec k$ emprarem ce\l.les unitat de WS mentre que en l'espai de posicions sempre emprem ce\l.les unitat de Bravais.
La ce\l.la de WS de la xarxa $2\pi$-rec√≠proca es coneix com \textbf{primera zona de Brillouin} (ZB)


\subsection{Vibracions at√≤miques en cristalls}
\subsubsection{Model de BORN i VON KARMAN}
Els √†toms constituents de un s√≥lid cristall√≠ no estan imm√≤bils sino que vibren al voltant de la seua posici√≥ de equilibri.

En 1912, Born y Von Karman \cite{Born:1912:SRG} introduiren un model real√≠stic per de la din√°mica cristal¬∑lina, on la idea fonamental es que cada mode normal t√© l'energia de un oscil¬∑lador de Planck. La din√°mica del sistema es descriu de manera sencilla, no en termes de les vibracions de √†toms individuals, sino en termes de moviments col¬∑lectius en forma de ones viatgeres anomenades vibracions cristal¬∑lines (\foreignlanguage{english}{lattice vibrations}) per Born. Cada vibraci√≥ cristal¬∑lina es caracteritza per una freq√ºencia y un vector de ona.
La vibraci√≥ cristal¬∑lina quantitzada, o mode normal, s'anomena fon√≥ per analog√≠a amb el fot√≥. %i te propietats de quasi-part√≠cula

%Explicar el concepte de fon√≥ i la seua import√†ncia: Un fon√≥ √©s un mode de vibraci√≥ quantitzat que t√© lloc en una xarxa cristal¬∑lina. Els fonons tenen una gran import√†ncia en moltes propietats f√≠siques dels s√≤lids. Los fonons son una version mecano-qu√†ntica dels modes normals de vibraci√≥ de la mec√†nica cl√†ssica, on cada par de la xarxa osci\l.la amb la mateixa freq√º√®ncia. Aquests modes normals s√≥n importants perqu√® qualsevol moviment vibracional de la xarxa pot descriure's com una superposici√≥ de modes normals de distinta freq√º√®ncia, en este sentit s√≥n la base de les vibracions de la xarxa.

\subsubsection{Aproximaci√≥ adiab√†tica}

Moltes propietats f√≠siques dels s√≤lids poden classificar-se b√© com electr√≤niques o b√© com vibracionals segons estiguen determinades pels electrons (de val√®ncia) o per les vibracions dels √†toms (nuclis i√≤nics): normalment considerem els nuclis i els electrons com a constituent independents del s√≤lid, ja que les masses dels electrons i dels nuclis s√≥n tan diferents que el moviment dels nuclis √©s molt m√©s lent que el dels electrons. L'\emph{aproximaci√≥ adiab√†tica}, introdu√Øda per Born i Oppenheimer \cite{ANDP:ANDP19273892002} estableix que els electrons responen de manera pr√†cticament instant√†nia als despla√ßaments at√≤mics, de manera que el seu estat ve determinat per los posicions at√≥miques instant√†nies, mentre que els √†toms no poden respondre a les r√†pides variacions espacials dels electrons: diguem que els electrons segueixen el moviment i√≤nic adiab√†ticament.
%els electrons no realitzen transicions abruptes de un estat a altres estats, si no que un estat electr√≤nic es deforma progressivament degut als despla√ßaments i√≤nics.

Notem per√≤ que estem tractant amb una primera aproximaci√≥ al problema y algunes propietats f√≠siques venen determinades per la interacci√≥ entre els electrons y les vibracions at√≤miques.



%podem escriure l'energia potencial (o el Hamiltoni√†) como una suma de les distintes contribucions.
  
\subsubsection{Aproximaci√≥ harm√≤nica}

Les vibracions reticulars estan regides per les forces que experimenten els √†toms quan es desplacen de la seua posici√≥ d'equilibri. La primera hip√≤tesi √©s que cada √†tom t√© una posici√≥ d'equilibri en el cristall, que denotem per $\vec r^{(0)}_{\vec l,\vec\alpha}=\vec R_\vec l+\vec d_\alpha$ y considerarem que estos √†toms vibren al voltant d'esta posici√≥ d'equilibri, $\vec r_{\vec l,\vec\alpha}=\vec r^{(0)}_{\vec l,\vec\alpha}+\vec u_{\vec l,\alpha}(t)$, amb una amplitud menuda (en comparaci√≥ amb la dist√†ncia interat√≤mica) al voltant d'aquesta,   de manera que el s√≤lid es troba en estats que corresponen al que macrosc√≤picament es coneix com \textit{la regi√≥ de comportament el√†stic lineal}, on es verifica la llei de Hooke.

Podem per tant aproximar l'energia potencial de interacci√≥ pel terme harm√≤nic del seu desenvolupament en s√®rie de potencies del despla\c{c}ament:

Les equacions de moviment en l'aproximaci√≥ harm√≤nica s'escriuen en la coneguda forma:

\begin{equation}
 M_\alpha\vec{\ddot{u}}_{\vec l,\alpha}(t)=-\sum_{\vec l',\alpha'}\vec\Phi_{\alpha,\alpha'}\left(\vec R_\vec l-\vec R_\vec l'\right)\cdot\vec u_{\vec n',\alpha'}(t)
\end{equation}
 Aquesta equaci√≥ representa un sistema  d'oscil¬∑ladors harm√≤nics acoblats, on $\alpha$ i $\alpha'$ fan refer√®ncia al √†toms de la base considerats, l'√≠ndex vectorial $\vec l$ (que sol apar√®ixer en la literatura com $n$) √≠ndica el nuc considerat i $\vec R_\vec l$ √©s el vector de translaci√≥ cristal¬∑lina.
 
\vdots 




\subsubsection{Matriu din√†mica}

La matriu din√†mica √©s la magnitud central de la din√†mica reticular: les freq√º√®ncies dels fonons es calculen a partir dels valors propis de la matriu din√†mica:

\begin{equation}
\sum_{\alpha\prime}D_{\alpha\alpha\prime}(\vec q)\cdot\vec e_{\alpha\prime}(\vec q)=\omega^{2}\vec e_{\alpha}(\vec q)
\end{equation}   

Per tant, les freq√º√®ncies $\omega$ com funci√≥ del vector d'ones $\vec q$ del fon√≥ s√≥n soluci√≥ de l'equaci√≥ secular:

\begin{equation}
\det\left|\frac{1}{\sqrt{M_\alpha M_{\alpha\prime}}}D^{ij}_{\alpha\alpha\prime}\left(\vec q\right)-\omega^2\left(\vec q\right)\right|=0 
\end{equation}

on $M_{\alpha}$ es la massa de l'√†tom $\alpha$ y la matriu din√†mica ve definida por:

\begin{equation}
D_{\alpha,\alpha\prime}^{i,j}=\frac{\partial^2 E}{\partial u_{\alpha}^{*i}(\vec q)\partial u_{\alpha\prime}^{j}(\vec q)}
\label{eq:Matriz_Din√°mica}
\end{equation}

on $u_{\alpha}^{i}$ representa el despla\c{c}ament de l'√†tom $\alpha$ en la direcci√≥ $i$.

La segona derivada de l'energia de l'equaci√≥ \ref{eq:Matriz_Din√°mica} correspon al canvi en la for\c{c}a que actua sobre l'√†tom $\alpha\prime$ en la direcci√≥ $j$ quan es despla\c{c}a l'√†tom $\alpha$ en la direcci√≥ $i$

\begin{equation}
D_{\alpha\alpha\prime}^{ij}(\vec q)=\frac{\partial}{\partial u^{*\alpha}_{i}}F^{j}_{\alpha'}(\vec q)
\end{equation}

\vdots

Passem ara a descriure el sistema que volem estudiar


\newpage

\section{Descripci√≥ del cristall de BN}

Donat que el c√†lcul dels modes de vibraci√≥ comen\c{c}a per establir la geomeria del cristall en equilibri, comprobem amb les dades proporcionades que el $BN$ monocapa es tracta d'un cristall bidimensional hexagonal de base diat√≥mica, la ce\l.la unitat del qual ve donada per (dades proporcionades):

\begin{sagesilent}
var('a', domain='positive')
a_1=a*vector([1,0])
a_2=a*vector([-1/2,sqrt(3)/2])
\end{sagesilent}

\begin{equation}
\vec a_1=\sage{a_1}\qquad\vec a_2=\sage{a_2} 
\end{equation}

Podem comprobar que efectivament es tracta de una ce\l.la hexagonal, ja que els seus vectors primitius formen un angle de $\sage{arccos(a_1*a_2/(norm(a_1)*norm(a_2)).simplify())}$ \SI{}{\radian}.

Les posicions at√≤miques d'equilibri en la ce\l.la unitat s√≥n:

\begin{sagesilent}
r_B=1/3*a_1+2/3*a_2; r_N=2/3*a_1+1/3*a_2
cela=arrow((0,0),(a_1/a),color="blue")+\
      arrow((0,0),(a_2/a),color="red")+\
      line([(a_1/a),(a_1/a+a_2/a)],linestyle="--",color="red")+\
      line([(a_2/a),(a_2/a+a_1/a)],linestyle="--",color="red")+\
      point(r_B/a, size=120,color="blue")+\
      point(r_N/a, size=100,color="red")
\end{sagesilent}

\begin{equation}
\vec d_B=\frac{1}{3}\vec{a_1}+2\vec{a_2}\qquad
\vec d_N=\frac{2}{3}\vec{a_1}+\frac{1}{3}\vec{a_2} 
\end{equation} 



Tal com s'indica en la introducci√≥ te√≤rica, enumere les ce\l.les amb un √≠ndex vectorial $\vec l=\left(l_1, l_2\right)$, on $l_1$ i $l_2$ s√≥n dos nombres enters.

Les posicions del nucs de la xarxa s√≥n $\vec R_{\vec l}=l_1\vec{a}_1+l_2\vec{a}_2$.

\begin{sagesilent}
nucs=points([l_1*a_1/a+l_2*a_2/a for l_1 in range(-3, 4) for l_2 in range(-3,4)], size=40, color="blue", frame=False)

xarxa=nucs+\
line([(0,0),(a_1/a)],color="red")+\
line([(0,0),(a_2/a)],color="red")+\
line([(a_1/a),(a_1/a+a_2/a)],color="red")+\
line([(a_2/a),(a_2/a+a_1/a)],color="red")+\
line([(a_2/a),(a_1/a+2*a_2/a)],linestyle="--")+\
line([(a_1/a+2*a_2/a),(2*a_1/a+2*a_2/a)],linestyle="--")+\
line([(2*a_1/a+2*a_2/a),(2*a_1/a+a_2/a)],linestyle="--")+\
line([(2*a_1/a+a_2/a),(a_1/a)],linestyle="--")

#Posicions d'equilibri dels √†tomos
def RB(l_1,l_2):
    return (l_1*a_1+l_2*a_2+r_B)

def RN(l_1,l_2):
    return (l_1*a_1+l_2*a_2+r_N)

AtomsB=points([RB(l_1,l_2)/a for l_1 in range(-3, 4) for l_2 in range(-3,4)],size=20,color='blue')

AtomsN=points([RN(l_1,l_2)/a for l_1 in range(-3, 4) for l_2 in range(-3,4)],size=20,color='red')

\end{sagesilent}

\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{xarxa, figsize=3}
\caption{Xarxa de nucs}
\end{subfigure}
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{cela, figsize=3}
\caption{Ce\l.la unitat}
\end{subfigure}
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{AtomsB+AtomsN, figsize=3}
\caption{Cristall}
\end{subfigure}
\end{figure}

Per construir la matriu din√†mica necessitem com a pas previ classificar el √°toms del cristall segons la seua dist√†ncia als √†toms de la ce\l.la unitat, ja que els clasificarem com primers, segons, tercers ... ve√Øns segons aquesta dist√†ncia i els asignarem un tensor de constants de forces que dependr√° de a quina familia de ve√Øns pertanyen. 

\begin{sagesilent}
#import pandas as pd
var('q_x, q_y'); assume(q_x, q_y, 'real'); q=vector([q_x,q_y])


## Parametros de la red, de la celdilla y del cristal
## Vector R_l (vector de traslaci√≥n primitivo)
def R_l(l_1,l_2):
    return l_1*a_1+l_2*a_2

## Vector de posici√≥n de los √°tomos del cristal (en equilibrio)
def R_alpha_l(alpha,l_1,l_2):
    if alpha == 1:
        return l_1*a_1+l_2*a_2+r_B

    elif alpha == 2:
        return l_1*a_1+l_2*a_2+r_N

    else:
        print("Error, alpha solo puede ser 1 o 2 ")

## Vector unitario que une uno de los √°tomo alphaprima con el √°tomo considerado alpha, l_1,l_2
def R_hat(alphaprima,alpha,l_1,l_2):
    if (R_alpha_l(alpha,l_1,l_2)-R_alpha_l(alphaprima,0,0)).norm()>0:
        return (R_alpha_l(alpha,l_1,l_2)-R_alpha_l(alphaprima,0,0))/(R_alpha_l(alpha,l_1,l_2)\
                                                                 -R_alpha_l(alphaprima,0,0)).norm()
    else:
        return (R_alpha_l(alpha,l_1,l_2)-R_alpha_l(alphaprima,0,0))

# Distancia entre el √°tomo alphaprime y su vecino alpha situado en la celdilla l_1,l_2
def distancia(alphaprime,alpha,l_1,l_2):
    return (R_alpha_l(alpha,l_1,l_2)-R_alpha_l(alphaprime,0,0)).norm()/a    

def fase(l_1,l_2):
    return exp(I*q*R_l(l_1,l_2))

#Genero una lista con la distancia de cada √°tomo a los √°tomos de la celdilla unidad 
#def valores_atomos(l_1, l_2):
#    return [(k, m, i, j, R_hat(k, m, i, j), distancia(k,m,i,j)) for k in [1,2] for m in [1,2]  \
#            for i in range(-l_1,l_1+1) for j in range(-l_2,l_2+1)]

## Construyo un DataFrame de pandas con la informaci√≥n necesaria para identificar a los primeros, segundos, ... vecinos, seg√∫n su distancia a cada uno de los √°tomos de la celdilla unidad
#columnas = [r"$\alpha\prime$",r"$\alpha$",r"$l_1$", r"$l_2$", r"$\hat R$",'Distancia']

#def lista_atomos(l_1, l_2):
#    return pd.DataFrame(valores_atomos(l_1,l_2),columns=columnas).sort_values(['Distancia',r"$\alpha\prime$"], ascending=[True,True])

## Mostramos el dataframe como una tabla
#table(lista_atomos(2,2).to_html(index=False))
\end{sagesilent}


\subsection{Primera zona de Brillouin}
Passe ara a mostrar la xarxa $2\pi$-rec√≠proca associada a la xarxa de nucs del cristall de $BN$, la primera zona de Brillouin y calcular els punts de m√†xima simetria de la primera zona de Brillouin:

Els vectors primitivos de la xarxa $2\pi\text{-rec√≠proca}$ s√≥n:

\begin{equation}
\label{eq:11}
\vec b_1=\frac{2\pi}{a}\left(\hat k_{x}+\frac{1}{\sqrt{3}}\hat k_{y}\right)\quad \vec b_2=\frac{2\pi}{a}\left(\frac{2}{\sqrt{3}}\hat k_y\right)
\end{equation} 

i la xarxa $2\pi$-rec√≠proca √©s:

\begin{sagesilent}
import numpy as np
import matplotlib.pyplot as plt
import pybinding as pb

a_1_rec=np.array([1,1/sqrt(3)])
a_2_rec=np.array([0,2/sqrt(3)])
  
def R_l_rec(l_1,l_2):
    return 2*np.pi*l_1*a_1_rec+2*np.pi*l_2*a_2_rec 

reddenudos=np.array([R_l_rec(l_1,l_2) for l_1 in range(-5, 5) for l_2 in range(-3,4)])

  
x = reddenudos[:,0]
y = reddenudos[:,1]
plt.plot(x,y,"o")
plt.axis('scaled')
plt.savefig("../Grafiques/Xarxa2pireciproca.jpg")
plt.close()

#from math import sqrt, pi

pb.pltutils.use_style()
from pybinding.repository.graphene.constants import a_cc, t

a = 56 / 55 * a_cc  # ratio of lattice constants is 56/55, in [nm] unit cell length
#t in [eV] hopping energy

vn = -1.4  # [eV] nitrogen onsite potential
vb = 3.34  # [eV] boron onsite potential

# create a simple 2D lattice with vectors a1 and a2
lattice = pb.Lattice(a1=[a, 0], a2=[-a/2, np.sqrt(3)*a/2])
lattice.add_sublattices(
('B', [0, np.sqrt(3)*a/3], vb), # add an atom called 'A' at position [0, 0]
('N', [a/2,np.sqrt(3)*a/6] ,vn )
)

lattice.add_hoppings(
        ([ 0,  0], 'B', 'N', t),
        ([ -1, 0], 'B', 'N', t),
        ([0,  1], 'B', 'N', t)
    )


lattice.plot()
lattice.plot_brillouin_zone()
plt.savefig("../Grafiques/1aBZ.jpg")
plt.close()
reset('a')
var('a', domain='positive')
\end{sagesilent}

\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=8cm]{../Grafiques/Xarxa2pireciproca.jpg}
\subcaption{Xarxa en l'espai $2\pi$-rec√≠proc}
\end{subfigure}
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=6cm]{../Grafiques/1aBZ.jpg}
\subcaption{Primera zona de Brillouin}
\end{subfigure}
\end{figure}





\subsection{Tensor de constants de forca i matriu din√†mica}

Una vegada descrit el nostre sistema f√≠sic anem a obtindre la matriu din√†mica d'aquest, ja que com hem vist els seus valors propis, $\omega^2$, ens donen la freq√º√®ncia de propagaci√≥ de cadascun dels modes.

Obtesses les posicions dels √†toms y classificats estos com primers, segons, etc. ve√Øns, segons la dist√†ncia al respectiu √†tom de la ce\l.la $\vec 0$, procedim a calcular la contribuci√≥ a la matriu din√†mica de cadascun dels √†toms, per la qual cosa necessitem con√®ixer el tensor de constants de for\c{c}a que correspon a la interacci√≥ de cada √†tom amb el seu n-√®ssim ve√≠.

La forma general del tensor de forces d'un $n$-√®ssim ve√≠ √©s de la forma \cite{wirtz04_phonon_disper_graph_revis}:


\begin{equation}
C_n=\begin{pmatrix}
\phi_n^{r}&\xi_n &0\\
-\xi_n & \phi_n^{ti} & 0 \\
0 & 0 & \phi_n^{to}
\end{pmatrix}
\label{eq:tensordeforces}
\end{equation}

on el sistema de coordenades se elegeix de manera que $x$ √©s la coordenada longitudinal (en la l√≠nia que conecta els dos √†tomos), $r$; $y$ la coordenada transversal en el planol, $ti$, i $z$ la coordenada perperndicular al planol $to$. L'estructura diagonal a blocs de la matriu reflexa el fet que las vibracions interplanars y les de fora de ,$to$, (en la direcci√≥ $z$) estan completament desacoblades.



Anem a supossar (per simplificar) que un despla\c{c}ament longitudinal (radial, que estar√† cont√©s en el planol del cristall) o transversal (tangencial, siga en el planol o perpendicular al planol) sols genera una for\c{c}a radial o transversal, es a dir, $\xi_n=0$ tal y com es realitza \cite{Balkanski_2000}. Esta aproximaci√≥ es coneix com la aproximaci√≥n \textit{4NNFC},% i es necessita considerar fins els cuarts ve√Øns per donar compte dels resultats experimentals.

%\missingfigure{Ac√≠ va imatge mostrant el cristall i les forces}


%\begin{figure}[h]
%\centering
%\includegraphics[width=40mm,height=40mm]{example-image-a}
%\caption{Caption}
%\end{figure}


%Una altra aproximaci√≥ al problema trobada en la literatura sobre els fonons del graf√© √©s la coneguda com el modelo \textit{VFF} (\textit{valence-force field}), la qual determina els par√†metros de la matriu en l'equaci√≥ \ref{eq:tensordeforces} introdu√Ønt \textit{constants de moll} que determinen el canvi en l'energia potencial segons diferents deformacions; una introducci√≥n a esta aproximaci√≥ es troba en l'annexe de la refer√®ncia (cite aizawa90 bond soften monol graph formed). Amb aquesta aproximaci√≥ es necesiten menys par√†metres (\textit{constantes de fuerza}) per  obtindre una qualitat similar a la parametrizaci√≥ \textit{4NNFC} (cite wirtz04 phonon disper graph revis).

Por tant, com primera aproximaci√≥ anem a considerar que el tensor de constants de for\c{c}a  d'un √†tom classificat com $n$-√®ssim ve√≠, situat en la direcci√≥ $\hat x$ respecte del √°tom de la ce\l.la $\vec 0$, t√© la forma diagonal:

\begin{equation}
\label{eq:rotacio}
C_n(0)=\begin{pmatrix}
\phi_n^r& 0 &0\\
0 & \phi_n^{ti} & 0 \\
0 & 0 & \phi_n^{to}
\end{pmatrix}
\end{equation}

i per tant el tensor de constants de for\c{c}a de cadascun dels $n$-√®ssims ve√Øns reals l'obtenim rotant la matriu de l'equaci√≥ \ref{eq:rotacio}:

\begin{equation}
 C_n(\theta)=U^{-1}(\theta)C_n(0)U(\theta)
\end{equation}


on $\vec U(\theta)$ ve donada per:
\begin{equation}
\vec U(\theta)=
\begin{pmatrix}
\cos(\theta)  & \sin(\theta) & 0 \\
-\sin(\theta) & \cos(\theta) & 0  \\
0             & 0            & 1
\end{pmatrix}
\end{equation}

Un punt important √©s que quan considerem la interacci√≥ entre √†toms del mateix tipus (en el cas del BN √©s f√°cil discriminarlos, ja que s√≥n √†toms de distints elements els que conformen la base), tenim que considerar la contribuci√≥ a la matriu din√°mica de l'√†tom que estamos considerant de la ce\.l.la $\vec 0$. Esta contribuci√≥ podem derivar-la de la condici√≥ d'estabilitat, %(falkovsky08_symmet_const_phonon_disper_graph)
%(wirtz04_phonon_disper_graph_revis)
Si es desplaca el cristall com un tot no canvia l'energ√≠a potencial, cosa que implica s'ha de complir:


Podem tindre en compte altres simetries del cristall per determinar certes propietats del tensor de forces o de la seua transformada de Fourier, la matriu din√†mica (certes relacions entre les components ...) per√≤ per ara sols tindrem en compte que la matriu din√†mica es una matri herm√≠tica, i per tant els seus valors propis, $\omega^2$ tenen que ser reals.

\vspace{5cm}

\begin{sagesilent}
#Angulo que forma el √°tomo considerado respecto al eje x

def angulo(alphaprima,alpha,l_1,l_2):
    if R_hat(alphaprima,alpha,l_1,l_2)[1] <0:
        return -acos(R_hat(alphaprima,alpha,l_1,l_2)*vector([1,0]))
    
    else:
        return acos(R_hat(alphaprima,alpha,l_1,l_2)*vector([1,0]))

#Matriz unitaria de rotaci√≥n para cambio de ejes coordenados (entorno al eje z)

def U(theta):
    return matrix([[cos(theta),sin(theta),0], [-sin(theta), cos(theta),0],[0,0,1]])

#Matriz de fuerza para los primeros vecinos

var('M_B,M_N', domain='positive')
var('omega')

phi1rBN=var('phi1rBN',latex_name='\\phi_{1,r}^{BN}')
phi1tiBN=var('phi1tiBN',latex_name='\\phi_{1,ti}^{BN}')
phi1toBN=var('phi1toBN',latex_name='\\phi_{1,to}^{BN}',domain='real')

phi1rNB=phi1rBN; phi1tiNB=phi1tiBN; phi1toNB=phi1toBN


Phi_10__BN=1/sqrt(M_B*M_N)*Matrix([[phi1rBN,0,0],[0,phi1tiBN,0],[0,0,phi1toBN]])
Phi_10__NB=1/sqrt(M_N*M_B)*Matrix([[phi1rNB,0,0],[0,phi1tiNB,0],[0,0,phi1toNB]])


def Phi_1l__BN(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_10__BN*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def Phi_1l__NB(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_10__NB*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def D_1l_BN(alphaprima,alpha,l_1,l_2):
    return Phi_1l__BN(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

def D_1l_NB(alphaprima,alpha,l_1,l_2):
    return Phi_1l__NB(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

# Matriz de fuerza para los segundos vecinos

phi2rBB=var('phi2rBB',latex_name='\\phi_{2,r}^{BB}')
phi2tiBB=var('phi2tiBB',latex_name='\\phi_{2,ti}^{BB}')
phi2toBB=var('phi2toBB',latex_name='\\phi_{2,to}^{BB}',domain='real')

phi2rNN=var('phi2rNN',latex_name='\\phi_{2,r}^{NN}')
phi2tiNN=var('phi2tiNN',latex_name='\\phi_{2,ti}^{NN}')
phi2toNN=var('phi2toNN',latex_name='\\phi_{2,to}^{NN}',domain='real')

Phi_20__BB=1/M_B*Matrix([[phi2rBB,0,0],[0,phi2tiBB,0],[0,0,phi2toBB]])
Phi_20__NN=1/M_N*Matrix([[phi2rNN,0,0],[0,phi2tiNN,0],[0,0,phi2toNN]])

#A tener en cuenta: cuando consideramos el mismo tipo de √°tomos 
# (de la misma subred, no porque sean el mismmo elemento)

def Phi_2l__BB(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_20__BB*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def Phi_2l__NN(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_20__NN*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def D_2l_BB(alphaprima,alpha,l_1,l_2):
    return Phi_2l__BB(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

def D_2l_NN(alphaprima,alpha,l_1,l_2):
    return Phi_2l__NN(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)


#Matriz de fuerza para los terceros vecinos

phi3rBN=var('phi3rBN',latex_name='\\phi_{3,r}^{BN}')
phi3tiBN=var('phi3tiBN',latex_name='\\phi_{3,ti}^{BN}')
phi3toBN=var('phi3toBN',latex_name='\\phi_{3,to}^{BN}',domain='real')
phi3rNB,phi3tiNB,phi3toNB=phi3rBN,phi3tiBN,phi3toBN
Phi_30__BN=1/sqrt(M_B*M_N)*Matrix([[phi3rBN,0,0],[0,phi3tiBN,0],[0,0,phi3toBN]])
Phi_30__NB=1/sqrt(M_N*M_B)*Matrix([[phi3rNB,0,0],[0,phi3tiNB,0],[0,0,phi3toNB]])
                   
def Phi_3l__BN(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_30__BN*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def Phi_3l__NB(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_30__NB*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def D_3l_BN(alphaprima,alpha,l_1,l_2):
    return Phi_3l__BN(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

def D_3l_NB(alphaprima,alpha,l_1,l_2):
    return Phi_3l__NB(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

#Matriz de fuerza para los cuartos vecinos
phi4rBN=var('phi4rBN',latex_name='\\phi_{4,r}^{BN}')
phi4tiBN=var('phi4tiBN',latex_name='\\phi_{4,ti}^{BN}')
phi4toBN=var('phi4toBN',latex_name='\\phi_{4,to}^{BN}',domain='real')
phi4rNB,phi4tiNB,phi4toNB=phi4rBN,phi4tiBN,phi4toBN

Phi_40__BN=1/sqrt(M_B*M_N)*Matrix([[phi4rBN,0,0],[0,phi4tiBN,0],[0,0,phi4toBN]])
Phi_40__NB=1/sqrt(M_N*M_B)*Matrix([[phi4rNB,0,0],[0,phi4tiNB,0],[0,0,phi4toNB]])

def Phi_4l__BN(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_40__BN*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def Phi_4l__NB(alphaprima,alpha,l_1,l_2):
    return U(-angulo(alphaprima,alpha,l_1,l_2))*Phi_40__NB*\
           U(angulo(alphaprima,alpha,l_1,l_2))

def D_4l_BN(alphaprima,alpha,l_1,l_2):
    return Phi_4l__BN(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

def D_4l_NB(alphaprima,alpha,l_1,l_2):
    return Phi_4l__NB(alphaprima,alpha,l_1,l_2)*fase(l_1,l_2)

# Finalmente construimos la matriz din√°mica "a capas"
# Con la tabla de la celda de codigo anterior comprobamos que para considerar 
# hasta los cuartos vecinos es suficiente con l_1,l_2=2
                   
D1BN, D1NB, D2BB, D2NN, D3BN, D3NB, D4BN, D4NB = (matrix(3) for i in range(8))
D01BN, D01NB, D02BB, D02NN, D03BN, D03NB, D04BN, D04NB= (matrix(3) for i in range(8))
for k in [1,2]:
    for m in [1,2]:
         for i in range(-2,3):
            for j in range(-2,4):
                if (k==1) & bool( distancia(k,m,i,j) == sqrt(3)/3 ):
                    D1BN += D_1l_BN(k,m,i,j)
                    D01BN += Phi_1l__BN(k,m,i,j)

                elif (k==2) & bool( distancia(k,m,i,j) == sqrt(3)/3 ):
                    D1NB += D_1l_NB(k,m,i,j)
                    D01NB += Phi_1l__NB(k,m,i,j)
                 
                elif (k==1) & bool( distancia(k,m,i,j) == 1):
                    D2BB += D_2l_BB(k,m,i,j)
                    D02BB += Phi_2l__BB(k,m,i,j)

                elif (k==2) & bool( distancia(k,m,i,j) == 1):
                    D2NN += D_2l_NN(k,m,i,j)
                    D02NN += Phi_2l__NN(k,m,i,j)

                elif (k==1) & bool( distancia(k,m,i,j) == 2*sqrt(3)/3 ):
                    D3BN += D_3l_BN(k,m,i,j)
                    D03BN += Phi_3l__BN(k,m,i,j)

                elif (k==2) & bool( distancia(k,m,i,j) == 2*sqrt(3)/3 ):
                    D3NB += D_3l_NB(k,m,i,j)
                    D03NB += Phi_3l__NB(k,m,i,j)
                    
                elif (k==1) & bool( distancia(k,m,i,j) == sqrt(7/3)):
                    D4BN += D_4l_BN(k,m,i,j)
                    D04BN += Phi_4l__NB(k,m,i,j)

                elif (k==2) & bool( distancia(k,m,i,j) == sqrt(7/3)):
                    D4NB += D_4l_NB(k,m,i,j)
                    D04NB += Phi_4l__NB(k,m,i,j)

# Tenemos en cuenta la contribuci√≥n a la matriu din√°mica de los √°tomos situados en 
# la celdilla 0
D2BB=D2BB-D01BN-D02BB-D03BN
D2NN=D2NN-D01NB-D02NN-D03NB                    
\end{sagesilent}

Tenim per tant que la matriu din√†mica ser√† una matriu $6x6$ herm√≠tica. Per√≤ donat que les components en $z$ d'esta matriu es troben desacoblades podem tractar aquestes vibracions de manera independent.

\newpage

\subsection{Vibracions transversales fora de pla}
Donat que en el nostre model, per com hem constru√Øt la matriu din√†mica, les vibracions fora de pla s√≥n independents de les interplanars passem a estudiar-les.

\begin{sagesilent}
D1BN_zz=D1BN[2,2]
D1NB_zz=D1NB[2,2]

D2BB_zz=D2BB[2,2]
D2NN_zz=D2NN[2,2]

D3BN_zz=D3BN[2,2]
D3NB_zz=D3NB[2,2]
D4BN_zz=D4BN[2,2]
D4NB_zz=D4NB[2,2]

D_zz=Matrix([[D2BB_zz,D1BN_zz+D3BN_zz], [D1NB_zz+D3NB_zz,D2NN_zz]])
#valors_propis_D_zz=D_zz.eigenvalues()
\end{sagesilent}

\subsubsection{En $\Gamma (k_x=0, k_y=0)$}
Al punt $\Gamma$, ($q_x=0, q_y=0$), la matriu din√°mica per a les vibracions fora de pla pren el valor:

\begin{sagesilent}
from periodictable import C, B, N, constants
u=constants.atomic_mass_constant*10**3 #para que este en CGS (y las const. de fuerza en dyn)

omega_Gamma_ZO=830 #cm-1
omega_Gamma_ZA=0

D_Gamma_zz=D_zz.subs(q_x=0,q_y=0) #,(M_B,B.mass*u),(M_N,N.mass*u)])
Eq1=(D_Gamma_zz.eigenvalues()[0]==omega**2).subs(omega=omega_Gamma_ZO)
\end{sagesilent}

\begin{equation}
\sage{D_Gamma_zz}
\end{equation}

i es seus valors propis son:

\begin{align*}
\omega_{ZO}^2(\Gamma)&=\sage{D_Gamma_zz.eigenvalues()[0]}\\
\omega_{ZA}^2(\Gamma)&=\sage{D_Gamma_zz.eigenvalues()[1]}
\end{align*}


\subsubsection{En $K$ ($q_x=4\pi/(3 a)$, $q_y=0$)}
Els valors propios de la matriu din√†mica en aques punt s√≥n:
\begin{sagesilent}
omega_K_ZO=605 #cm-1
omega_K_ZA=322
D_K_zz=D_zz.subs(q_x=4*pi/(3*a),q_y=0)
Eq1=(D_Gamma_zz.eigenvalues()[0]==omega**2).subs(omega=omega_Gamma_ZO)
solEq1=solve(Eq1, phi3toBN)
\end{sagesilent}

\begin{align*}
\omega_{ZO}^2(K)&=\sage{D_K_zz.eigenvalues()[0]}\\
\omega_{ZA}^2(K)&=\sage{D_K_zz.eigenvalues()[1]}
\end{align*}


Podem observar que en el cas del $BN$, a difer√®ncia del cas del graf√©, obtenim 2 freq√º√®ncies distintes al punt $K$ degut a que en la base tenim dos √†toms distints.

\begin{sagesilent}
sol=[]
Eq2=(D_K_zz.eigenvalues()[0]==omega**2).subs(omega=omega_K_ZO)
Eq3=(D_K_zz.eigenvalues()[1]==omega**2).subs(omega=omega_K_ZA)
sol.append(solve(Eq2.subs(solEq1),phi2toNN)[0])
sol.append(solve(Eq3.subs(solEq1),phi2toBB)[0])
\end{sagesilent}

\subsubsection{En el punt $M(q_x=\pi/a,q_y=\pi/(\sqrt 3 a)$}

\begin{sagesilent}
omega_M_ZO=635 #cm-1
omega_M_ZA=314

D_M_zz=D_zz.subs(q_x=pi/a,q_y=pi/(sqrt(3)*a))
#D_M_zz.eigenvalues()
#Podemos simplificar un poco la expresi√≥n obtenida para los valores propios en el punto  ùëÄ  (simplemente reescribiendo el argumento de la raiz cuadrada)

omegaM1cuadrado=-4*phi2toBB/M_B-4*phi2toNN/M_N-3/sqrt(M_B*M_N)*(phi1toBN+phi3toBN)-sqrt(M_B*M_N*(phi1toBN-3*phi3toBN)^2+(4*(M_N*phi2toBB-M_B*phi2toNN))^2)/(M_B*M_N)

#if bool(D_M_zz.eigenvalues()[0]==omegaM1cuadrado):
#    show(omegaM1cuadrado)

omegaM2cuadrado=-4*phi2toBB/M_B-4*phi2toNN/M_N-3/sqrt(M_B*M_N)*(phi1toBN+phi3toBN)+sqrt(M_B*M_N*(phi1toBN-3*phi3toBN)^2+(4*(M_N*phi2toBB-M_B*phi2toNN))^2)/(M_B*M_N)

#if bool(D_M_zz.eigenvalues()[1]==omegaM2cuadrado):
#    show(omegaM2cuadrado)
\end{sagesilent}

\begin{small}
\begin{align*}
\omega_{ZO}^2(M)&=\sage{omegaM1cuadrado}\\
\omega_{ZA}^2(M)&=\sage{omegaM2cuadrado}
\end{align*}
\end{small}

Comprobem que les expresions obtesses es redueixen a les que apar√©ixen en la ref: Falkowsky en el cas que es √†toms de la base foren iguals.

\begin{sagesilent}
Eq5=(omegaM1cuadrado==omega_M_ZO**2)
Eq6=(omegaM2cuadrado==omega_M_ZA**2)

sol1=(phi1toBN==n(solve(((Eq6-Eq5)**2).subs(solEq1), phi1toBN)[0].subs(sol[0], sol[1]).subs(M_B=B.mass, M_N=N.mass).rhs()))

sol2=sol[0].subs(M_N=N.mass)

sol3=sol[1].subs(M_B=B.mass)

sol4=solEq1[0].subs(M_B=B.mass, M_N=N.mass).subs(sol1)

\end{sagesilent}

De manera que los valores que obtenemos para las cuatro constantes de fuerza consideradas son:

\begin{align*}
&\sage{sol1}\qquad& \sage{sol2}\\
&\sage{sol3}\qquad& \sage{sol4}
\end{align*}

Y les relacions de dispersi√≥ per als modes $ZO$ i $ZA$ tenen la foma:

%\sagetexpause
\begin{sagesilent}
from pylab import loadtxt
#data = pd.read_csv('../Dades/freq.dat', header = None)
dades=loadtxt("../Dades/freq.dat")
ZAZO=\
list_plot(
    [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
        M_N=N.mass, a=1, q_x=n(x*pi), q_y=n(x*pi/sqrt(3))).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)] +\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(pi*(1+x/3)), q_y=n(pi/sqrt(3)*(1-x))).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)]+\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(4*pi/3*(1-x)), q_y=0).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)]) + \
list_plot(
    [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
        M_N=N.mass, a=1, q_x=n(x*pi), q_y=n(x*pi/sqrt(3))).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]+
          [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1,q_x=n(pi*(1+x/3)), q_y=n(pi/sqrt(3)*(1-x))).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]+\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(4*pi/3*(1-x)), q_y=0).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]) \
     +line([(10,0),(10,1600)], color="black")+line([(20,0),(20,1600)], color="black")\
     +line([(30,0),(30,1600)], color="black", ticks=[[0.05,10,20,30], None], \
        tick_formatter = [[r'$\Gamma$', '$M$', '$K$', r'$\Gamma$'], None])+\
points(zip(dades[:524,0]/524*30, dades[:524,1]), color="red") +\
points(zip(dades[524:1048,0]/524*30, dades[524:1048,1]), color="brown") +\
points(zip(dades[1048:1572,0]/524*30, dades[1048:1572,1]), color="black") +\
points(zip(dades[1572:2096,0]/525*30, dades[1572:2096,1]), color="pink") +\
points(zip(dades[2096:2620,0]/525*30, dades[2096:2620,1]), color="steelblue") +\
points(zip(dades[2620:3144,0]/525*30, dades[2620:3144,1]), color="blue")

\end{sagesilent}

\begin{figure}[h]
\centering
 \sageplot{ZAZO,figsize=6}
\end{figure}

%\sagetexunpause


Passem ara a estudiar les vibracions dins del pla del cristall.

\newpage
\subsection{Vibracions dins del pla del cristall}
En este cas tractem amn una matriu $4\times 4$, i per tant tenim 4 valors propis ($\omega^2$)

\begin{sagesilent}
D1BN_xy=D1BN.matrix_from_rows_and_columns([0,1],[0,1])
D1NB_xy=D1NB.matrix_from_rows_and_columns([0,1],[0,1])

D2BB_xy=D2BB.matrix_from_rows_and_columns([0,1],[0,1])
D2NN_xy=D2NN.matrix_from_rows_and_columns([0,1],[0,1])
               
D3BN_xy=D3BN.matrix_from_rows_and_columns([0,1],[0,1])
D3NB_xy=D3NB.matrix_from_rows_and_columns([0,1],[0,1])
#D4BN_xy=D4BN.matrix_from_rows_and_columns([0,1],[0,1])
#D4NB_xy=D4NB.matrix_from_rows_and_columns([0,1],[0,1])

D_xy=block_matrix([[D2BB_xy, D1BN_xy+D3BN_xy],[D1NB_xy+D3NB_xy, D2NN_xy]])
\end{sagesilent}

\subsubsection{Al punt $\Gamma$}

Al punt $\Gamma$ obtinc 2 valors propis, de multiplicitat $2$ cadascun:
\begin{sagesilent}
D_Gamma_xy=D_xy.subs(q_x=0,q_y=0)
\end{sagesilent}

\begin{align*}
\omega_{1,2}^2(\Gamma)&=\sage{D_Gamma_xy.eigenvalues()[0]}\\
\omega_{3,4}^2(\Gamma)&=\sage{D_Gamma_xy.eigenvalues()[3]}
\end{align*}

El programa (escrit en python emprant \textcolor{blue}{sagemath}, que per a la diagonalitzaci√≥ de matrius empra el programa \textcolor{red}{maxima}) no consigueix trobar un resultat anal√≠tic \textit{sencill} per als valors propis de la matriu din√†mica als punts $M$ i $K$, de manera que anem a intentar obtindre algun resultat aproximat realitzant algunes simplificacions; en particular anem a considerar:

\begin{itemize}

\item Les masses dels √†toms s√≥n iguals $M_N=M_B$
\item Les constants de for\c{c}a entre √†toms del mateix tipus s√≥n tamb√© iguals: $\phi_{2,r}^{NN}=\phi_{2,r}^{BB}$, $\phi_{2,ti}^{NN}=\phi_{2,ti}^{BB}$ 
\end{itemize}

Emprant aquestes aproximacions (m√©s endavant veurem que no fa falta fer tantes simplificacions, podem no igualar alguna de les dues constants anteriors), obtenim

\subsubsection{Al punt $M$}

Obtinc 4 valors propis distints, cosa que sembla raonable observant la gr√†fica de les dades proporcionades.
\begin{sagesilent}
D_M_xy=D_xy.subs(q_x=pi/a,q_y=pi/(sqrt(3)*a), phi2rNN=phi2rBB,phi2tiNN=phi2tiBB, M_N=M_B)
\end{sagesilent}

\begin{align*}
\omega_1^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[0]}\\
\omega_2^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[1]}\\
\omega_3^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[2]}\\
\omega_4^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[3]}
\end{align*}

\newpage

\subsubsection{Al punt $K$}

En este punt el programa en dona 3 valors propis, un d'ells amb multiplicitat $2$, i observant la gr√†fica de les dades proporcionades sembla tamb√© raonable que en primera aproximaci√≥ un dels valors propis estiga degenerat (podem observar que tenim $2$ freq√º√®ncies al punt $K$ molt pr√≤xims entre ells)

\begin{sagesilent}
D_K_xy=D_xy.subs(q_x=4*pi/(3*a),q_y=0, phi2rNN=phi2rBB,phi2tiNN=phi2tiBB, M_N=M_B)\end{sagesilent}

\begin{align*}
\omega_1^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[0]}\\
\omega_2^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[1]}\\
\omega_{3,4}^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[2]}
\end{align*}

Passem ara a intentar calcular els valors de les constants de for\c{c}a, emprant els valors de les freq√º√®ncies dels modes de vibraci√≥ en estes punts de la primera zona de Brillouin.
\newpage

\bibliography{TFG-Casimir}
\bibliographystyle{plain}

\end{document}
