\documentclass[12pt]{article} %,twoside,a4paper

\usepackage[a4paper,margin=24.5mm]{geometry} %\usepackage[left=2cm,right=2cm,top=1.5cm, bottom=2cm]

\usepackage[utf8]{inputenc}
\usepackage[english,catalan]{babel}
%%%\usepackage[english,spanish]{babel}
\usepackage{natbib}
\usepackage{float} 
\usepackage{graphicx}


% Establim el format de la pgina:
%\usepackage{fancyhdr}

%\setlength{\parskip}{0.2cm}
%\usepackage[T1]{fontenc}
%\usepackage{newunicodechar}
%\newunicodechar{目}{\L.}
%\newunicodechar{}{\l.}
\usepackage{siunitx}
\usepackage{amsmath}
%\usepackage{adjustbox}
%\usepackage{tabularx}
\usepackage{mathtools}
\usepackage{color}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[colorlinks=true,urlcolor=blue,linkcolor=blue,citecolor=blue]{hyperref}
%\usepackage{booktabs} %Publication quality tables in LaTeX.
%\usepackage{pdflscape}
%\usepackage{attachfile}
\usepackage{todonotes}
%\usepackage{pdfpages}

\usepackage{sagetex}
%\definecolor{gris}{RGB}{220,220,220}
\let\vec\mathbf %vectors en negreta en compte de arrow

\author{Casimiro Victoria Castillo}


\begin{document}

\newgeometry{margin=1in}
\begin{titlepage}
   \noindent\raisebox{0pt}[0pt][0pt]{
	\includegraphics[width=10.5cm]{./portada-TFG-LaTeX/marca-Facultat-Fisica-UV-1-linia.pdf}}\par
   \vspace{8.5cm}
   % Titles
   {\centering
      \scalebox{1.125}{\bfseries\sffamily\Huge
		Treball de Fi de Grau en F铆sica}\par
      \rule{16.13cm}{1.5pt}\par
      \vspace{4.5cm}
      {\bfseries\sffamily\LARGE Fonons i espectrosc貌pia Ramman en semiconductors bidimensionals}\par
   }
   \vfill
   {\raggedleft\sffamily
		AGOST de 2021\par
      \vspace{\baselineskip}
		Alumne/a: Casimiro Victoria Castillo\par
      \vspace{\baselineskip}
		Tutor/a (1): Alberto Garc铆a Crist贸bal\par
		Tutor/a (2): Alejandro Molina Sanchez\par
   }
\end{titlepage}
\restoregeometry

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{abstract}
\subsection*{Resum / \emph{Abstract}}

Els materials bidimensionals ($2D$) com el graf猫 s贸n de gran inter猫s tant per les seues propietats f铆siques exclusives com per les seues aplicacions potencials. L'estudi de la dinmica de la xarxa cristal路lina (\textit{fonons}) d'estos materials 茅s un requisit previ per entendre la seua estabilitat estructural i propietats t猫rmiques, aix铆 com les seues propietats de transport i 貌ptiques.   


Este Treball de Fi de Grau consisteix en la computaci贸 dels modes vibracionals de materials semiconductors 2D y la seua correlaci贸 amb els observables rellevants per a la interpretaci贸 dels experiments de dispersi贸 de la llum.
\vspace{\baselineskip}

\begin{otherlanguage}{english}\itshape

\noindent Abstract\ldots
The long-range character of the dynamical matrix limits the validity of
force-constant approaches that take only interaction with few neighboring atoms into account. However, by fitting the force-
constants to the ab initio dispersion relation, we show that the popular 4th-nearest-neighbor force-constant approach yields an
excellent fit for the low frequency modes and a moderately good fit (with a 
maximum deviation of $6 \%$) for the high-frequency modes \cite{wirtz04_phonon_disper_graph_revis}
\end{otherlanguage}

%\textit{Nota: s'ajunta el codi font del document: \attachfile[author=Casimir]{TFG-Casimir.tex}}

%\newpage
%\end{abstract}

\section{Introducci贸}

En este treball s'empra el m猫tode de constants de for莽a (\emph{FCM} per les seues sigles en angl茅s, \emph{\foreignlanguage{english}{force constant method})}, per descriure la dinmica reticular de un material bidimensional, el nitrur de bor monocapa, \emph{BN}.\\

En este model la dinmica dels toms es descriu per un conjunt de simples constants de for莽a, on estes forces conecten cada tom amb els toms del seu entorn, fins a un nombre determinat de ve茂ns. Altres m茅todes com els clculs realitzats a partir de primers principis (\emph{ab initio}) emprant la teor铆a del funcional densitat (DFT, per les seues sigles en angl茅s \foreignlanguage{english}{density-functional density}) o el m猫tode de camp de for莽a de val猫ncia (\emph{VFF}, \foreignlanguage{english}{valence force field}) necessiten temps de clcul molt m茅s llargs. El m茅tode de constants de for莽a empra un conjunt redu茂t de par谩metres que poden ajustar-se a les mesures experimentals o b茅, com s'ha fet en este treball, a la relaci贸 de dispersi贸 calculada per primers principis pel m猫tode de \textcolor{red}{QUIN MTODE S'HA EMPRAT PER AL CLCUL freq.dat??}.  I encara que estem tractant amb un m猫tode sencill, este ha demostat que pot proporcionar resultats fiables \cite{wirtz04_phonon_disper_graph_revis}.

Abans d'explicar en detall el m猫tode emprat en este treball repassem alguns conceptes i aclarim la notaci贸 emprada.

\subsection{Xarxa cristal路lina}

Sabem que els toms que constitueixen un s貌lid cristal路l铆 estan distribu茂ts de una manera regular en l'espai, y per descriure esta distribuci贸 regular s'empra el concepte matemtic de \emph{xarxa cristal路lina}, introdu茂t per A. Bravais en 1845: una xarxa cristal路lina es defineix com una distribuci贸 discreta i regular de punts que t茅 sempre la mateixa aparen莽a independentment de quin punt escollim com origen de coordenades.

En el cas que anem a tractar, un cristall bidimensional, la xarxa cristal路lina bidimensional pot generar-se a partir de dos vectors base, de manera que els vectors de posici贸 dels \emph{nucs de la xarxa}, els vectors de translaci贸 cristal路lina,  tenen la forma:
\begin{equation}
 \vec R_\vec l=\vec R_{l_1 l_2}=l_1 \vec a_1 +l_2\vec a_2
\end{equation}

on $\vec l$ es denomina 铆ndex del nuc (notem que en la literatura sobre el tema sol emprar-se com a 铆ndex la lletra $n$, per貌 crec que un 铆ndex vectorial especifica millor els nucs). Si tots els nucs de la xarxa tenen 铆ndexs enters llavors els vectors base s'anomenen \emph{primitius}.

Els cristalls o \emph{estructures cristal路lines} s贸n distribucions regulars d'toms en l'espai de posicions i els podem descriure associant a cadascun dels nucs d'una xarxa cristallina en l'espai de posicions un conjunt d'toms o base (\emph{matemticament 茅s producte de convoluci贸 de la base y la xarxa de nucs}. En el cas del \emph{BN} tractem amb una base diat貌mica, formada per un nucli de bor, $B$ i un de nitr,ogen, $N$. 

En dues dimensions, els paral路lelograms amb els quals podem omplir completament l'espai per translaci贸 cristal路lina i que contenen almenys un nuc de la xarxa es coneixen com cel路les unitat. La cel路la unitat m茅s sencilla 茅s la que t茅 per costats el vectors base, i es coneixen com cel路les de Bravais.

\subsubsection{Xarxa rec铆proca. Primera zona de Brillouin.}
Donat un conjunt de vectors base, $p_i$, de la xarxa cristalina en l'espai de posicions, la condici贸:

\begin{equation}
\label{eq:rec1}
\vec p_i\cdot\vec p_j^{*}=\delta_{ij}
\end{equation}

on $\delta_{ij}$ 茅s la delta de Kronecker, defineix un altre conjunt de vectors $p_j^*$, coneguts com vectors rec铆procs, i qu猫 son els vectors base que defineixen una altra xarxa coneguda com \textit{xarxa rec铆proca}. Els  vectors base rec铆procs, i els vectors de translaci贸 cristal路lina rec铆procs, tenen dimensions de inversa de longitud i es representen en l'\textit{espai rec铆proc} o de nombres d'ona. \textbf{Les xarxes cristal路lines real y rec铆proca s贸n dues descripcions equivalents del mateix sistema f铆sic: el s貌lid cristal路l铆} que s'est estudiant.

Podem interpretar que 

\begin{equation}
\label{eq:rec3}
\vec K_{h_1h_2}=2\pi\left(h_1\vec a_1^{*}+h_2\vec a_2^{*}\right)
\end{equation}

s贸n els vectors de translaci贸 cristal路lina que defineixen una xarxa cristal路lina en aquest espai $2\pi$-rec铆proc (s贸ls es diferencia de l'espai rec铆proc en un factor d'escala $2\pi$). En t茅rmes f铆sics, l'espai $2\pi$-rec铆proc 茅s l'\emph{espai de vectors d'ona} $\vec k$, i a falta d'un factors d'escala $\hbar$, coincideix amb l'espai de moments  $\vec p=\hbar\vec k$.

Cal tenir present que l'espai $2\pi$-rec铆proc 茅s el fonamental en l'estudi dels s貌lids cristal路lins, ja que els estats de les part铆cules i les interaccions f铆siques de inter茅s es descriuen en l'espai de vectors d'ona, $\vec k$.


\paragraph{Cel路les de Wigner-Seitz (WS) y primera zona de Brillouin (ZB)}

Per descriure la xarxa $2\pi$-rec铆proca, s'empra el criteri de \textit{Wigner-Seitz}. Las \textit{cel路les de Wigner-Seitz} estan centrades en un nuc de la xarxa i es defineixen com la regi贸 m茅s pr貌xima a un nuc (el del centre de la cel路la) que a qualsevol altre. Per determinar la seua forma, partim d'un nuc qualsevol com a origen, constru茂m els segments que uneixen este nuc amb els seus ve茂ns i es tracen els plans que bisecten cadascun d'estos segments: la cel路la de WS 茅s la cel路la de menor volum al voltant de l'origen que est delimitada per estos plans (rectes en el caso d'una xarxa bidimensional).

Notem que en l'espai de $\vec k$ s'empren ce\l.les unitat de \emph{WS} mentre que en l'espai de posicions sempre emprem ce\l.les unitat de Bravais.
La ce\l.la de WS de la xarxa $2\pi$-rec铆proca es coneix com \textbf{primera zona de Brillouin} (ZB)


\subsection{Vibracions at貌miques en cristalls}
Passem ara a descriure el model emprat per descriure les vibracions dels toms del cristall.
\subsubsection{Model de BORN i VON KARMAN}
Els toms constituents de un s贸lid cristall铆 no estan imm貌bils sino que vibren al voltant de la seua posici贸 de equilibri.

En 1912, Born y Von Karman \cite{Born:1912:SRG} introduiren un model per explicar de la din谩mica cristal路lina, on la idea fonamental es que cada mode normal t茅 l'energia de un oscil路lador de Planck. La din谩mica del sistema es descriu de manera sencilla, no en termes de les vibracions de toms individuals, sino en termes de moviments col路lectius en forma de ones viatgeres anomenades vibracions cristal路lines \emph{(\foreignlanguage{english}{lattice vibrations})} per Born. Cada vibraci贸 cristal路lina es caracteritza per una freq眉encia y un vector de ona.
La vibraci贸 cristal路lina quantitzada, o mode normal, s'anomena fon贸 per analog铆a amb el fot贸. %i te propietats de quasi-part铆cula

%Explicar el concepte de fon贸 i la seua importncia: Un fon贸 茅s un mode de vibraci贸 quantitzat que t茅 lloc en una xarxa cristal路lina. Els fonons tenen una gran importncia en moltes propietats f铆siques dels s貌lids. Los fonons son una version mecano-quntica dels modes normals de vibraci贸 de la mecnica clssica, on cada par de la xarxa osci\l.la amb la mateixa freq眉猫ncia. Aquests modes normals s贸n importants perqu猫 qualsevol moviment vibracional de la xarxa pot descriure's com una superposici贸 de modes normals de distinta freq眉猫ncia, en este sentit s贸n la base de les vibracions de la xarxa.

\subsubsection{Aproximaci贸 adiabtica}

Moltes propietats f铆siques dels s貌lids poden classificar-se b茅 com electr貌niques o b茅 com vibracionals, segons estiguen determinades pels electrons (de val猫ncia) o per les vibracions dels toms (nuclis i貌nics): normalment considerem els nuclis i els electrons com a constituent independents del s貌lid, ja que les masses dels electrons i dels nuclis s贸n tan diferents que el moviment dels nuclis 茅s molt m茅s lent que el dels electrons. L'\emph{aproximaci贸 adiabtica}, introdu茂da per Born i Oppenheimer \cite{ANDP:ANDP19273892002} estableix que els electrons responen de manera prcticament instantnia als despla莽aments at貌mics, de manera que el seu estat ve determinat per los posicions at贸miques instantnies, mentre que els toms no poden respondre a les rpides variacions espacials dels electrons: diguem que els electrons segueixen el moviment i貌nic adiabticament.
%els electrons no realitzen transicions abruptes de un estat a altres estats, si no que un estat electr貌nic es deforma progressivament degut als despla莽aments i貌nics.

Notem, per貌, que estem tractant amb una primera aproximaci贸 al problema y algunes propietats f铆siques venen determinades per la interacci贸 entre els electrons y les vibracions at貌miques.



%podem escriure l'energia potencial (o el Hamiltoni) como una suma de les distintes contribucions.
  
\subsubsection{Aproximaci贸 harm貌nica}

Les vibracions reticulars estan regides per les forces que experimenten els toms quan es desplacen de la seua posici贸 d'equilibri. La primera hip貌tesi 茅s que cada tom t茅 una posici贸 d'equilibri en el cristall, que denotem per $\vec r^{(0)}_{\vec l,\vec\alpha}=\vec R_\vec l+\vec d_\alpha$ y considerarem que estos toms vibren al voltant d'esta posici贸 d'equilibri, $\vec r_{\vec l,\vec\alpha}=\vec r^{(0)}_{\vec l,\vec\alpha}+\vec u_{\vec l,\alpha}(t)$, amb una amplitud menuda (en comparaci贸 amb la distncia interat貌mica) al voltant d'aquesta,   de manera que el s貌lid es troba en estats que corresponen al que macrosc貌picament es coneix com \textit{la regi贸 de comportament elstic lineal}, on es verifica la llei de Hooke.

Podem per tant aproximar l'energia potencial de interacci贸 pel terme harm貌nic del seu desenvolupament en s猫rie de potencies del despla\c{c}ament:

Les equacions de moviment en l'aproximaci贸 harm貌nica s'escriuen en la coneguda forma:

\begin{equation}
 M_\alpha\vec{\ddot{u}}_{\vec l,\alpha}(t)=-\sum_{\vec l',\alpha'}\vec\Phi_{\alpha,\alpha'}\left(\vec R_\vec l-\vec R_\vec l'\right)\cdot\vec u_{\vec n',\alpha'}(t)
\end{equation}
 Aquesta equaci贸 representa un sistema  d'oscil路ladors harm貌nics acoblats, on $\alpha$ i $\alpha'$ fan refer猫ncia al toms de la base considerats, l'铆ndex vectorial $\vec l$ (que sol apar猫ixer en la literatura com $n$) 铆ndica el nuc considerat i $\vec R_\vec l$ 茅s el vector de translaci贸 cristal路lina.
 
\vdots 




\subsubsection{Matriu dinmica}

La matriu dinmica 茅s la magnitud central de la dinmica reticular: les freq眉猫ncies dels fonons es calculen a partir dels valors propis de la matriu dinmica:

\begin{equation}
\sum_{\alpha\prime}D_{\alpha\alpha\prime}(\vec q)\cdot\vec e_{\alpha\prime}(\vec q)=\omega^{2}\vec e_{\alpha}(\vec q)
\end{equation}   

Per tant, les freq眉猫ncies $\omega$ com funci贸 del vector d'ones $\vec q$ del fon贸 s贸n soluci贸 de l'equaci贸 secular:

\begin{equation}
\det\left|\frac{1}{\sqrt{M_\alpha M_{\alpha\prime}}}D^{ij}_{\alpha\alpha\prime}\left(\vec q\right)-\omega^2\left(\vec q\right)\right|=0 
\end{equation}

on $M_{\alpha}$ es la massa de l'tom $\alpha$ y la matriu dinmica ve definida por:

\begin{equation}
D_{\alpha,\alpha\prime}^{i,j}=\frac{\partial^2 E}{\partial u_{\alpha}^{*i}(\vec q)\partial u_{\alpha\prime}^{j}(\vec q)}
\label{eq:Matriz_Din谩mica}
\end{equation}

on $u_{\alpha}^{i}$ representa el despla\c{c}ament de l'tom $\alpha$ en la direcci贸 $i$.

La segona derivada de l'energia de l'equaci贸 \ref{eq:Matriz_Din谩mica} correspon al canvi en la for\c{c}a que actua sobre l'tom $\alpha\prime$ en la direcci贸 $j$ quan es despla\c{c}a l'tom $\alpha$ en la direcci贸 $i$

\begin{equation}
D_{\alpha\alpha\prime}^{ij}(\vec q)=\frac{\partial}{\partial u^{*\alpha}_{i}}F^{j}_{\alpha'}(\vec q)
\end{equation}

\vdots

\begin{equation}
 \label{eq:matriu_dinmica}
 \boxed{
 \vec D^{\alpha',\alpha}(q)=\frac{1}{\sqrt{M_\alpha' M_{\alpha}}}\sum_\vec l\vec\Phi^{\alpha',\alpha}\left(\vec R_\vec l\right)e^{-i\vec q\cdot\vec R_\vec l}}
\end{equation}


%Obtesses les posicions dels toms y classificats estos com primers, segons, etc. ve茂ns, segons la distncia al respectiu tom de la ce\l.la $\vec 0$, procedim a calcular la contribuci贸 a la matriu dinmica de cadascun dels toms, per la qual cosa necessitem con猫ixer el tensor de constants de for\c{c}a que correspon a la interacci贸 de cada tom amb el seu n-猫ssim ve铆.


Per calcular la matriu dinmica emprant el model de constants de forces necessitem, per tant, constuir el tensor de constants de forces. Anem a suposar que les forces entre toms sols depenen del tipus d'elements de la taula peri貌dica a la que pertany cada tom considerat i de la seua distncia relativa.

Considerem un tom de tipus $\alpha$ situat en la cel路la $\vec l$ a una certa distncia, $|\vec R_{\alpha,\vec l}-\vec R_{\alpha',\vec{l'}}|$ de l'tom de tipus $\alpha'$  situat en la cel路la $\l'$, i escollint el sistema de coordenades cartesianes de manera que la direcci贸 del vector que uneix ambd贸s toms coincideix amb l'eix de les $x$, escollim l'eix $y$ com la coordenada transversal en el plnol, $ti$, i $z$ la coordenada perpendicular al plnol $to$, podem escriure el tensor de forces d'este tom (que segons el m貌dul de la distncia a l'tom $\alpha'$ classificarem com $n$-猫ssim ve铆) de la forma \cite{wirtz04_phonon_disper_graph_revis}:


\begin{equation}
\vec\Phi_n^{\alpha',\alpha}=\begin{pmatrix}
\phi_{n,to}^{\alpha',\alpha}&\xi_n^{\alpha',\alpha} &0\\
-\xi_n^{\alpha',\alpha} & \phi_{n,ti}^{\alpha',\alpha} & 0 \\
0 & 0 & \phi_{n,to}^{\alpha',\alpha}
\end{pmatrix}
\label{eq:tensordeforces}
\end{equation}

L'estructura diagonal a blocs de la matriu reflexa el fet que estem supossant que  les vibracions interplanars y les de fora de pla, $to$, (en la direcci贸 $z$) estan completament desacoblades.

Anem a suposar (simplificant encara m茅s com s贸n les interaccions entre toms) que un despla\c{c}ament longitudinal (radial, que estar cont茅s en el planol del cristall) o transversal (tangencial, siga en el planol o perpendicular al plnol) sols genera una for\c{c}a radial o transversal, es a dir, $\xi_n^{\alpha,\alpha'}=0$ tal y com es realitza en \cite{Balkanski_2000}. %Esta aproximaci贸 es coneix com la aproximaci贸 dels quatre ve茂ns m茅s pr貌xims \textit{4NNFC},% i es necessita considerar fins els cuarts ve茂ns per donar compte dels resultats experimentals.

%\missingfigure{Ac铆 va imatge mostrant el cristall i les forces}


%\begin{figure}[h]
%\centering
%\includegraphics[width=40mm,height=40mm]{example-image-a}
%\caption{Caption}
%\end{figure}


%Una altra aproximaci贸 al problema trobada en la literatura sobre els fonons del graf茅 茅s la coneguda com el modelo \textit{VFF} (\textit{valence-force field}), la qual determina els parmetros de la matriu en l'equaci贸 \ref{eq:tensordeforces} introdu茂nt \textit{constants de moll} que determinen el canvi en l'energia potencial segons diferents deformacions; una introducci贸n a esta aproximaci贸 es troba en l'annexe de la refer猫ncia (cite aizawa90 bond soften monol graph formed). Amb aquesta aproximaci贸 es necesiten menys parmetres (\textit{constantes de fuerza}) per  obtindre una qualitat similar a la parametrizaci贸 \textit{4NNFC} (cite wirtz04 phonon disper graph revis).

Per tant, anem a considerar que el tensor de constants de forces  d'un tom $\alpha$ classificat com $n$-猫ssim ve铆, situat en la direcci贸 $\hat x$ respecte de l'谩tom  $\alpha'$, t茅 la forma diagonal (notem que en la xarxa real que estem estudiant no t茅 perque haver cap $n$-猫ssim vei en aquesta posici贸):

\begin{equation}
\vec\Phi_n^{\alpha'\alpha}=\begin{pmatrix}
\phi_{n,to}^{\alpha,\alpha}&0 &0\\
0& \phi_{n,ti}^{\alpha',\alpha} & 0 \\
0 & 0 & \phi_{n,to}^{\alpha',\alpha}
\end{pmatrix}
\label{eq:tensordeforcessimplificat}
\end{equation}

Per calcular el tensor de constants de forces de cadascun dels altres $n$-猫ssims ve茂ns reals de l'atom $\alpha'$ tenim que rotar la matriu de l'equaci贸 \ref{eq:tensordeforcessimplificat}:

\begin{equation}
 \vec\Phi_n^{\alpha'\alpha}(\theta)=\vec U^{-1}(\theta)\vec\Phi_n^{\alpha'\alpha}(0)\vec U(\theta)
\end{equation}


on $\vec U(\theta)$ ve donada per:
\begin{equation}
\vec U(\theta)=
\begin{pmatrix}
\cos(\theta)  & \sin(\theta) & 0 \\
-\sin(\theta) & \cos(\theta) & 0  \\
0             & 0            & 1
\end{pmatrix}
\end{equation}


Una vegada que sabem com tenim que construir el tensor de constants de forces, el clcul de la matriu dinmica 茅s directe, ja que sols tenim que fer 煤s de l'equaci贸 \ref{eq:matriu_dinmica}, 茅s a dir multipliquem el tensor de constants de forces del 谩tom considerat per la fase, $e^{i \vec q\cdot \vec R_\vec l}$, on recordem, $\vec R_\vec l=l_1 \vec a_1+ l_2 \vec a_2$

En el codi programat per calcular l'expressi贸 de la matriu dinmica pot observar-se que l'he constru茂t a capes i un punt important 茅s que quan es calcula la matriu dinmica per a segons ve茂ns, com estem considerant la interacci贸 entre toms del mateix tipus (de la mateixa subxarxa, no tenen perqu猫 ser del mateix element, encara que en el cas del $BN$ 茅s f谩cil discriminar-los, ja que s铆 s贸n toms d'elements distints els que conformen la base), tenim que considerar la contribuci贸 a la matriu dinmica de l'tom situat en la cel路la $\vec l=\vec 0$. Per a estos toms no necessitem escriure el tensor de constants de forces (ni la matriu dinmica) explicitament, ja que la seua contribuci贸 la podem calcular a partir del fet que si traslladem el conjunt d'toms la for莽a total 茅s nula (si es despla莽a el cristall com un tot no canvia l'energia potencial) i tal com ve indicat en \cite{falkovsky08_symmet_const_phonon_disper_graph}

Podem tindre en compte altres simetries del cristall per determinar certes propietats del tensor de forces o de la seua transformada de Fourier, la matriu dinmica (certes relacions entre les components ...) per貌 per ara sols tindrem en compte que la matriu dinmica es una matri herm铆tica, i per tant els seus valors propis, $\omega^2$ tenen que ser reals.
vspace{5cm}


Tenim per tant que la matriu dinmica ser una matriu $6x6$ herm铆tica. Per貌 donat que les components en $z$ d'esta matriu es troben desacoblades podem tractar aquestes vibracions de manera independent.

 
%En este treball, per constuir la matriu de constants de forces $\vec\Phi_{\alpha,\alpha'}$, el que faig es classificar els toms per la seua distncia i sumar els tensors segons est distncia 


\


\newpage
\section{Eines emprades}

Els clculs s'han realitzat en el llenguatge de programaci贸 python \cite{4160250}, emprant el software matematic Sagemath \cite{sagemath} i biblioteques disponibles per aquest llenguatge orientades a clcul numeric com numpy \cite{harris2020array} i scipy \cite{2020SciPy-NMeth}. Com a entorn de desenvolupament s'ha emprat \href{https://jupyter.org/}{jupyterlab} i \href{https://git-scm.com/}{git} com sistema de control de versions distribu茂t. 

El projecte, incloent els \textit{\foreignlanguage{english}{jupyter notebooks}} amb els clculs, es troba accessible al repositori p煤blic de github \href{https://github.com/CasimirVictoria/TFG-Semiconductores\_2D}{TFG-Semiconductores\_2D}. Aix铆 mateix, una versi贸 en l铆nea  es troba publicada en \href{https://casimirvictoria.github.io/TFG-Semiconductores_2D/index.html}{github pages}; la creaci贸 i publicaci贸 d'esta versi贸 online s'ha realitzat automticament a partir dels \textit{notebooks} emprant \href{https://jupyterbook.org/intro.html}{jupyterbook}.

Jupyter/Jupyterlab ha demostrat ser un entorn fantstic (i molt popular) per a programar en python (i altres llenguatges), per貌 al no emprar fitxers de text pla (en este cas fitxers amb codi python), dificulta emprar eines de control de versions de codi com git. Per aquesta ra贸 sha emprat tamb茅 el plugin \href{https://jupytext.readthedocs.io/en/latest/}{jupytext} per a Jupyter, que permet tindre sincronitzat el notebook amb un fitxer en text pla (amb el codi en python, markdown, etc.). En este projecte he decidit emprar el format \href{https://jupyterbook.org/content/myst.html}{myst markdown}, de manera que des de jupyterlab obric un fitxer markdown i la extensi贸 jupytext mant茅 un fitxer en format \textit{.ipynb} sincronitzat amb este fitxer i que 茅s amb el realment que treballa jupyterlab. Este \emph{notebook} l'exporte despr茅s a un fitxer python que carregue posteriorment al fitxer \LaTeX, on he escrit la mem貌ria emprant el paquet \href{https://ctan.org/pkg/sagetex}{sagetex}, de manera que puc incloure tots els clculs realitzats (incloent expressions anal铆tiques, no sols num猫riques i grfics) de manera automtica en la mem貌ria sense tindre que escriure-la manualment.

Notem que tot els software emprat per a la realitzaci贸 del treball es de codi obert i gratu茂t.


Passem ara a descriure el sistema que s'ha estudiat i els resultats dels clculs realitzats.

\newpage
\section{Descripci贸 del cristall de BN}

Donat que el clcul dels modes de vibraci贸 comen\c{c}a per establir la geomeria del cristall en equilibri, comprobem amb les dades proporcionades que el $BN$ monocapa es tracta d'un cristall bidimensional hexagonal de base diat贸mica, la ce\l.la unitat del qual ve donada per (dades proporcionades):

\begin{sagesilent}
load("formulacio_matriu_dinamica.sage")
\end{sagesilent}

\begin{equation}
\vec a_1=\sage{a_1}\qquad\vec a_2=\sage{a_2} 
\end{equation}

Podem comprobar que efectivament es tracta de una ce\l.la hexagonal, ja que els seus vectors primitius formen un angle de $\sage{arccos(a_1*a_2/(norm(a_1)*norm(a_2)).simplify())}$ \SI{}{\radian}.

Les posicions at貌miques d'equilibri en la ce\l.la unitat s贸n:

\begin{equation}\begin{split}
\vec d_B=&\frac{1}{3}\vec{a_1}+2\vec{a_2}=\sage{r_B}\qquad\\
\vec d_N=&\frac{2}{3}\vec{a_1}+\frac{1}{3}\vec{a_2}=\sage{r_N} 
\end{split}\end{equation} 


\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{xarxa, figsize=3}
\caption{Xarxa de nucs}
\end{subfigure}
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{cela, figsize=3}
\caption{Ce\l.la unitat}
\end{subfigure}
\begin{subfigure}[b]{0.3\textwidth}
\centering
\sageplot[width=\textwidth]{AtomsB+AtomsN, figsize=3}
\caption{Cristall}
\end{subfigure}
\end{figure}

%Per construir la matriu dinmica necessitem com a pas previ classificar el 谩toms del cristall segons la seua distncia als toms de la ce\l.la unitat, ja que els clasificarem com primers, segons, tercers ... ve茂ns segons aquesta distncia i els asignarem un tensor de constants de forces que dependr谩 de a quina familia de ve茂ns pertanyen. 


\subsection{Primera zona de Brillouin}
Passe ara a mostrar la xarxa $2\pi$-rec铆proca associada a la xarxa de nucs del cristall de $BN$, la primera zona de Brillouin y calcular els punts de mxima simetria de la primera zona de Brillouin:

Els vectors primitius de la xarxa $2\pi\text{-rec铆proca}$ s贸n:

\begin{equation}
\label{eq:11}
\vec b_1=\frac{2\pi}{a}\left(\hat k_{x}+\frac{1}{\sqrt{3}}\hat k_{y}\right)\quad \vec b_2=\frac{2\pi}{a}\left(\frac{2}{\sqrt{3}}\hat k_y\right)
\end{equation} 

i la xarxa $2\pi$-rec铆proca 茅s:

\missingfigure{Aci falta incloure la grafica de la xarxa $2\pi$, de la zona de brillouin, i possar els punts de mxima simetria d'aquesta, fet per mi, clar}

\begin{sagesilent}
import numpy as np
import matplotlib.pyplot as plt
import pybinding as pb

a_1_rec=np.array([1,1/sqrt(3)])
a_2_rec=np.array([0,2/sqrt(3)])
  
def R_l_rec(l_1,l_2):
    return 2*np.pi*l_1*a_1_rec+2*np.pi*l_2*a_2_rec 

reddenudos=np.array([R_l_rec(l_1,l_2) for l_1 in range(-5, 5) for l_2 in range(-3,4)])

  
x = reddenudos[:,0]
y = reddenudos[:,1]
plt.plot(x,y,"o")
plt.axis('scaled')
plt.savefig("../Grafiques/Xarxa2pireciproca.jpg")
plt.close()

#from math import sqrt, pi

pb.pltutils.use_style()
from pybinding.repository.graphene.constants import a_cc, t

a = 56 / 55 * a_cc  # ratio of lattice constants is 56/55, in [nm] unit cell length
#t in [eV] hopping energy

vn = -1.4  # [eV] nitrogen onsite potential
vb = 3.34  # [eV] boron onsite potential

# create a simple 2D lattice with vectors a1 and a2
lattice = pb.Lattice(a1=[a, 0], a2=[-a/2, np.sqrt(3)*a/2])
lattice.add_sublattices(
('B', [0, np.sqrt(3)*a/3], vb), # add an atom called 'A' at position [0, 0]
('N', [a/2,np.sqrt(3)*a/6] ,vn )
)

lattice.add_hoppings(
        ([ 0,  0], 'B', 'N', t),
        ([ -1, 0], 'B', 'N', t),
        ([0,  1], 'B', 'N', t)
    )


lattice.plot()
lattice.plot_brillouin_zone()
plt.savefig("../Grafiques/1aBZ.jpg")
plt.close()
reset('a')
var('a', domain='positive')
\end{sagesilent}

\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=8cm]{../Grafiques/Xarxa2pireciproca.jpg}
\subcaption{Xarxa en l'espai $2\pi$-rec铆proc}
\end{subfigure}
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=6cm]{../Grafiques/1aBZ.jpg}
\subcaption{Primera zona de Brillouin}
\end{subfigure}
\end{figure}


\newpage
Passem ja a estudiar les vibracions en el $BN$.
\subsection{Vibracions transversales fora de pla}
Donat que en el nostre model, per com hem constru茂t la matriu dinmica, les vibracions fora de pla s贸n independents de les interplanars passem a estudiar les primeres, ja que s贸n m茅s sencilles (traballarem amb una matriu 2x2). 

\subsubsection{En $\Gamma (k_x=0, k_y=0)$}
Al punt $\Gamma$, ($q_x=0, q_y=0$), la matriu din谩mica per a les vibracions fora de pla pren el valor:

\begin{sagesilent}
from periodictable import C, B, N, constants
u=constants.atomic_mass_constant*10**3 #para que este en CGS (y las const. de fuerza en dyn)

omega_Gamma_ZO=830 #cm-1
omega_Gamma_ZA=0

D_Gamma_zz=D_zz.subs(q_x=0,q_y=0) #,(M_B,B.mass*u),(M_N,N.mass*u)])
Eq1=(D_Gamma_zz.eigenvalues()[0]==omega**2).subs(omega=omega_Gamma_ZO)
\end{sagesilent}

\begin{equation}
\sage{D_Gamma_zz}
\end{equation}

i es seus valors propis son:

\begin{align*}
\omega_{ZO}^2(\Gamma)&=\sage{D_Gamma_zz.eigenvalues()[0]}\\
\omega_{ZA}^2(\Gamma)&=\sage{D_Gamma_zz.eigenvalues()[1]}
\end{align*}


\subsubsection{En $K$ ($q_x=4\pi/(3 a)$, $q_y=0$)}
Els valors propios de la matriu dinmica en aques punt s贸n:
\begin{sagesilent}
omega_K_ZO=605 #cm-1
omega_K_ZA=322
D_K_zz=D_zz.subs(q_x=4*pi/(3*a),q_y=0)
Eq1=(D_Gamma_zz.eigenvalues()[0]==omega**2).subs(omega=omega_Gamma_ZO)
solEq1=solve(Eq1, phi3toBN)
\end{sagesilent}

\begin{align*}
\omega_{ZO}^2(K)&=\sage{D_K_zz.eigenvalues()[0]}\\
\omega_{ZA}^2(K)&=\sage{D_K_zz.eigenvalues()[1]}
\end{align*}


Podem observar que en el cas del $BN$, a difer猫ncia del cas del graf茅, obtenim 2 freq眉猫ncies distintes al punt $K$ degut a que en la base tenim dos toms distints.

\begin{sagesilent}
sol=[]
Eq2=(D_K_zz.eigenvalues()[0]==omega**2).subs(omega=omega_K_ZO)
Eq3=(D_K_zz.eigenvalues()[1]==omega**2).subs(omega=omega_K_ZA)
sol.append(solve(Eq2.subs(solEq1),phi2toNN)[0])
sol.append(solve(Eq3.subs(solEq1),phi2toBB)[0])
\end{sagesilent}

\subsubsection{En el punt $M(q_x=\pi/a,q_y=\pi/(\sqrt 3 a)$}

\begin{sagesilent}
omega_M_ZO=635 #cm-1
omega_M_ZA=314

D_M_zz=D_zz.subs(q_x=pi/a,q_y=pi/(sqrt(3)*a))
#D_M_zz.eigenvalues()
#Podemos simplificar un poco la expresi贸n obtenida para los valores propios en el punto    (simplemente reescribiendo el argumento de la raiz cuadrada)

omegaM1cuadrado=-4*phi2toBB/M_B-4*phi2toNN/M_N-3/sqrt(M_B*M_N)*(phi1toBN+phi3toBN)-sqrt(M_B*M_N*(phi1toBN-3*phi3toBN)^2+(4*(M_N*phi2toBB-M_B*phi2toNN))^2)/(M_B*M_N)

#if bool(D_M_zz.eigenvalues()[0]==omegaM1cuadrado):
#    show(omegaM1cuadrado)

omegaM2cuadrado=-4*phi2toBB/M_B-4*phi2toNN/M_N-3/sqrt(M_B*M_N)*(phi1toBN+phi3toBN)+sqrt(M_B*M_N*(phi1toBN-3*phi3toBN)^2+(4*(M_N*phi2toBB-M_B*phi2toNN))^2)/(M_B*M_N)

#if bool(D_M_zz.eigenvalues()[1]==omegaM2cuadrado):
#    show(omegaM2cuadrado)
\end{sagesilent}

\begin{small}
\begin{align*}
\omega_{ZO}^2(M)&=\sage{omegaM1cuadrado}\\
\omega_{ZA}^2(M)&=\sage{omegaM2cuadrado}
\end{align*}
\end{small}

Comprobem que les expresions obtesses es redueixen a les que apar茅ixen en la ref: Falkowsky en el cas que es toms de la base foren iguals.

\begin{sagesilent}
Eq5=(omegaM1cuadrado==omega_M_ZO**2)
Eq6=(omegaM2cuadrado==omega_M_ZA**2)

sol1=(phi1toBN==n(solve(((Eq6-Eq5)**2).subs(solEq1), phi1toBN)[0].subs(sol[0], sol[1]).subs(M_B=B.mass, M_N=N.mass).rhs()))

sol2=sol[0].subs(M_N=N.mass)

sol3=sol[1].subs(M_B=B.mass)

sol4=solEq1[0].subs(M_B=B.mass, M_N=N.mass).subs(sol1)

\end{sagesilent}

De manera que los valores que obtenemos para las cuatro constantes de fuerza consideradas son:

\begin{align*}
&\sage{sol1}\qquad& \sage{sol2}\\
&\sage{sol3}\qquad& \sage{sol4}
\end{align*}

Y les relacions de dispersi贸 per als modes $ZO$ i $ZA$ tenen la foma:

%\sagetexpause
\begin{sagesilent}
from pylab import loadtxt
#data = pd.read_csv('../Dades/freq.dat', header = None)
dades=loadtxt("../Dades/freq.dat")
ZAZO=\
list_plot(
    [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
        M_N=N.mass, a=1, q_x=n(x*pi), q_y=n(x*pi/sqrt(3))).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)] +\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(pi*(1+x/3)), q_y=n(pi/sqrt(3)*(1-x))).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)]+\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(4*pi/3*(1-x)), q_y=0).simplify_full().eigenvalues()[1]))) \
        for x in srange(0,1,0.1)]) + \
list_plot(
    [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
        M_N=N.mass, a=1, q_x=n(x*pi), q_y=n(x*pi/sqrt(3))).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]+
          [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1,q_x=n(pi*(1+x/3)), q_y=n(pi/sqrt(3)*(1-x))).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]+\
         [real_part(n(sqrt(D_zz.subs(sol1, sol2, sol3, sol4, M_B=B.mass, \
M_N=N.mass, a=1, q_x=n(4*pi/3*(1-x)), q_y=0).simplify_full().eigenvalues()[0]))) \
        for x in srange(0,1,0.1)]) \
     +line([(10,0),(10,1600)], color="black")+line([(20,0),(20,1600)], color="black")\
     +line([(30,0),(30,1600)], color="black", ticks=[[0.05,10,20,30], None], \
        tick_formatter = [[r'$\Gamma$', '$M$', '$K$', r'$\Gamma$'], None])+\
points(zip(dades[:524,0]/524*30, dades[:524,1]), color="red") +\
points(zip(dades[524:1048,0]/524*30, dades[524:1048,1]), color="brown") +\
points(zip(dades[1048:1572,0]/524*30, dades[1048:1572,1]), color="black") +\
points(zip(dades[1572:2096,0]/525*30, dades[1572:2096,1]), color="pink") +\
points(zip(dades[2096:2620,0]/525*30, dades[2096:2620,1]), color="steelblue") +\
points(zip(dades[2620:3144,0]/525*30, dades[2620:3144,1]), color="blue")

\end{sagesilent}

\begin{figure}[h]
\centering
 \sageplot{ZAZO,figsize=6}
\end{figure}

%\sagetexunpause


Passem ara a estudiar les vibracions dins del pla del cristall.

\newpage
\subsection{Vibracions dins del pla del cristall}
En este cas tractem amn una matriu $4\times 4$, i per tant tenim 4 valors propis ($\omega^2$)

\begin{sagesilent}
D1BN_xy=D1BN.matrix_from_rows_and_columns([0,1],[0,1])
D1NB_xy=D1NB.matrix_from_rows_and_columns([0,1],[0,1])

D2BB_xy=D2BB.matrix_from_rows_and_columns([0,1],[0,1])
D2NN_xy=D2NN.matrix_from_rows_and_columns([0,1],[0,1])
               
D3BN_xy=D3BN.matrix_from_rows_and_columns([0,1],[0,1])
D3NB_xy=D3NB.matrix_from_rows_and_columns([0,1],[0,1])
#D4BN_xy=D4BN.matrix_from_rows_and_columns([0,1],[0,1])
#D4NB_xy=D4NB.matrix_from_rows_and_columns([0,1],[0,1])

D_xy=block_matrix([[D2BB_xy, D1BN_xy+D3BN_xy],[D1NB_xy+D3NB_xy, D2NN_xy]])
\end{sagesilent}

\subsubsection{Al punt $\Gamma$}

Al punt $\Gamma$ obtinc 2 valors propis, de multiplicitat $2$ cadascun:
\begin{sagesilent}
D_Gamma_xy=D_xy.subs(q_x=0,q_y=0)
\end{sagesilent}

\begin{align*}
\omega_{1,2}^2(\Gamma)&=\sage{D_Gamma_xy.eigenvalues()[0]}\\
\omega_{3,4}^2(\Gamma)&=\sage{D_Gamma_xy.eigenvalues()[3]}
\end{align*}

El programa (escrit en python emprant \textcolor{blue}{sagemath}, que per a la diagonalitzaci贸 de matrius empra el programa \textcolor{red}{maxima}) no consigueix trobar un resultat anal铆tic \textit{sencill} per als valors propis de la matriu dinmica als punts $M$ i $K$, de manera que anem a intentar obtindre algun resultat aproximat realitzant algunes simplificacions; en particular anem a considerar:

\begin{itemize}

\item Les masses dels toms s贸n iguals $M_N=M_B$
\item Les constants de for\c{c}a entre toms del mateix tipus s贸n tamb茅 iguals: $\phi_{2,r}^{NN}=\phi_{2,r}^{BB}$, $\phi_{2,ti}^{NN}=\phi_{2,ti}^{BB}$ 
\end{itemize}

Emprant aquestes aproximacions (m茅s endavant veurem que no fa falta fer tantes simplificacions, podem no igualar alguna de les dues constants anteriors), obtenim

\subsubsection{Al punt $M$}

Obtinc 4 valors propis distints, cosa que sembla raonable observant la grfica de les dades proporcionades.
\begin{sagesilent}
D_M_xy=D_xy.subs(q_x=pi/a,q_y=pi/(sqrt(3)*a), phi2rNN=phi2rBB,phi2tiNN=phi2tiBB, M_N=M_B)
\end{sagesilent}

\begin{align*}
\omega_1^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[0]}\\
\omega_2^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[1]}\\
\omega_3^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[2]}\\
\omega_4^2(\Gamma)&=\sage{D_M_xy.eigenvalues()[3]}
\end{align*}

\newpage

\subsubsection{Al punt $K$}

En este punt el programa en dona 3 valors propis, un d'ells amb multiplicitat $2$, i observant la grfica de les dades proporcionades sembla tamb茅 raonable que en primera aproximaci贸 un dels valors propis estiga degenerat (podem observar que tenim $2$ freq眉猫ncies al punt $K$ molt pr貌xims entre ells)

\begin{sagesilent}
D_K_xy=D_xy.subs(q_x=4*pi/(3*a),q_y=0, phi2rNN=phi2rBB,phi2tiNN=phi2tiBB, M_N=M_B)\end{sagesilent}

\begin{align*}
\omega_1^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[0]}\\
\omega_2^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[1]}\\
\omega_{3,4}^2(\Gamma)&=\sage{D_K_xy.eigenvalues()[2]}
\end{align*}

Passem ara a intentar calcular els valors de les constants de for\c{c}a, emprant els valors de les freq眉猫ncies dels modes de vibraci贸 en estes punts de la primera zona de Brillouin.
\newpage


\bibliography{TFG-Casimir}
\bibliographystyle{plain}

\end{document}
