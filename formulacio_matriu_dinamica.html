
<!DOCTYPE html>

<html lang="ca">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Descripció del cristall de BN &#8212; Fonons en semiconductors bidimensionals</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Conclusions / Conclusions" href="Conclusions.html" />
    <link rel="prev" title="Introducció teòrica" href="introduccio.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo_tfg.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fonons en semiconductors bidimensionals</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Cerca en aquest llibre ..." aria-label="Cerca en aquest llibre ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Sobre este treball
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduccio.html">
   Introducció teòrica
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Descripció del cristall de BN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Conclusions.html">
   Conclusions /
   <em>
    Conclusions
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliografia.html">
   Referències
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Commuta la navegació" aria-controls="site-navigation"
                title="Commuta la navegació" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Descarregueu aquesta pàgina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/formulacio_matriu_dinamica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Descarregar fitxer de quadern" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/formulacio_matriu_dinamica.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Baixeu el fitxer font" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimeix a PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Dipòsit de fonts"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fformulacio_matriu_dinamica.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Obriu un número"><i class="fas fa-lightbulb"></i>número obert</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/formulacio_matriu_dinamica.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Llançament Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#identificacio-dels-veins-segons-la-seua-distancia">
   Identificació dels veins segons la seua distància
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tensor-de-constants-de-forca-i-matriu-dinamica">
   Tensor de constants de forca i matriu dinàmica
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vibracions-fora-de-pla">
   Vibracions fora de pla
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primer-considerem-fins-3ers-veins">
     Primer considerem fins 3ers veïns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#punt-gamma">
       Punt
       <span class="math notranslate nohighlight">
        \(\Gamma\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#punt-m">
       Punt
       <span class="math notranslate nohighlight">
        \(M\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#punt-k">
       Punt
       <span class="math notranslate nohighlight">
        \(K\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#constants-de-forca">
       Constants de força
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fins-4ts-veins">
     Fins 4ts veïns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Punt
       <span class="math notranslate nohighlight">
        \(\Gamma\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Punt
       <span class="math notranslate nohighlight">
        \(M\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Punt
       <span class="math notranslate nohighlight">
        \(K\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Constants de força
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vibracions-al-pla-del-cristall">
   Vibracions al pla del cristall
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#considerem-sols-fins-als-3ers-veins">
     Considerem sols fins als 3ers veïns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#al-punt-gamma">
       Al punt
       <span class="math notranslate nohighlight">
        \(\Gamma\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#al-punt-m">
     Al punt
     <span class="math notranslate nohighlight">
      \(M\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#al-punt-k">
     Al punt
     <span class="math notranslate nohighlight">
      \(K\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Fins 4ts veïns
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="descripcio-del-cristall-de-bn">
<h1>Descripció del cristall de BN<a class="headerlink" href="#descripcio-del-cristall-de-bn" title="Link permanent a aquest títol">¶</a></h1>
<p>Passem ara a descriure el sistema que s’ha estudiat i els resultats dels càlculs realitzats.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En este notebook va la major part del codi. De fet és on estan tots els càlculs. La major part dels quals no és mostra per defecte, però polsant en la icona <span class="math notranslate nohighlight">\(+\)</span> es desplega la cel·la amb el codi.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En firefox cambiar «Math Renderer a Mathml o SVG» per visualitzar millor tant la web com el notebook, pulsant amb el botó dret del ratoli sobre qualsevol de les equacions.</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Netejem totes les variables </span>
<span class="n">reset</span><span class="p">()</span>

<span class="c1"># Eixida per defecte en LaTeX. </span>
<span class="o">%</span><span class="k">display</span> latex

<span class="c1"># Importe les biblioteques i mètodes que empre al llarg de l&#39;script</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">loadtxt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span>
<span class="c1">#from myst_nb import glue</span>

<span class="c1"># Constants emprades</span>
<span class="kn">from</span> <span class="nn">periodictable</span> <span class="kn">import</span> <span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">constants</span>
<span class="n">u</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">atomic_mass_constant</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1">#para que este en CGS (y las const. de fuerza en dyn)</span>

<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">c</span>

<span class="c1"># Defineisc algunes funcions que empraré més endavant</span>
<span class="k">def</span> <span class="nf">matriu_simplificada</span><span class="p">(</span><span class="n">matriu</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="n">matsimp</span><span class="o">=</span><span class="n">matriu</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
             <span class="n">matsimp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">matriu</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">matsimp</span>
</pre></div>
</div>
</div>
</div>
<p>Donat que el càlcul dels modes de vibració comença per establir la geometria del cristall en equilibri, comprovem amb les dades proporcionades que el <span class="math notranslate nohighlight">\(BN\)</span> monocapa es tracta d’un cristall bidimensional hexagonal de base diatòmica, la cel·la unitat del qual ve donada per (dades proporcionades):</p>
<div class="math notranslate nohighlight">
\[
\vec a_1=a(1,0);\qquad\vec a_2=a\left(-\frac{1}{2},\frac{\sqrt{3}}{2}\right);
\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">a_1</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">a_2</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Comprobem que efectivament els dos vectors base formen un angle de</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle</span><span class="o">=</span><span class="n">arccos</span><span class="p">(</span><span class="n">a_1</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">a_1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">a_2</span><span class="p">)))</span>
<span class="c1">#glue(&quot;angle_cela&quot;, angle, display=False)</span>
<span class="n">show</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="s2">&quot; radians&quot;</span><span class="p">)</span>
<span class="c1">#In-line text; {glue:}`angle`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{2}{3} \, \pi \phantom{\verb!x!}\verb|radians|</script></html></div></div>
</div>
<p>Numerem les cel·les unitat amb un índex vectorial <span class="math notranslate nohighlight">\(\vec l=\left( l_1, l_2\right)\)</span>.</p>
<p>Les posicions dels nucs són <span class="math notranslate nohighlight">\(\vec R_{\vec l}=l_1\vec{a}_1+l_2\vec{a}_2\)</span><p>
Visualitzem una regió de la xarxa hexagonal, amb els corresponents nucs (que no àtoms), així com la corresponent cel·la unitat,</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nucs</span><span class="o">=</span><span class="n">points</span><span class="p">([</span><span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span> <span class="k">for</span> <span class="n">l_1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">l_2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span> 
             <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">xarxa</span><span class="o">=</span><span class="n">nucs</span><span class="o">+</span>\
    <span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">xarxa</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">xarxa</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;../Grafiques/Xarxa.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_9_0.png" src="_images/formulacio_matriu_dinamica_9_0.png" />
</div>
</div>
<p>Les posicions atòmiques d’equilibri en la cel·la unitat són (també proporcionades com a dades):</p>
<div class="math notranslate nohighlight">
\[
\vec R_B=\frac{1}{3}\vec{a_1}+2\vec{a_2}\qquad
\vec R_N=\frac{2}{3}\vec{a_1}+\frac{1}{3}\vec{a_2}
\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_B</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a_2</span><span class="p">;</span> <span class="n">r_N</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a_2</span>
<span class="n">cela</span><span class="o">=</span><span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
      <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
      <span class="n">line</span><span class="p">([(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
      <span class="n">line</span><span class="p">([(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="p">),(</span><span class="n">a_2</span><span class="o">/</span><span class="n">a</span><span class="o">+</span><span class="n">a_1</span><span class="o">/</span><span class="n">a</span><span class="p">)],</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
      <span class="n">point</span><span class="p">(</span><span class="n">r_B</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
      <span class="n">point</span><span class="p">(</span><span class="n">r_N</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">cela</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">cela</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;../Grafiques/Cela.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_11_0.png" src="_images/formulacio_matriu_dinamica_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">r_B</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">r_N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(0,\,\frac{1}{3} \, \sqrt{3} a\right)</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\frac{1}{2} \, a,\,\frac{1}{6} \, \sqrt{3} a\right)</script></html></div></div>
</div>
<div class="section" id="identificacio-dels-veins-segons-la-seua-distancia">
<h2>Identificació dels veins segons la seua distància<a class="headerlink" href="#identificacio-dels-veins-segons-la-seua-distancia" title="Link permanent a aquest títol">¶</a></h2>
<p>Per construir la matriu dinàmica necessitem com a pas previ classificar el átoms del cristall segons la seua distància als àtoms de la cel·la unitat, ja que els classificarem com primers, segons, tercers … veïns segons aquesta distància i els assignarem un tensor de constants de forces que dependrá de a quina familia de veïns pertanyen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Posicins d&#39;equilibri dels àtoms en la cel·la (l1, l2)</span>
<span class="k">def</span> <span class="nf">RB</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">+</span><span class="n">r_B</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RN</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">+</span><span class="n">r_N</span><span class="p">)</span>

<span class="n">AtomsB</span><span class="o">=</span><span class="n">points</span><span class="p">([</span><span class="n">RB</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">/</span><span class="n">a</span> <span class="k">for</span> <span class="n">l_1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">l_2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">AtomsN</span><span class="o">=</span><span class="n">points</span><span class="p">([</span><span class="n">RN</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">/</span><span class="n">a</span> <span class="k">for</span> <span class="n">l_1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">l_2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">AtomsB</span><span class="o">+</span><span class="n">AtomsN</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">AtomsB</span><span class="o">+</span><span class="n">AtomsN</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;../Grafiques/Cristall.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_15_0.png" src="_images/formulacio_matriu_dinamica_15_0.png" />
</div>
</div>
<div class="cell tag_hide-input tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;q_x, q_y&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">);</span> <span class="n">q</span><span class="o">=</span><span class="n">vector</span><span class="p">([</span><span class="n">q_x</span><span class="p">,</span><span class="n">q_y</span><span class="p">])</span>


<span class="c1">## Paràmetres de la xarxa, de la cel·la i del cristall</span>

<span class="c1">## Vector R_l (vector de translació primitiu)</span>
<span class="k">def</span> <span class="nf">R_l</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span>

<span class="c1">## Vector de posició dels àtomos del cristall (en equilibri)</span>
<span class="k">def</span> <span class="nf">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">+</span><span class="n">r_B</span>

    <span class="k">elif</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l_1</span><span class="o">*</span><span class="n">a_1</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">+</span><span class="n">r_N</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error, alpha sols pot ser 1 o 2 &quot;</span><span class="p">)</span>

<span class="c1">## Vector unitari que uneix un l&#39;àtoms alphaprima de (0,0), amb l&#39;àtom considerat (alpha, l_1,l_2)</span>
<span class="k">def</span> <span class="nf">R_hat</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">-</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">-</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>\
                                                                 <span class="o">-</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">-</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Distància entre l&#39;àtom alphaprima i el seu veï (alpha, l_1,l_2)</span>
<span class="k">def</span> <span class="nf">distancia</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">-</span><span class="n">R_alpha_l</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">/</span><span class="n">a</span>    

<span class="c1">#Fase per poder calcular la matriu dinàmica, notar que emprem R_l, no R_alpha_l</span>
<span class="k">def</span> <span class="nf">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">R_l</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="c1">#Genere una llista amb la distància de cada àtom als àtoms de la cel·la unitat </span>
<span class="k">def</span> <span class="nf">valors_atoms</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span> <span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">R_hat</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>  \
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">l_2</span><span class="p">,</span><span class="n">l_2</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

<span class="c1">## Construisc un DataFrame de pandas amb la informació necessaria per identificar els 1ers, 2ons, ... veïns</span>
<span class="c1">## segons la seua distància a cadascun del àtoms de la cel·la unitat, per comprobar que la classificació es</span>
<span class="c1">## correcta</span>
<span class="n">columnes</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$\alpha\prime$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$l_1$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$l_2$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\hat R$&quot;</span><span class="p">,</span><span class="s1">&#39;Distància&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">llista_atoms</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span> <span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">valors_atoms</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columnes</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Distància&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\alpha\prime$&quot;</span><span class="p">],</span>\
                                                                            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>

<span class="c1">## Mostre el dataframe como una taula per comprobar els càlculs</span>
<span class="n">table</span><span class="p">(</span><span class="n">llista_atoms</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class="notruncate">
<table  class="table_form">
<tbody>
<tr class ="row-a">
<td><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th><script type="math/tex">\alpha\prime</script></th>
      <th><script type="math/tex">\alpha</script></th>
      <th><script type="math/tex">l_1</script></th>
      <th><script type="math/tex">l_2</script></th>
      <th><script type="math/tex">\hat R</script></th>
      <th>Distància</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>[0, 0]</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>[0, 0]</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>[-3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>[3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>[0, sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>[0, -sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>[-3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>[3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>[-1/2, -1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>[-1, 0]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>[1/2, -1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>[-1/2, 1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>[1, 0]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>[1/2, 1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>-1</td>
      <td>[-1/2, -1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>0</td>
      <td>[-1, 0]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>-1</td>
      <td>[1/2, -1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>[-1/2, 1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>[1, 0]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>[1/2, 1/2*sqrt(3)]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>-1</td>
      <td>[0, -sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>1</td>
      <td>[-3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>[3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>[-3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>[3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>[0, sqrt(3)*sqrt(1/3)]</td>
      <td>2*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>-1</td>
      <td>[-3/7*sqrt(7/3), -2/7*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>0</td>
      <td>[-9/14*sqrt(7/3), -1/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>-1</td>
      <td>[3/7*sqrt(7/3), -2/7*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>[-3/14*sqrt(7/3), 5/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>[9/14*sqrt(7/3), -1/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>[3/14*sqrt(7/3), 5/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>-2</td>
      <td>[-3/14*sqrt(7/3), -5/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>[-9/14*sqrt(7/3), 1/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>-2</td>
      <td>[3/14*sqrt(7/3), -5/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>[-3/7*sqrt(7/3), 2/7*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>[9/14*sqrt(7/3), 1/14*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>[3/7*sqrt(7/3), 2/7*sqrt(3)*sqrt(7/3)]</td>
      <td>sqrt(7/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>-1</td>
      <td>[-1/2*sqrt(3), -1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>-2</td>
      <td>[0, -1]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>1</td>
      <td>[-1/2*sqrt(3), 1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>[1/2*sqrt(3), -1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>[0, 1]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>[1/2*sqrt(3), 1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>-1</td>
      <td>[-1/2*sqrt(3), -1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>-2</td>
      <td>[0, -1]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>1</td>
      <td>[-1/2*sqrt(3), 1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>[1/2*sqrt(3), -1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>[0, 1]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>[1/2*sqrt(3), 1/2]</td>
      <td>sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>-2</td>
      <td>[-1/2, -1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>0</td>
      <td>[-1, 0]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-2</td>
      <td>[1/2, -1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>[-1/2, 1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>[1, 0]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>[1/2, 1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>-2</td>
      <td>[-1/2, -1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>0</td>
      <td>[-1, 0]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>-2</td>
      <td>[1/2, -1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>[-1/2, 1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>[1, 0]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>[1/2, 1/2*sqrt(3)]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>-2</td>
      <td>[-3/26*sqrt(13/3), -7/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>1</td>
      <td>[-6/13*sqrt(13/3), 1/13*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>-2</td>
      <td>[3/26*sqrt(13/3), -7/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>2</td>
      <td>[-9/26*sqrt(13/3), 5/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>[6/13*sqrt(13/3), 1/13*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>[9/26*sqrt(13/3), 5/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>-2</td>
      <td>[-9/26*sqrt(13/3), -5/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>-1</td>
      <td>[-6/13*sqrt(13/3), -1/13*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>[9/26*sqrt(13/3), -5/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>[-3/26*sqrt(13/3), 7/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>[6/13*sqrt(13/3), -1/13*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>[3/26*sqrt(13/3), 7/26*sqrt(13/3)*sqrt(3)]</td>
      <td>sqrt(13/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>[3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>4*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>1</td>
      <td>[-3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>4*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>-2</td>
      <td>[9/38*sqrt(19/3), -7/38*sqrt(19/3)*sqrt(3)]</td>
      <td>sqrt(19/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>[15/38*sqrt(19/3), -1/38*sqrt(19/3)*sqrt(3)]</td>
      <td>sqrt(19/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>0</td>
      <td>[-15/38*sqrt(19/3), 1/38*sqrt(19/3)*sqrt(3)]</td>
      <td>sqrt(19/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>[-9/38*sqrt(19/3), 7/38*sqrt(19/3)*sqrt(3)]</td>
      <td>sqrt(19/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>1</td>
      <td>[-5/14*sqrt(7), 1/14*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>2</td>
      <td>[-2/7*sqrt(7), 1/7*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>[2/7*sqrt(7), -1/7*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>-1</td>
      <td>[5/14*sqrt(7), -1/14*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>1</td>
      <td>[-5/14*sqrt(7), 1/14*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>2</td>
      <td>[-2/7*sqrt(7), 1/7*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>[2/7*sqrt(7), -1/7*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>[5/14*sqrt(7), -1/14*sqrt(7)*sqrt(3)]</td>
      <td>sqrt(7)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>2</td>
      <td>[-3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>5*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>[3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>5*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>[15/62*sqrt(31/3), -7/62*sqrt(31/3)*sqrt(3)]</td>
      <td>sqrt(31/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>[9/31*sqrt(31/3), -2/31*sqrt(31/3)*sqrt(3)]</td>
      <td>sqrt(31/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>1</td>
      <td>[-9/31*sqrt(31/3), 2/31*sqrt(31/3)*sqrt(3)]</td>
      <td>sqrt(31/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-1</td>
      <td>2</td>
      <td>[-15/62*sqrt(31/3), 7/62*sqrt(31/3)*sqrt(3)]</td>
      <td>sqrt(31/3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>-2</td>
      <td>2</td>
      <td>[-1/2*sqrt(3), 1/2]</td>
      <td>2*sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>-2</td>
      <td>[1/2*sqrt(3), -1/2]</td>
      <td>2*sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>2</td>
      <td>[-1/2*sqrt(3), 1/2]</td>
      <td>2*sqrt(3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>[1/2*sqrt(3), -1/2]</td>
      <td>2*sqrt(3)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>-2</td>
      <td>[3/2*sqrt(1/3), -1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>7*sqrt(1/3)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>-2</td>
      <td>2</td>
      <td>[-3/2*sqrt(1/3), 1/2*sqrt(3)*sqrt(1/3)]</td>
      <td>7*sqrt(1/3)</td>
    </tr>
  </tbody>
</table></td>
</tr>
</tbody>
</table>
</div></div></div>
</div>
<p>Podem vore que la xarxa <span class="math notranslate nohighlight">\(2\pi\)</span>-recíproca es també una xarxa hexagonal</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">b_1</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="n">b_2</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="n">nucsR</span><span class="o">=</span><span class="n">points</span><span class="p">([</span><span class="n">l_1</span><span class="o">*</span><span class="n">b_1</span><span class="o">/</span><span class="n">b</span><span class="o">+</span><span class="n">l_2</span><span class="o">*</span><span class="n">b_2</span><span class="o">/</span><span class="n">b</span> <span class="k">for</span> <span class="n">l_1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">l_2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span> 
             <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">xarxaR</span><span class="o">=</span><span class="n">nucsR</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">b_1</span><span class="o">/</span><span class="n">b</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
     <span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">b_2</span><span class="o">/</span><span class="n">b</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> 
<span class="n">show</span><span class="p">(</span><span class="n">xarxaR</span> <span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">xarxaR</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;../Grafiques/XarxaR.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_18_0.png" src="_images/formulacio_matriu_dinamica_18_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angleR</span><span class="o">=</span><span class="n">arccos</span><span class="p">(</span><span class="n">b_1</span><span class="o">*</span><span class="n">b_2</span><span class="o">/</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">b_2</span><span class="p">)))</span>
<span class="c1">#glue(&quot;angle_cela&quot;, angle, display=False)</span>
<span class="n">show</span><span class="p">(</span><span class="n">angleR</span><span class="p">,</span> <span class="s2">&quot; radians&quot;</span><span class="p">)</span>
<span class="c1">#In-line text; {glue:}`angle`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{3} \, \pi \phantom{\verb!x!}\verb|radians|</script></html></div></div>
</div>
</div>
<div class="section" id="tensor-de-constants-de-forca-i-matriu-dinamica">
<h2>Tensor de constants de forca i matriu dinàmica<a class="headerlink" href="#tensor-de-constants-de-forca-i-matriu-dinamica" title="Link permanent a aquest títol">¶</a></h2>
<p>Construisc el tensor de constants de forces, així com la matriu dinàmica <em>a capes</em>.
Notar que la contribució a la matriu dinàmica, en les submatrius de la diagonal, les que impliquen elements de la mateixa subxarxa que el (<span class="math notranslate nohighlight">\(\alpha', 0\)</span>), obtenim la contribució dinàmica d’este element sobre sí mateix a partir de la invariança a traslacions del cristall com un tot :cite:<code class="docutils literal notranslate"><span class="pre">falkovsky08_symmet_const_phonon_disper_graph</span></code></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Angle que forma l&#39;àtom considerat respecte a l&#39;eix x</span>

<span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">R_hat</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">acos</span><span class="p">(</span><span class="n">R_hat</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">R_hat</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1">#Matriu unitària de rotació per al canvi d&#39;eixos coordenats (entorn al&#39;eix z)</span>

<span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1">#Matriu de força per als primers veïns</span>

<span class="n">var</span><span class="p">(</span><span class="s1">&#39;M_B,M_N&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">var</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span>

<span class="n">phi1rBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi1rBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{1,r}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi1tiBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi1tiBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{1,ti}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi1toBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi1toBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{1,to}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

<span class="n">phi1rNB</span><span class="o">=</span><span class="n">phi1rBN</span><span class="p">;</span> <span class="n">phi1tiNB</span><span class="o">=</span><span class="n">phi1tiBN</span><span class="p">;</span> <span class="n">phi1toNB</span><span class="o">=</span><span class="n">phi1toBN</span>


<span class="n">Phi_10__BN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi1rBN</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi1tiBN</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi1toBN</span><span class="p">]])</span>
<span class="n">Phi_10__NB</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi1rNB</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi1tiNB</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi1toNB</span><span class="p">]])</span>


<span class="k">def</span> <span class="nf">Phi_1l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_10__BN</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Phi_1l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_10__NB</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">D_1l_BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_1l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">D_1l_NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_1l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="c1"># Matri de força per als segons veïns</span>

<span class="n">phi2rBB</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2rBB&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,r}^</span><span class="si">{BB}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi2tiBB</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2tiBB&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,ti}^</span><span class="si">{BB}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi2toBB</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2toBB&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,to}^</span><span class="si">{BB}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

<span class="n">phi2rNN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2rNN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,r}^</span><span class="si">{NN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi2tiNN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2tiNN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,ti}^</span><span class="si">{NN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi2toNN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi2toNN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{2,to}^</span><span class="si">{NN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

<span class="n">Phi_20__BB</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">M_B</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi2rBB</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi2tiBB</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi2toBB</span><span class="p">]])</span>
<span class="n">Phi_20__NN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">M_N</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi2rNN</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi2tiNN</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi2toNN</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">Phi_2l__BB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_20__BB</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Phi_2l__NN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_20__NN</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">D_2l_BB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_2l__BB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">D_2l_NN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_2l__NN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>


<span class="c1">#Matriu de força per als tercers veïns</span>

<span class="n">phi3rBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi3rBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{3,r}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi3tiBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi3tiBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{3,ti}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi3toBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi3toBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{3,to}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi3rNB</span><span class="p">,</span><span class="n">phi3tiNB</span><span class="p">,</span><span class="n">phi3toNB</span><span class="o">=</span><span class="n">phi3rBN</span><span class="p">,</span><span class="n">phi3tiBN</span><span class="p">,</span><span class="n">phi3toBN</span>
<span class="n">Phi_30__BN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi3rBN</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi3tiBN</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi3toBN</span><span class="p">]])</span>
<span class="n">Phi_30__NB</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi3rNB</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi3tiNB</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi3toNB</span><span class="p">]])</span>
                   
<span class="k">def</span> <span class="nf">Phi_3l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_30__BN</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Phi_3l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_30__NB</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">D_3l_BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_3l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">D_3l_NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_3l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="c1">#Matriu de força per als quart veïns</span>
<span class="n">phi4rBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi4rBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{4,r}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi4tiBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi4tiBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{4,ti}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi4toBN</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;phi4toBN&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">phi_{4,to}^</span><span class="si">{BN}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">phi4rNB</span><span class="p">,</span><span class="n">phi4tiNB</span><span class="p">,</span><span class="n">phi4toNB</span><span class="o">=</span><span class="n">phi4rBN</span><span class="p">,</span><span class="n">phi4tiBN</span><span class="p">,</span><span class="n">phi4toBN</span>

<span class="n">Phi_40__BN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi4rBN</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi4tiBN</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi4toBN</span><span class="p">]])</span>
<span class="n">Phi_40__NB</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">phi4rNB</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">phi4tiNB</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">phi4toNB</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">Phi_4l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_40__BN</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">Phi_4l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span><span class="o">*</span><span class="n">Phi_40__NB</span><span class="o">*</span>\
           <span class="n">U</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">D_4l_BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_4l__BN</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">D_4l_NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Phi_4l__NB</span><span class="p">(</span><span class="n">alphaprima</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span><span class="o">*</span><span class="n">fase</span><span class="p">(</span><span class="n">l_1</span><span class="p">,</span><span class="n">l_2</span><span class="p">)</span>

<span class="c1"># Finalmente construimos la matriz dinámica &quot;a capas&quot;</span>
<span class="c1"># Con la tabla de la celda de codigo anterior comprobamos que para considerar </span>
<span class="c1"># hasta los cuartos vecinos es suficiente con l_1,l_2=2</span>
                   
<span class="n">D1BN</span><span class="p">,</span> <span class="n">D1NB</span><span class="p">,</span> <span class="n">D2BB</span><span class="p">,</span> <span class="n">D2NN</span><span class="p">,</span> <span class="n">D3BN</span><span class="p">,</span> <span class="n">D3NB</span><span class="p">,</span> <span class="n">D4BN</span><span class="p">,</span> <span class="n">D4NB</span> <span class="o">=</span> <span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">D01BN</span><span class="p">,</span> <span class="n">D01NB</span><span class="p">,</span> <span class="n">D02BB</span><span class="p">,</span> <span class="n">D02NN</span><span class="p">,</span> <span class="n">D03BN</span><span class="p">,</span> <span class="n">D03NB</span><span class="p">,</span> <span class="n">D04BN</span><span class="p">,</span> <span class="n">D04NB</span><span class="o">=</span> <span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="p">):</span>
                    <span class="n">D1BN</span> <span class="o">+=</span> <span class="n">D_1l_BN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D01BN</span> <span class="o">+=</span> <span class="n">Phi_1l__BN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="p">):</span>
                    <span class="n">D1NB</span> <span class="o">+=</span> <span class="n">D_1l_NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D01NB</span> <span class="o">+=</span> <span class="n">Phi_1l__NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                 
                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">D2BB</span> <span class="o">+=</span> <span class="n">D_2l_BB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D02BB</span> <span class="o">+=</span> <span class="n">Phi_2l__BB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">D2NN</span> <span class="o">+=</span> <span class="n">D_2l_NN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D02NN</span> <span class="o">+=</span> <span class="n">Phi_2l__NN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="p">):</span>
                    <span class="n">D3BN</span> <span class="o">+=</span> <span class="n">D_3l_BN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D03BN</span> <span class="o">+=</span> <span class="n">Phi_3l__BN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="p">):</span>
                    <span class="n">D3NB</span> <span class="o">+=</span> <span class="n">D_3l_NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D03NB</span> <span class="o">+=</span> <span class="n">Phi_3l__NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    
                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
                    <span class="n">D4BN</span> <span class="o">+=</span> <span class="n">D_4l_BN</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D04BN</span> <span class="o">+=</span> <span class="n">Phi_4l__NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">distancia</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)):</span>
                    <span class="n">D4NB</span> <span class="o">+=</span> <span class="n">D_4l_NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">D04NB</span> <span class="o">+=</span> <span class="n">Phi_4l__NB</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>


<span class="c1"># La contribució a la matriu dinàmica dels àtoms situats en la cel·la 0 l&#39;obtenim de la condició d&#39;estabilitat</span>

<span class="n">D2BB3ers</span><span class="o">=</span><span class="n">D2BB</span><span class="o">-</span><span class="n">D01BN</span><span class="o">-</span><span class="n">D02BB</span><span class="o">-</span><span class="n">D03BN</span>
<span class="n">D2NN3ers</span><span class="o">=</span><span class="n">D2NN</span><span class="o">-</span><span class="n">D01NB</span><span class="o">-</span><span class="n">D02NN</span><span class="o">-</span><span class="n">D03NB</span>

<span class="n">D2BB4ts</span><span class="o">=</span><span class="n">D2BB</span><span class="o">-</span><span class="n">D01BN</span><span class="o">-</span><span class="n">D02BB</span><span class="o">-</span><span class="n">D03BN</span><span class="o">-</span><span class="n">D04BN</span>
<span class="n">D2NN4ts</span><span class="o">=</span><span class="n">D2NN</span><span class="o">-</span><span class="n">D01NB</span><span class="o">-</span><span class="n">D02NN</span><span class="o">-</span><span class="n">D03NB</span><span class="o">-</span><span class="n">D04NB</span>

<span class="c1"># Definim les variables que fan referencia a les freqüencies </span>
<span class="n">omegaGammaZA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaZA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{ZA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaGammaTA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaTA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{TA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaGammaLA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaLA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{LA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaGammaZO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaZO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{ZO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaGammaTO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaTO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{TO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaGammaLO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaGammaLO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(</span><span class="se">\\</span><span class="s1">Gamma)_</span><span class="si">{LO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="n">omegaMZA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMZA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{ZA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaMTA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMTA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{TA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaMLA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMLA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{LA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaMZO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMZO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{ZO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaMTO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMTO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{TO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaMLO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaMLO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(M)_</span><span class="si">{LO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="n">omegaKZA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKZA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{ZA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaKTA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKTA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{TA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaKLA</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKLA&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{LA}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaKZO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKZO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{ZO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaKTO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKTO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{TO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">omegaKLO</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;omegaKLO&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">omega(K)_</span><span class="si">{LO}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Tenim per tant que la matriu dinàmica serà una matriu <span class="math notranslate nohighlight">\(6x6\)</span> hermítica. Però donat que les components en <span class="math notranslate nohighlight">\(z\)</span> d’esta matriu es troben desacoblades podem tractar aquestes vibracions de manera independent.</p>
</div>
<div class="section" id="vibracions-fora-de-pla">
<h2>Vibracions fora de pla<a class="headerlink" href="#vibracions-fora-de-pla" title="Link permanent a aquest títol">¶</a></h2>
<p>Donat que les vibracions fora de pla són, per com hem construït la matriu dinàmica, independients de les interplanars, procedim a estudiar-les, de manera que treballarem primer amb una matriu <span class="math notranslate nohighlight">\(2\times 2\)</span>, en compte de directament amb una matriu <span class="math notranslate nohighlight">\(6\times 6\)</span> (i quan estudiem les vibracions dins del pla treballarem amb una matriu <span class="math notranslate nohighlight">\(4\times 4\)</span></p>
<div class="cell tag_hide-input tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D1BN_zz</span><span class="o">=</span><span class="n">D1BN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D1NB_zz</span><span class="o">=</span><span class="n">D1NB</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">D2BB3ers_zz</span><span class="o">=</span><span class="n">D2BB3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D2NN3ers_zz</span><span class="o">=</span><span class="n">D2NN3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">D2BB4ts_zz</span><span class="o">=</span><span class="n">D2BB4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D2NN4ts_zz</span><span class="o">=</span><span class="n">D2NN4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">D3BN_zz</span><span class="o">=</span><span class="n">D3BN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D3NB_zz</span><span class="o">=</span><span class="n">D3NB</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D4BN_zz</span><span class="o">=</span><span class="n">D4BN</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">D4NB_zz</span><span class="o">=</span><span class="n">D4NB</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">D_zz3ers</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">D2BB3ers_zz</span><span class="p">,</span><span class="n">D1BN_zz</span><span class="o">+</span><span class="n">D3BN_zz</span><span class="p">],</span>        <span class="p">[</span><span class="n">D1NB_zz</span><span class="o">+</span><span class="n">D3NB_zz</span><span class="p">,</span><span class="n">D2NN3ers_zz</span><span class="p">]])</span>

<span class="n">D_zz4ts</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">D2BB4ts_zz</span><span class="p">,</span><span class="n">D1BN_zz</span><span class="o">+</span><span class="n">D3BN_zz</span><span class="o">+</span><span class="n">D4BN_zz</span><span class="p">],</span> <span class="p">[</span><span class="n">D1NB_zz</span><span class="o">+</span><span class="n">D3NB_zz</span><span class="o">+</span><span class="n">D4BN_zz</span><span class="p">,</span><span class="n">D2NN4ts_zz</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="primer-considerem-fins-3ers-veins">
<h3>Primer considerem fins 3ers veïns<a class="headerlink" href="#primer-considerem-fins-3ers-veins" title="Link permanent a aquest títol">¶</a></h3>
<div class="section" id="punt-gamma">
<h4>Punt <span class="math notranslate nohighlight">\(\Gamma\)</span><a class="headerlink" href="#punt-gamma" title="Link permanent a aquest títol">¶</a></h4>
<p>Per al punt <span class="math notranslate nohighlight">\((q_x=0, q_y=0)\)</span>, la matriu que tenim és:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_Gamma_ZO</span><span class="o">=</span><span class="mi">832</span> <span class="c1">#cm-1</span>
<span class="n">omega_Gamma_ZA</span><span class="o">=</span><span class="mi">0</span>
<span class="n">D_Gamma3ers_zz</span><span class="o">=</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#,(M_B,B.mass*u),(M_N,N.mass*u)])</span>
<span class="n">show</span><span class="p">(</span><span class="n">D_Gamma3ers_zz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rr}
-\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & \frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} \\
\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & -\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}}
\end{array}\right)</script></html></div></div>
</div>
<p>amb autovalors:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D_Gamma3ers_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[-\frac{6 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}}, 0\right]</script></html></div></div>
</div>
<p>De manera que al punt <span class="math notranslate nohighlight">\(\Gamma\)</span> trobem que s’ha de complir l’equació:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">=</span><span class="p">(</span><span class="n">D_Gamma3ers_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaGammaZO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_Gamma_ZO3ers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{6 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} = {\omega(\Gamma)_{ZO}}^{2}</script></html></div></div>
</div>
</div>
<div class="section" id="punt-m">
<h4>Punt <span class="math notranslate nohighlight">\(M\)</span><a class="headerlink" href="#punt-m" title="Link permanent a aquest títol">¶</a></h4>
<p>Al punt <span class="math notranslate nohighlight">\(M\)</span> <span class="math notranslate nohighlight">\(\left(q_x=\frac{\pi}{a},q_y=\frac{\pi}{\sqrt 3 a}\right)\)</span> la matriu dinàmica i  els valors propis són:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_M_ZO</span><span class="o">=</span><span class="mi">638</span> <span class="c1">#cm-1</span>
<span class="n">omega_M_ZA</span><span class="o">=</span><span class="mi">315</span>

<span class="n">D_M3ers_zz</span><span class="o">=</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>

<span class="c1"># Podem simplificar un poc l&#39;expressió obtessa per als valors propis al punt $M$ </span>
<span class="c1">#(simplement reescribint l&#39;argument de l&#39;arrel quadrada)</span>

<span class="n">omegaM1quadrat3ers</span><span class="o">=-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">/</span><span class="n">M_B</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toNN</span><span class="o">/</span><span class="n">M_N</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">+</span><span class="n">phi3toBN</span><span class="p">)</span>\
   <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">-</span><span class="n">M_B</span><span class="o">*</span><span class="n">phi2toNN</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">D_M3ers_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaM1quadrat3ers</span><span class="p">):</span>
    <span class="n">Eq_M_ZA3ers</span><span class="o">=</span><span class="p">(</span><span class="n">omegaM1quadrat3ers</span><span class="o">==</span><span class="n">omegaMZA</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>



<span class="n">omegaM2quadrat3ers</span><span class="o">=-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">/</span><span class="n">M_B</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toNN</span><span class="o">/</span><span class="n">M_N</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">+</span><span class="n">phi3toBN</span><span class="p">)</span>\
   <span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">-</span><span class="n">M_B</span><span class="o">*</span><span class="n">phi2toNN</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">D_M3ers_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">omegaM2quadrat3ers</span><span class="p">):</span>
    <span class="n">Eq_M_ZO3ers</span><span class="o">=</span><span class="p">(</span><span class="n">omegaM2quadrat3ers</span><span class="o">==</span><span class="n">omegaMZO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">Eq_M_ZOmesZA3ers</span><span class="o">=</span><span class="p">(</span><span class="n">Eq_M_ZO3ers</span><span class="o">+</span><span class="n">Eq_M_ZA3ers</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phi3toBN</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">Eq_M_ZOmenysZA3ers_quadrat</span><span class="o">=</span><span class="p">((</span><span class="n">Eq_M_ZO3ers</span><span class="o">-</span><span class="n">Eq_M_ZA3ers</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phi3toBN</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">show</span><span class="p">(</span><span class="n">D_M3ers_zz</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_ZA3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_ZO3ers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rr}
-\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{8 \, {\phi_{2,to}^{BB}}}{M_{B}} & \frac{{\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} \\
\frac{{\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & -\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{8 \, {\phi_{2,to}^{NN}}}{M_{N}}
\end{array}\right)</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} - \frac{4 \, {\phi_{2,to}^{BB}}}{M_{B}} - \frac{4 \, {\phi_{2,to}^{NN}}}{M_{N}} - \frac{\sqrt{M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}}\right)}^{2} + 16 \, {\left(M_{N} {\phi_{2,to}^{BB}} - M_{B} {\phi_{2,to}^{NN}}\right)}^{2}}}{M_{B} M_{N}} = {\omega(M)_{ZA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} - \frac{4 \, {\phi_{2,to}^{BB}}}{M_{B}} - \frac{4 \, {\phi_{2,to}^{NN}}}{M_{N}} + \frac{\sqrt{M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}}\right)}^{2} + 16 \, {\left(M_{N} {\phi_{2,to}^{BB}} - M_{B} {\phi_{2,to}^{NN}}\right)}^{2}}}{M_{B} M_{N}} = {\omega(M)_{ZO}}^{2}</script></html></div></div>
</div>
<p>Notem que el segon valor propi és major que el primer (l’arrel quadrada és possitiva) i per tant correspon a la rama <span class="math notranslate nohighlight">\(ZO\)</span>, i el primer a <span class="math notranslate nohighlight">\(ZA\)</span>.
Podem comprobar que si considerem que els àtoms foren del mateix tipus obtenim exactament les mateixes expresions que en <span id="id1">[<a class="reference internal" href="zbibliografia.html#id5">Fal08</a>]</span></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">D_M3ers_zz</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_B</span><span class="o">==</span><span class="n">M_N</span><span class="p">,</span> <span class="n">phi2toNN</span><span class="o">=</span><span class="n">phi2toBB</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[-\frac{2 \, {\left({\phi_{1,to}^{BN}} + 4 \, {\phi_{2,to}^{BB}} + 3 \, {\phi_{3,to}^{BN}}\right)}}{M_{N}}, -\frac{4 \, {\left({\phi_{1,to}^{BN}} + 2 \, {\phi_{2,to}^{BB}}\right)}}{M_{N}}\right]</script></html></div></div>
</div>
</div>
<div class="section" id="punt-k">
<h4>Punt <span class="math notranslate nohighlight">\(K\)</span><a class="headerlink" href="#punt-k" title="Link permanent a aquest títol">¶</a></h4>
<p>Per al punt (<span class="math notranslate nohighlight">\(q_x=\frac{4\pi}{3 a}\)</span>, <span class="math notranslate nohighlight">\(q_y=0\)</span>) la matriu dinàmica i esl autovalors són:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_K_ZO</span><span class="o">=</span><span class="mi">602</span> <span class="c1">#cm-1</span>
<span class="n">omega_K_ZA</span><span class="o">=</span><span class="mi">320</span>
<span class="n">D_K_zz3ers</span><span class="o">=</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Eq_K_ZA3ers</span><span class="o">=</span><span class="p">(</span><span class="n">omegaKZA</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="n">D_K_zz3ers</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phi3toBN</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>

<span class="n">Eq_K_ZO3ers</span><span class="o">=</span><span class="p">(</span><span class="n">omegaKZO</span><span class="o">**</span><span class="mi">2</span><span class="o">==</span><span class="n">D_K_zz3ers</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phi3toBN</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>

<span class="n">show</span><span class="p">(</span><span class="n">D_K_zz3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_K_ZA3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_K_ZO3ers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rr}
-\frac{3 \, {\phi_{2,to}^{BB}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, M_{B}} - \frac{3 \, {\phi_{2,to}^{BB}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, M_{B}} - \frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{6 \, {\phi_{2,to}^{BB}}}{M_{B}} & -\frac{{\phi_{1,to}^{BN}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{3,to}^{BN}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{1,to}^{BN}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{3,to}^{BN}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} + \frac{{\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{{\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} \\
-\frac{{\phi_{1,to}^{BN}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{3,to}^{BN}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{1,to}^{BN}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} - \frac{{\phi_{3,to}^{BN}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, \sqrt{M_{B} M_{N}}} + \frac{{\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{{\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & -\frac{3 \, {\phi_{2,to}^{NN}} {\left(i \, \sqrt{3} + 1\right)}}{2 \, M_{N}} - \frac{3 \, {\phi_{2,to}^{NN}} {\left(-i \, \sqrt{3} + 1\right)}}{2 \, M_{N}} - \frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{6 \, {\phi_{2,to}^{NN}}}{M_{N}}
\end{array}\right)</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\omega(K)_{ZA}}^{2} = \frac{1}{2} \, {\omega(\Gamma)_{ZO}}^{2} - \frac{9 \, {\phi_{2,to}^{NN}}}{M_{N}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\omega(K)_{ZO}}^{2} = \frac{1}{2} \, {\omega(\Gamma)_{ZO}}^{2} - \frac{9 \, {\phi_{2,to}^{BB}}}{M_{B}}</script></html></div></div>
</div>
<p>Observerm també que les equacions per als modes al punt <span class="math notranslate nohighlight">\(K\)</span> són formalment idèntiques a les que trobem en <span id="id2">[<a class="reference internal" href="zbibliografia.html#id5">Fal08</a>]</span> per al grafé, sols que en aquest cas, com estem tractant amb una base amb dos àtoms des distint tipus no tenim degeneració en este punt (el segon terme d’ambdues equacions es diferent en este cas).
Tenim que tindre en compte que en no sabem, a priori, a quina rama correspon cada valor propi, segons l’elecció que realitzem obtindrem els valors de les constants <span class="math notranslate nohighlight">\(\phi_{2,to}^{NN}\)</span> i <span class="math notranslate nohighlight">\(\phi_{2,to}^{BB}\)</span> intercambiades.</p>
</div>
<div class="section" id="constants-de-forca">
<h4>Constants de força<a class="headerlink" href="#constants-de-forca" title="Link permanent a aquest títol">¶</a></h4>
<p><b>Passem a resoldre el sistema d’equacions que hem obtés per obtindre les constants de força</b>:</p>
Tenim més equacions que incògnites, i segons les ecuacions escollides obtenim valors diferents. El sistema d’equacions que obtenim el podem resoldre, en este cas, tant analítica com numèricament.</p></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valors_numerics_emprats</span><span class="o">=</span><span class="p">[</span><span class="n">omegaGammaZO</span><span class="o">==</span><span class="n">omega_Gamma_ZO</span><span class="p">,</span><span class="n">omegaMZO</span><span class="o">==</span><span class="n">omega_M_ZO</span><span class="p">,</span><span class="n">omegaMZA</span><span class="o">==</span><span class="n">omega_M_ZA</span><span class="p">,</span>\
                         <span class="n">omegaKZO</span><span class="o">==</span><span class="n">omega_K_ZO</span><span class="p">,</span> <span class="n">omegaKZA</span><span class="o">==</span><span class="n">omega_K_ZA</span><span class="p">,</span> <span class="n">M_B</span><span class="o">==</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">==</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Per exemple, una solució analítica que trobem és:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solucions_perp3ers</span><span class="o">=</span> <span class="n">solve</span><span class="p">([</span><span class="n">Eq_Gamma_ZO3ers</span><span class="p">,</span><span class="n">Eq_M_ZOmenysZA3ers_quadrat</span><span class="p">,</span><span class="n">Eq_K_ZO3ers</span><span class="p">,</span><span class="n">Eq_K_ZA3ers</span><span class="p">],</span>\
                          <span class="n">phi1toBN</span><span class="p">,</span><span class="n">phi2toBB</span><span class="p">,</span><span class="n">phi2toNN</span><span class="p">,</span><span class="n">phi3toBN</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sympy&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">solucions_perp3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">show</span><span class="p">(</span><span class="n">solucions_perp3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left\{{\phi_{1,to}^{BN}} : -\frac{1}{8} \, \sqrt{M_{B} M_{N}} {\omega(\Gamma)_{ZO}}^{2} - \frac{1}{72} \, \sqrt{-{\left(64 \, {\omega(K)_{ZA}}^{4} - 128 \, {\omega(K)_{ZA}}^{2} {\omega(K)_{ZO}}^{2} + 64 \, {\omega(K)_{ZO}}^{4} - 81 \, {\omega(M)_{ZA}}^{4} + 162 \, {\omega(M)_{ZA}}^{2} {\omega(M)_{ZO}}^{2} - 81 \, {\omega(M)_{ZO}}^{4}\right)} M_{B} M_{N}}, {\phi_{2,to}^{BB}} : \frac{1}{18} \, {\left({\omega(\Gamma)_{ZO}}^{2} - 2 \, {\omega(K)_{ZO}}^{2}\right)} M_{B}, {\phi_{2,to}^{NN}} : \frac{1}{18} \, {\left({\omega(\Gamma)_{ZO}}^{2} - 2 \, {\omega(K)_{ZA}}^{2}\right)} M_{N}, {\phi_{3,to}^{BN}} : -\frac{1}{24} \, \sqrt{M_{B} M_{N}} {\omega(\Gamma)_{ZO}}^{2} + \frac{1}{72} \, \sqrt{-{\left(64 \, {\omega(K)_{ZA}}^{4} - 128 \, {\omega(K)_{ZA}}^{2} {\omega(K)_{ZO}}^{2} + 64 \, {\omega(K)_{ZO}}^{4} - 81 \, {\omega(M)_{ZA}}^{4} + 162 \, {\omega(M)_{ZA}}^{2} {\omega(M)_{ZO}}^{2} - 81 \, {\omega(M)_{ZO}}^{4}\right)} M_{B} M_{N}}\right\}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left\{{\phi_{1,to}^{BN}} : -\frac{1}{8} \, \sqrt{M_{B} M_{N}} {\omega(\Gamma)_{ZO}}^{2} + \frac{1}{72} \, \sqrt{-{\left(64 \, {\omega(K)_{ZA}}^{4} - 128 \, {\omega(K)_{ZA}}^{2} {\omega(K)_{ZO}}^{2} + 64 \, {\omega(K)_{ZO}}^{4} - 81 \, {\omega(M)_{ZA}}^{4} + 162 \, {\omega(M)_{ZA}}^{2} {\omega(M)_{ZO}}^{2} - 81 \, {\omega(M)_{ZO}}^{4}\right)} M_{B} M_{N}}, {\phi_{2,to}^{BB}} : \frac{1}{18} \, {\left({\omega(\Gamma)_{ZO}}^{2} - 2 \, {\omega(K)_{ZO}}^{2}\right)} M_{B}, {\phi_{2,to}^{NN}} : \frac{1}{18} \, {\left({\omega(\Gamma)_{ZO}}^{2} - 2 \, {\omega(K)_{ZA}}^{2}\right)} M_{N}, {\phi_{3,to}^{BN}} : -\frac{1}{24} \, \sqrt{M_{B} M_{N}} {\omega(\Gamma)_{ZO}}^{2} - \frac{1}{72} \, \sqrt{-{\left(64 \, {\omega(K)_{ZA}}^{4} - 128 \, {\omega(K)_{ZA}}^{2} {\omega(K)_{ZO}}^{2} + 64 \, {\omega(K)_{ZO}}^{4} - 81 \, {\omega(M)_{ZA}}^{4} + 162 \, {\omega(M)_{ZA}}^{2} {\omega(M)_{ZO}}^{2} - 81 \, {\omega(M)_{ZO}}^{4}\right)} M_{B} M_{N}}\right\}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">solucions_perp3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[\left({\phi_{1,to}^{BN}}, \verb|=|, -1377518\right), \left({\phi_{2,to}^{BB}}, \verb|=|, -19570\right), \left({\phi_{2,to}^{NN}}, \verb|=|, 379289\right), \left({\phi_{3,to}^{BN}}, \verb|=|, -42181\right)\right]</script></html></div></div>
</div>
<p>Notem que en este cas hem emprat obtenim dues solucions diferent perque hem emprat una equació amb variables al quadrat, i la solució mostrada es la que millor s’ajusta a les dades proporcionades de les dos.<p>
Si escollim un altre conjunt d’equacions (sols canviem una):</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solucions_perp3ers</span><span class="o">=</span> <span class="n">solve</span><span class="p">([</span><span class="n">Eq_Gamma_ZO3ers</span><span class="p">,</span><span class="n">Eq_M_ZA3ers</span><span class="p">,</span><span class="n">Eq_K_ZO3ers</span><span class="p">,</span><span class="n">Eq_K_ZA3ers</span><span class="p">],</span>\
                          <span class="n">phi1toBN</span><span class="p">,</span><span class="n">phi2toBB</span><span class="p">,</span><span class="n">phi2toNN</span><span class="p">,</span><span class="n">phi3toBN</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sympy&quot;</span><span class="p">)</span>

<span class="n">show</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">solucions_perp3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[\left({\phi_{1,to}^{BN}}, \verb|=|, -791210\right), \left({\phi_{2,to}^{BB}}, \verb|=|, -19570\right), \left({\phi_{2,to}^{NN}}, \verb|=|, 379289\right), \left({\phi_{3,to}^{BN}}, \verb|=|, -628489\right)\right]</script></html></div></div>
</div>
<p>Les solucions anteriors les hem obtés resolguent algebraicament el sistema d’equacions. Ara el resoldrem numèricament (podríem fer ús de les funcions disponibles en <em>scipy.optimize</em>, per exemple, però sagemath ens proporciona la funció minimize directament).
El que faig es construir un vector les components del qual són les equacions que volem resoldre y minimitzar la norma d’este vector:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Equacions3ers</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_M_ZA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)]</span>

<span class="n">solucions3ers</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacions3ers</span><span class="p">))),[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>

<span class="n">Solucions3ers</span><span class="o">=</span><span class="p">[</span><span class="n">phi1toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">phi2toBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
               <span class="n">phi2toNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">phi3toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
<span class="n">show</span><span class="p">(</span><span class="n">Solucions3ers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[{\phi_{1,to}^{BN}} = \left(-791210\right), {\phi_{2,to}^{BB}} = \left(-19570\right), {\phi_{2,to}^{NN}} = 379289, {\phi_{3,to}^{BN}} = \left(-628489\right)\right]</script></html></div></div>
</div>
<p>Podem comprobar que obtenim la mateixa solució que si resolguem analíticament.
Així mateix, si emprem un altre sistema d’equacions les solucions són diferents:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Equacions3ers</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_M_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)]</span>

<span class="n">solucions3ers2</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacions3ers</span><span class="p">))),[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>

<span class="n">Solucions3ers2</span><span class="o">=</span><span class="p">[</span><span class="n">phi1toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">phi2toBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">phi2toNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers2</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">phi3toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers2</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
<span class="n">Solucions3ers2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[{\phi_{1,to}^{BN}} = \left(-715459\right), {\phi_{2,to}^{BB}} = \left(-19570\right), {\phi_{2,to}^{NN}} = 379289, {\phi_{3,to}^{BN}} = \left(-704240\right)\right]</script></html></div></div>
</div>
<p>Realitzant diferents gràfiques escollim la que millor ajusta al conjunt de dades experimentals:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Equacions3ers</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">Eq_Gamma_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_M_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_M_ZA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
               <span class="n">Eq_K_ZA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)]</span>

<span class="n">solucions3ers</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacions3ers</span><span class="p">))),[</span><span class="o">-</span><span class="mf">1400000.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span> <span class="c1">#[-1490000.,1.,1.,1.])</span>

<span class="n">Solucions3ers</span><span class="o">=</span><span class="p">[</span><span class="n">phi1toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">phi2toBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">phi2toNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">phi3toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
<span class="n">Solucions3ers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[{\phi_{1,to}^{BN}} = \left(-1379144\right), {\phi_{2,to}^{BB}} = \left(-24085\right), {\phi_{2,to}^{NN}} = 373439, {\phi_{3,to}^{BN}} = \left(-42723\right)\right]</script></html></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En compte calcular els valors i vectors propis analíticament, ara que tenim tots els valors numérics  per construir la matriu de dispersió en cada punt, és molt més eficient convertir les matrius de sagemath en arrays de numpy, executant el mètode numpy sobre l’array en qüestió</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dades</span><span class="o">=</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;../Dades/freq.dat&quot;</span><span class="p">)</span>
<span class="c1">#data = pd.read_csv(&#39;../../Dades/freq.dat&#39;, header = None)</span>
<span class="c1">#show(pd.DataFrame(dades))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Freqüències de Gamma a M (i les guardem com un dataframe). Calculem 200 punts en este interval</span>
<span class="n">freq_perp_planol_Gamma_a_M3ers</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">q_y</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_Gamma_a_M3ers</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_Gamma_a_M3ers</span><span class="p">)</span>

<span class="c1">#Freqüències de M a K (i les guardem com un dataframe). Calculem 100 punts en este interval</span>
<span class="n">freq_perp_planol_M_a_K3ers</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_M_a_K3ers</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_M_a_K3ers</span><span class="p">)</span>

<span class="c1">#Freqüències de K a Gamma (i les guardem com un dataframe). Calculem 124 punts en este interval</span>
<span class="n">freq_perp_planol_K_a_Gamma3ers</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_K_a_Gamma3ers</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_K_a_Gamma3ers</span><span class="p">)</span>

<span class="n">DF_freq_calculades_perp_planol3ers</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>\
        <span class="n">DF_freq_perp_planol_Gamma_a_M3ers</span><span class="p">,</span><span class="n">DF_freq_perp_planol_M_a_K3ers</span><span class="p">,</span>\
        <span class="n">DF_freq_perp_planol_K_a_Gamma3ers</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">DF_freq_calculades_perp_planol3ers</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;freq_calculades_perp_planol3ers.dat&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dades_calculades_perp_planol3ers</span><span class="o">=</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;freq_calculades_perp_planol3ers.dat&quot;</span><span class="p">)</span>
<span class="n">dispersioZ3ers</span><span class="o">=</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">524</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">dispersioZ3ers</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_57_0.png" src="_images/formulacio_matriu_dinamica_57_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save</span><span class="p">(</span><span class="n">dispersioZ3ers</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/DisZ3ers.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="fins-4ts-veins">
<h3>Fins 4ts veïns<a class="headerlink" href="#fins-4ts-veins" title="Link permanent a aquest títol">¶</a></h3>
<p>Si considerem fins als quarts veïns, també obtenim expresions analítiques per als valors propis de la matriu dinàmica als punts (de màxima simetria) considerats. Però en este cas no obtenim una solució analítica per al sistema d’equacions (sí trobem fàcilment solucions numéricament)</p>
<div class="section" id="id3">
<h4>Punt <span class="math notranslate nohighlight">\(\Gamma\)</span><a class="headerlink" href="#id3" title="Link permanent a aquest títol">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D_Gamma4ts_zz</span><span class="o">=</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#,(M_B,B.mass*u),(M_N,N.mass*u)])</span>
<span class="n">D_Gamma4ts_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="n">Eq_Gamma_ZO4ts</span><span class="o">=</span><span class="p">(</span><span class="n">D_Gamma4ts_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaGammaZO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">D_Gamma4ts_zz</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_Gamma_ZO4ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rr}
-\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & \frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B} M_{N}}} \\
\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} + \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B} M_{N}}} & -\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B} M_{N}}} - \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B} M_{N}}}
\end{array}\right)</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{6 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}} + 2 \, {\phi_{4,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} = {\omega(\Gamma)_{ZO}}^{2}</script></html></div></div>
</div>
</div>
<div class="section" id="id4">
<h4>Punt <span class="math notranslate nohighlight">\(M\)</span><a class="headerlink" href="#id4" title="Link permanent a aquest títol">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D_M4ts_zz</span><span class="o">=</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>

<span class="c1"># Podem simplificar un poc l&#39;expressió obtessa per als valores propios al punto $M$ </span>
<span class="c1">#(simplement reescribint l&#39;argument de l&#39;arrel quadrada)</span>

<span class="n">assume</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">-</span><span class="n">M_B</span><span class="o">*</span><span class="n">phi2toNN</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span>\
         <span class="mi">4</span><span class="o">*</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="o">+</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">*</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>

<span class="n">omegaM1quadrat4ts</span><span class="o">=-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">/</span><span class="n">M_B</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toNN</span><span class="o">/</span><span class="n">M_N</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">+</span><span class="n">phi3toBN</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">phi4toBN</span><span class="p">)</span>\
   <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">-</span><span class="n">M_B</span><span class="o">*</span><span class="n">phi2toNN</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span>\
         <span class="mi">4</span><span class="o">*</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="o">+</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">*</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">D_M4ts_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaM1quadrat4ts</span><span class="p">):</span>
    <span class="n">Eq_M_ZA4ts</span><span class="o">=</span><span class="p">(</span><span class="n">omegaM1quadrat4ts</span><span class="o">==</span><span class="n">omegaMZA</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>



<span class="n">omegaM2quadrat4ts</span><span class="o">=-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">/</span><span class="n">M_B</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi2toNN</span><span class="o">/</span><span class="n">M_N</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">+</span><span class="n">phi3toBN</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">phi4toBN</span><span class="p">)</span>\
   <span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">phi2toBB</span><span class="o">-</span><span class="n">M_B</span><span class="o">*</span><span class="n">phi2toNN</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span>\
         <span class="mi">4</span><span class="o">*</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="o">*</span><span class="p">(</span><span class="n">phi1toBN</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">phi3toBN</span><span class="o">+</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">*</span><span class="n">phi4toBN</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M_B</span><span class="o">*</span><span class="n">M_N</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">D_M4ts_zz</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">omegaM2quadrat4ts</span><span class="p">):</span>
    <span class="n">Eq_M_ZO4ts</span><span class="o">=</span><span class="p">(</span><span class="n">omegaM2quadrat4ts</span><span class="o">==</span><span class="n">omegaMZO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_ZA4ts</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_ZO4ts</span><span class="p">)</span>

<span class="c1">#Eq_M_ZOmesZA4ts=(Eq_M_ZO4ts+Eq_M_ZA4ts).subs(Eq_Gamma_ZO4ts.solve(phi4toBN)[0]).expand()</span>
<span class="c1">#show(Eq_M_ZOmesZA4ts)</span>
<span class="c1">#Eq_M_ZOmenysZA4ts_quadrat=((Eq_M_ZO4ts-Eq_M_ZA4ts)**2).subs(Eq_Gamma_ZO4ts.solve(phi4toBN)[0]).expand()</span>
<span class="c1">#show(Eq_M_ZOmenysZA4ts_quadrat)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}} + 2 \, {\phi_{4,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} - \frac{4 \, {\phi_{2,to}^{BB}}}{M_{B}} - \frac{4 \, {\phi_{2,to}^{NN}}}{M_{N}} - \frac{\sqrt{M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}}\right)}^{2} + 4 \, M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}} + {\phi_{4,to}^{BN}}\right)} {\phi_{4,to}^{BN}} + 16 \, {\left(M_{N} {\phi_{2,to}^{BB}} - M_{B} {\phi_{2,to}^{NN}}\right)}^{2}}}{M_{B} M_{N}} = {\omega(M)_{ZA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\left({\phi_{1,to}^{BN}} + {\phi_{3,to}^{BN}} + 2 \, {\phi_{4,to}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} - \frac{4 \, {\phi_{2,to}^{BB}}}{M_{B}} - \frac{4 \, {\phi_{2,to}^{NN}}}{M_{N}} + \frac{\sqrt{M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}}\right)}^{2} + 4 \, M_{B} M_{N} {\left({\phi_{1,to}^{BN}} - 3 \, {\phi_{3,to}^{BN}} + {\phi_{4,to}^{BN}}\right)} {\phi_{4,to}^{BN}} + 16 \, {\left(M_{N} {\phi_{2,to}^{BB}} - M_{B} {\phi_{2,to}^{NN}}\right)}^{2}}}{M_{B} M_{N}} = {\omega(M)_{ZO}}^{2}</script></html></div></div>
</div>
</div>
<div class="section" id="id5">
<h4>Punt <span class="math notranslate nohighlight">\(K\)</span><a class="headerlink" href="#id5" title="Link permanent a aquest títol">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_K_ZO</span><span class="o">=</span><span class="mi">602</span> <span class="c1">#cm-1</span>
<span class="n">omega_K_ZA</span><span class="o">=</span><span class="mi">320</span>
<span class="n">D_K_zz4ts</span><span class="o">=</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Eq_K_ZA4ts</span><span class="o">=</span><span class="p">(</span><span class="n">D_K_zz4ts</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaKZA</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="c1">#.subs(Eq_Gamma_ZO4ts.solve(phi4toBN)[0]).expand()</span>
<span class="n">Eq_K_ZO4ts</span><span class="o">=</span><span class="p">(</span><span class="n">D_K_zz4ts</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">omegaKZO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="c1">#.subs(Eq_Gamma_ZO4ts.solve(phi4toBN)[0]).expand()</span>

<span class="c1">#Eq_K_ZOmesZA3ers=Eq_K_ZA3ers+Eq_K_ZO3ers</span>

<span class="c1">#Eq_K_ZOmenysZA3ers=Eq_K_ZA3ers-Eq_K_ZO3ers</span>

<span class="n">show</span><span class="p">(</span><span class="n">Eq_K_ZA4ts</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_K_ZO4ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,to}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{ZA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,to}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{3,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{6 \, {\phi_{4,to}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{ZO}}^{2}</script></html></div></div>
</div>
</div>
<div class="section" id="id6">
<h4>Constants de força<a class="headerlink" href="#id6" title="Link permanent a aquest títol">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Equacions4ts</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_Gamma_ZO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
              <span class="n">Eq_M_ZO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
              <span class="n">Eq_M_ZA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
              <span class="n">Eq_K_ZO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">),</span>\
              <span class="n">Eq_K_ZA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_emprats</span><span class="p">)]</span>
<span class="n">solucions4ts</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacions4ts</span><span class="p">))),[</span><span class="o">-</span><span class="mf">1485000.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
<span class="n">Solucions4ts</span><span class="o">=</span><span class="p">[</span><span class="n">phi1toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions4ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">phi2toBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions4ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
              <span class="n">phi2toNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">phi3toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions4ts</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>\
              <span class="n">phi4toBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucions4ts</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span>
<span class="n">show</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[{\phi_{1,to}^{BN}} = \left(-1463658\right), {\phi_{2,to}^{BB}} = \left(-24083\right), {\phi_{2,to}^{NN}} = 373442, {\phi_{3,to}^{BN}} = \left(-42438\right), {\phi_{4,to}^{BN}} = 42685\right]</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Freqüències de Gamma a M (i les guardem com un dataframe). Calculem 200 punts en este interval</span>
<span class="n">freq_perp_planol_Gamma_a_M</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">q_y</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_Gamma_a_M</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_Gamma_a_M</span><span class="p">)</span>

<span class="c1">#Freqüències de M a K (i les guardem com un dataframe). Calculem 100 punts en este interval</span>
<span class="n">freq_perp_planol_M_a_K</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_M_a_K</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_M_a_K</span><span class="p">)</span>

<span class="c1">#Freqüències de K a Gamma (i les guardem com un dataframe). Calculem 124 punts en este interval</span>
<span class="n">freq_perp_planol_K_a_Gamma</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_zz4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">)]))))</span>

<span class="n">DF_freq_perp_planol_K_a_Gamma</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_perp_planol_K_a_Gamma</span><span class="p">)</span>

<span class="n">DF_freq_calculades_perp_planol</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">DF_freq_perp_planol_Gamma_a_M</span><span class="p">,</span><span class="n">DF_freq_perp_planol_M_a_K</span><span class="p">,</span>\
                                    <span class="n">DF_freq_perp_planol_K_a_Gamma</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">DF_freq_calculades_perp_planol</span>
<span class="n">DF_freq_calculades_perp_planol</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;freq_calculades_perp_planol4ts.dat&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dades_calculades_perp_planol</span><span class="o">=</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;freq_calculades_perp_planol4ts.dat&quot;</span><span class="p">)</span>
<span class="n">dispersioZ4ts</span><span class="o">=</span><span class="p">(</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">524</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">))</span>

<span class="n">show</span><span class="p">(</span><span class="n">dispersioZ4ts</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_69_0.png" src="_images/formulacio_matriu_dinamica_69_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save</span><span class="p">(</span><span class="n">dispersioZ4ts</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/DisZ4ts.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="vibracions-al-pla-del-cristall">
<h2>Vibracions al pla del cristall<a class="headerlink" href="#vibracions-al-pla-del-cristall" title="Link permanent a aquest títol">¶</a></h2>
<p>Vibracions dins del pla del cristall
En este cas tractem amb una matriu <span class="math notranslate nohighlight">\(4\times 4\)</span>, i per tant tenim 4 valors propis (<span class="math notranslate nohighlight">\(\omega^2\)</span>) en cada punt (<span class="math notranslate nohighlight">\(q_x\)</span>, <span class="math notranslate nohighlight">\(q_y\)</span>), que corresponen a quatre rames.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D1BN_xy</span><span class="o">=</span><span class="n">D1BN</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D1NB_xy</span><span class="o">=</span><span class="n">D1NB</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">D2BB3ers_xy</span><span class="o">=</span><span class="n">D2BB3ers</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D2NN3ers_xy</span><span class="o">=</span><span class="n">D2NN3ers</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">D2BB4ts_xy</span><span class="o">=</span><span class="n">D2BB4ts</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D2NN4ts_xy</span><span class="o">=</span><span class="n">D2NN4ts</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>


<span class="n">D3BN_xy</span><span class="o">=</span><span class="n">D3BN</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D3NB_xy</span><span class="o">=</span><span class="n">D3NB</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D4BN_xy</span><span class="o">=</span><span class="n">D4BN</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">D4NB_xy</span><span class="o">=</span><span class="n">D4NB</span><span class="o">.</span><span class="n">matrix_from_rows_and_columns</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">D3ers_xy</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">D2BB3ers_xy</span><span class="p">,</span> <span class="n">D1BN_xy</span><span class="o">+</span><span class="n">D3BN_xy</span><span class="p">],[</span><span class="n">D1NB_xy</span><span class="o">+</span><span class="n">D3NB_xy</span><span class="p">,</span> <span class="n">D2NN3ers_xy</span><span class="p">]])</span>

<span class="n">D4ts_xy</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">D2BB4ts_xy</span><span class="p">,</span> <span class="n">D1BN_xy</span><span class="o">+</span><span class="n">D3BN_xy</span><span class="o">+</span><span class="n">D4BN_xy</span><span class="p">],[</span><span class="n">D1NB_xy</span><span class="o">+</span><span class="n">D3NB_xy</span><span class="o">+</span><span class="n">D4NB_xy</span><span class="p">,</span> <span class="n">D2NN4ts_xy</span><span class="p">]])</span>

<span class="n">D3ers</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">D2BB3ers</span><span class="p">,</span> <span class="n">D1BN</span><span class="o">+</span><span class="n">D3BN</span><span class="p">],[</span><span class="n">D1NB</span><span class="o">+</span><span class="n">D3NB</span><span class="p">,</span> <span class="n">D2NN3ers</span><span class="p">]])</span>

<span class="n">D4ts</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">D2BB4ts</span><span class="p">,</span> <span class="n">D1BN</span><span class="o">+</span><span class="n">D3BN</span><span class="o">+</span><span class="n">D4BN</span><span class="p">],[</span><span class="n">D1NB</span><span class="o">+</span><span class="n">D3NB</span><span class="o">+</span><span class="n">D4NB</span><span class="p">,</span> <span class="n">D2NN4ts</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="considerem-sols-fins-als-3ers-veins">
<h3>Considerem sols fins als 3ers veïns<a class="headerlink" href="#considerem-sols-fins-als-3ers-veins" title="Link permanent a aquest títol">¶</a></h3>
<div class="section" id="al-punt-gamma">
<h4>Al punt <span class="math notranslate nohighlight">\(\Gamma\)</span><a class="headerlink" href="#al-punt-gamma" title="Link permanent a aquest títol">¶</a></h4>
<p>Fins 3ers veïns</p>
<p>Al punt <span class="math notranslate nohighlight">\(\Gamma\)</span> obtinc 2 valors propis, de multiplicitat <span class="math notranslate nohighlight">\(2\)</span> cadascun:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_Gamma_TO</span><span class="o">=</span><span class="mi">1395</span>
<span class="n">omega_Gamma_LO</span><span class="o">=</span><span class="mi">1395</span>
<span class="n">D_Gamma3ers_xy</span><span class="o">=</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#show(D_Gamma3ers_xy)</span>
<span class="n">show</span><span class="p">([</span><span class="n">D_Gamma3ers_xy</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">D_Gamma3ers_xy</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[-\frac{3 \, {\left({\phi_{1,r}^{BN}} + {\phi_{1,ti}^{BN}} + {\phi_{3,r}^{BN}} + {\phi_{3,ti}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}}, 0\right]</script></html></div></div>
</div>
<p>De manera que obtenim la següent equació:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eq_Gamma_TO3ers</span><span class="o">=</span><span class="p">(</span><span class="n">D_Gamma3ers_xy</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaGammaTO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_Gamma_LO3ers</span><span class="o">=</span><span class="p">(</span><span class="n">D_Gamma3ers_xy</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">omegaGammaLO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_Gamma_LO3ers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\left({\phi_{1,r}^{BN}} + {\phi_{1,ti}^{BN}} + {\phi_{3,r}^{BN}} + {\phi_{3,ti}^{BN}}\right)}}{\sqrt{M_{B} M_{N}}} = {\omega(\Gamma)_{LO}}^{2}</script></html></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Per als punts <span class="math notranslate nohighlight">\(K\)</span> i <span class="math notranslate nohighlight">\(M\)</span>, sagemath (mitjançant <a class="reference external" href="https://maxima.sourceforge.io/">maxima</a>) no obté una expressió analítica però si abans simplifique el problema, supossant que els 2 àtoms de la base tenen la mateixa massa  (<span class="math notranslate nohighlight">\(M_N=M_B\)</span>), sí que obtenim una solució analítica, i després podem obtindre els valors propis correctes per al nostre model realitzant les substitucions pertinents als resultats obtessos (cada constant apareix sempre dividida per l’arrel quadrada de les masses pertinenets)</p>
</div>
</div>
</div>
<div class="section" id="al-punt-m">
<h3>Al punt <span class="math notranslate nohighlight">\(M\)</span><a class="headerlink" href="#al-punt-m" title="Link permanent a aquest títol">¶</a></h3>
<p>En <span class="math notranslate nohighlight">\(\left(q_x=\frac{\pi}{a},q_y=\frac{\pi}{\sqrt 3 a}\right)\)</span></p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D_M3ers_xy</span><span class="o">=</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>

<span class="n">D_M3ers_xy_simplificada</span><span class="o">=</span><span class="n">D_M3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_N</span><span class="o">=</span><span class="n">M_B</span><span class="p">)</span>

<span class="n">Valors_propis_M3ers</span><span class="o">=</span><span class="n">D_M3ers_xy_simplificada</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>

<span class="n">Valors_propis_en_M3ers</span><span class="o">=</span><span class="p">[</span><span class="n">M_B</span><span class="o">*</span><span class="n">Valors_propis_M3ers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="n">phi1rBN</span><span class="o">=</span><span class="n">phi1rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi1tiBN</span><span class="o">=</span><span class="n">phi1tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> 
    <span class="n">phi2rBB</span><span class="o">=</span><span class="n">phi2rBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span> <span class="n">phi2tiBB</span><span class="o">=</span><span class="n">phi2tiBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span>
    <span class="n">phi2rNN</span><span class="o">=</span><span class="n">phi2rNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span> <span class="n">phi2tiNN</span><span class="o">=</span><span class="n">phi2tiNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span>
    <span class="n">phi3rBN</span><span class="o">=</span><span class="n">phi3rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi3tiBN</span><span class="o">=</span><span class="n">phi3tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
    <span class="c1">#phi4rBN=phi4rBN/sqrt(M_N*M_B), phi4tiBN=phi4tiBN/sqrt(M_N*M_B)</span>


<span class="n">omega_M_LO</span><span class="o">=</span><span class="mi">1320</span>
<span class="n">omega_M_TO</span><span class="o">=</span><span class="mi">1293</span>
<span class="n">omega_M_LA</span><span class="o">=</span><span class="mi">1174</span>
<span class="n">omega_M_TA</span><span class="o">=</span><span class="mi">553</span>
<span class="c1">#Comprobem que sí són els valors propis:</span>
<span class="c1">#[det(D_M3ers_xy-Valors_propis_en_M3ers[i]) for i in range(4)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">show</span><span class="p">(</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{2} \, \sqrt{\frac{9 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{8 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{72 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, \sqrt{\frac{9 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{8 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{72 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{72 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{8 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{72 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{8 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">((</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
<span class="n">show</span><span class="p">((</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{2 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{2 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{6 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{6 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{6 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{6 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{2 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{2 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div></div>
</div>
<p>Podem observar que els valors propis en M 0 i 1 (així com 2 i 3) difereixen en una arrel quadrada (negativa i per tant amb valor propi corresponent menor per a 0 i 2).
Per una altra banda els termes de fora de l’arrel sols difereixen en 2 i 3 respecte els de 1 i 2 que els termes <span class="math notranslate nohighlight">\(\phi_{2,r}\)</span> (<span class="math notranslate nohighlight">\(BB\)</span> i <span class="math notranslate nohighlight">\(NN\)</span>) van multiplicats pel factor 3 en el cas de <span class="math notranslate nohighlight">\(2\)</span> i <span class="math notranslate nohighlight">\(3\)</span> mentre que en <span class="math notranslate nohighlight">\(0\)</span> i <span class="math notranslate nohighlight">\(1\)</span> son els termes <span class="math notranslate nohighlight">\(\phi_{2,ti}\)</span> els que van multiplicats per 3.</p>
<p>Supossant que les constants de força radials són més grans que les transversals per assignar cada valor propi a cada rama, puc concloure que els dos primers valors propis corresponen al menor i al major respectivament. Els 3 i 4ts don intermijos, essent el 4t major que el tercer, per tant</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eq_M_TA3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMTA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_LO3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMLO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_LA3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMLA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_TO3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMTO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Eq_M_LA3ers = (Valors_propis_en_M3ers[0].expand() == omegaMTA^2)</span>
<span class="c1">#Eq_M_LO3ers = (Valors_propis_en_M3ers[1].expand() == omegaMLO^2)</span>
<span class="c1">#Eq_M_TA3ers = (Valors_propis_en_M3ers[2].expand() == omegaMLA^2)</span>
<span class="c1">#Eq_M_TO3ers = (Valors_propis_en_M3ers[3].expand() == omegaMTO^2)</span>

<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_LO3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_TO3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_LA3ers</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">Eq_M_TA3ers</span><span class="p">)</span>


<span class="c1">#Eq_M_TA_mes_M_LO3ers=(Eq_M_TA3ers + Eq_M_LO3ers)</span>
<span class="c1">#show(Eq_M_TA_mes_M_LO3ers)</span>
<span class="c1">#Eq_M_LA_mes_M_TO3ers=(Eq_M_LA3ers + Eq_M_TO3ers)</span>
<span class="c1">#show(Eq_M_LA_mes_M_TO3ers)</span>
<span class="c1">#Eq_M_LO_menys_TA3ers_quadrat=((Eq_M_LO3ers-Eq_M_TA3ers)**2).expand()</span>
<span class="c1">#show(Eq_M_LO_menys_TA3ers_quadrat)</span>
<span class="c1">#Eq_M_TO_menys_LA3ers_quadrat=((Eq_M_TO3ers-Eq_M_LA3ers)**2).expand()</span>
<span class="c1">#show(Eq_M_TO_menys_LA3ers_quadrat)</span>
<span class="c1">#Fem notar que la suma de tots els valors propis en $M$ compleix l&#39;equació:</span>
<span class="c1">#(3*Eq_M_LA_mes_M_TO3ers-Eq_M_TA_mes_M_LO3ers).subs(solve(Eq_Gamma_TO3ers,phi3rBN)).expand()</span>
<span class="c1">#(Eq_M_LA_mes_M_TO-3*Eq_M_TA_mes_M_LO).subs(solve(Eq_Gamma_TO,phi3rBN)).expand()</span>

<span class="c1">#show(Eq_M_TA3ers+Eq_M_LO3ers)</span>
<span class="c1">#show(Eq_M_LA3ers+Eq_M_TO3ers)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, \sqrt{\frac{9 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{8 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{72 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{LO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{72 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{8 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{TO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{72 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{8 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{LA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{2} \, \sqrt{\frac{9 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{6 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{8 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{24 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{24 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{72 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{36 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{18 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{6 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{TA}}^{2}</script></html></div></div>
</div>
</div>
<div class="section" id="al-punt-k">
<h3>Al punt <span class="math notranslate nohighlight">\(K\)</span><a class="headerlink" href="#al-punt-k" title="Link permanent a aquest títol">¶</a></h3>
<p>En <span class="math notranslate nohighlight">\(\left(k_x=\frac{4\pi}{3a}, k_y=0\right)\)</span></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_K_LO</span><span class="o">=</span><span class="mi">1305</span>
<span class="n">omega_K_TO</span><span class="o">=</span><span class="mi">1293</span>
<span class="n">omega_K_LA</span><span class="o">=</span><span class="mi">1080</span>
<span class="n">omega_K_TA</span><span class="o">=</span><span class="mi">879</span>

<span class="c1">#sqrt(omega_K_LO**2+omega_K_TA**2-omega_K_LA)</span>

<span class="n">D_K3ers_xy</span><span class="o">=</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1"># phi4tiBN=-phi4rBN)</span>
<span class="n">D_K3ers_xy_simplificada</span><span class="o">=</span><span class="n">D_K3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_N</span><span class="o">=</span><span class="n">M_B</span><span class="p">)</span>
<span class="n">Valors_propis_K3ers</span><span class="o">=</span><span class="n">D_K3ers_xy_simplificada</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>

<span class="n">Valors_propis_en_K3ers</span><span class="o">=</span><span class="p">[</span><span class="n">M_B</span><span class="o">*</span><span class="n">Valors_propis_K3ers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="n">phi1rBN</span><span class="o">=</span><span class="n">phi1rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi1tiBN</span><span class="o">=</span><span class="n">phi1tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> 
    <span class="n">phi2rBB</span><span class="o">=</span><span class="n">phi2rBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span> <span class="n">phi2tiBB</span><span class="o">=</span><span class="n">phi2tiBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span>
    <span class="n">phi2rNN</span><span class="o">=</span><span class="n">phi2rNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span> <span class="n">phi2tiNN</span><span class="o">=</span><span class="n">phi2tiNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span>
    <span class="n">phi3rBN</span><span class="o">=</span><span class="n">phi3rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi3tiBN</span><span class="o">=</span><span class="n">phi3tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
    <span class="c1">#phi4rBN=phi4rBN/sqrt(M_N*M_B), phi4tiBN=phi4tiBN/sqrt(M_N*M_B)) for i in range(4)]</span>

<span class="c1">#Comprobem que sí són els valors propis:</span>
<span class="c1">#[det(D_K_xy-Valors_propis_en_K[i]) for i in range(4)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">show</span><span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{NN}}}{2 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{2 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3}{4} \, \sqrt{\frac{4 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{18 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{8 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{8 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{4 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{4 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{3}{4} \, \sqrt{\frac{4 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{18 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{18 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{18 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{9 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{8 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{8 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{8 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{4 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{4 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{4 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">show</span><span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_N</span><span class="o">==</span><span class="n">M_B</span><span class="p">,</span> <span class="n">phi2rNN</span><span class="o">==</span><span class="n">phi2rBB</span><span class="p">,</span> <span class="n">phi2tiNN</span><span class="o">==</span><span class="n">phi2tiBB</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, M_{B}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, M_{B}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B}^{2}} + \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{3,r}^{BN}}^{2}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} + \frac{2 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} - \frac{2 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{3,ti}^{BN}}^{2}}{M_{B}^{2}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, M_{B}}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{3}{2} \, \sqrt{\frac{{\phi_{1,r}^{BN}}^{2}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{1,ti}^{BN}}^{2}}{M_{B}^{2}} + \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{3,r}^{BN}}^{2}}{M_{B}^{2}} - \frac{2 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} + \frac{2 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} - \frac{2 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B}^{2}} + \frac{{\phi_{3,ti}^{BN}}^{2}}{M_{B}^{2}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, M_{B}}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{2 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{2 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Comprobem que sí són els valors propis:</span>
<span class="p">[</span><span class="n">det</span><span class="p">(</span><span class="n">D_K3ers_xy</span><span class="o">-</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[0, 0, 0, 0\right]</script></html></div></div>
</div>
<p>Emprant un argument anàleg a l’emprat per als valors propis en <span class="math notranslate nohighlight">\(M\)</span> assignem cada valor propi a cadascuna de les rames, de manera que:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eq_K_LA3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKLA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_TO3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKTO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_TA3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKTA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_LO3ers</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKLO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">EqKTAmesEqKLO_3ers</span><span class="o">=</span><span class="p">(</span><span class="n">Eq_K_TA3ers</span><span class="o">+</span><span class="n">Eq_K_LO3ers</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">EqKTAmesEqKLO_3ers</span><span class="p">)</span>
<span class="c1">#show(Eq_K_TA3ers+Eq_K_LA3ers)</span>
<span class="c1">#show(omega_K_LO^2+omega_K_TO^2-(omega_K_TA^2+omega_K_LA^2))</span>
<span class="c1">#show(omega_K_TA^2+omega_K_LA^2-(omega_K_LO^2+omega_K_TO^2))</span>
<span class="c1">#Eq_KTA_mes_KLO3ers=(Eq_K_TA3ers + Eq_K_LO3ers)</span>
<span class="c1">#Eq_KLA_mes_KTO3ers=(Eq_K_LA3ers + Eq_K_TO3ers)</span>

<span class="c1">#show(Eq_K_LA3ers)</span>
<span class="c1">#show(Eq_K_TO3ers)</span>
<span class="c1">#show(Eq_K_TA3ers)</span>
<span class="c1">#show(Eq_K_LO3ers)</span>

<span class="c1">#Eq_KLO_menys_KTA_quadrat3ers=((Eq_K_LO3ers-Eq_K_TA3ers)**2).expand()</span>
<span class="c1">#Eq_KTO_menys_KLA_quadrat3ers=((Eq_K_TO3ers-Eq_K_LA3ers)**2).expand()</span>

<span class="c1">#Comprobem que sí són els valors propis:</span>
<span class="c1">#show(Eq_K_LA3ers.subs(constants).expand())</span>
<span class="c1">#show(Eq_K_TO3ers.subs(constants).expand())</span>

<span class="c1">#show(Eq_KLA_mes_KTO3ers.expand())</span>
<span class="c1">#show(Eq_KTA_mes_KLO3ers.expand())</span>
<span class="c1">#show(Eq_KLO_menys_KTA_quadrat3ers)</span>
<span class="c1">#show(Eq_KTO_menys_KLA_quadrat3ers)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{2 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{2 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{LO}}^{2} + {\omega(K)_{TA}}^{2}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valors_numerics_pla_emprats</span><span class="o">=</span><span class="p">[</span><span class="n">omegaGammaTO</span><span class="o">==</span><span class="n">omega_Gamma_TO</span><span class="p">,</span>\
                             <span class="n">omegaMLO</span><span class="o">==</span><span class="n">omega_M_LO</span><span class="p">,</span>\
                             <span class="n">omegaMTO</span><span class="o">==</span><span class="n">omega_M_TO</span><span class="p">,</span>\
                             <span class="n">omegaMLA</span><span class="o">==</span><span class="n">omega_M_LA</span><span class="p">,</span>\
                             <span class="n">omegaMTA</span><span class="o">==</span><span class="n">omega_M_TA</span><span class="p">,</span>\
                             <span class="n">omegaKLO</span><span class="o">==</span><span class="n">omega_K_LO</span><span class="p">,</span>\
                             <span class="n">omegaKTO</span><span class="o">==</span><span class="n">omega_K_TO</span><span class="p">,</span>\
                             <span class="n">omegaKLA</span><span class="o">==</span><span class="n">omega_K_LA</span><span class="p">,</span>\
                             <span class="n">omegaKTA</span><span class="o">==</span><span class="n">omega_K_TA</span><span class="p">,</span>\
                             <span class="n">M_B</span><span class="o">==</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">==</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span> \
                            <span class="p">]</span>
<span class="n">Equacionspla3ers</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_Gamma_TO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_LO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_TO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_LA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_TA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_LO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_TO3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_LA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_TA3ers</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">)]</span>

<span class="n">solucionspla3ers</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacionspla3ers</span><span class="p">))),</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">8000000.</span><span class="p">,</span><span class="o">-</span><span class="mi">75000</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
<span class="c1">#\[-140000,-300000.,1.,1.,1.,1.,1.,1.])</span>
<span class="n">Solucionspla3ers</span><span class="o">=</span><span class="p">[</span><span class="n">phi1rBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                  <span class="n">phi1tiBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                  <span class="n">phi2rBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                  <span class="n">phi2tiBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>\
                  <span class="n">phi2rNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>\
                  <span class="n">phi2tiNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>\
                  <span class="n">phi3rBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>\
                  <span class="n">phi3tiBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla3ers</span><span class="p">[</span><span class="mi">7</span><span class="p">])]</span>
                  
<span class="c1">#Solucionspla3ers</span>
<span class="c1">#Freqüències de Gamma a M (i les guardem com un dataframe). Calculem 200 punts en este interval</span>
<span class="n">freq_planol_Gamma_a_M</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">q_y</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_Gamma_a_M</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_Gamma_a_M</span><span class="p">)</span>

<span class="c1">#Freqüències de M a K (i les guardem com un dataframe). Calculem 100 punts en este interval</span>
<span class="n">freq_planol_M_a_K</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_M_a_K</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_M_a_K</span><span class="p">)</span>

<span class="c1">#Freqüències de K a Gamma (i les guardem com un dataframe). Calculem 124 punts en este interval</span>

<span class="n">freq_planol_K_a_Gamma</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D3ers_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla3ers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_K_a_Gamma</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_K_a_Gamma</span><span class="p">)</span>

<span class="n">DF_freq_calculades_planol</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">DF_freq_planol_Gamma_a_M</span><span class="p">,</span><span class="n">DF_freq_planol_M_a_K</span><span class="p">,</span>\
                                    <span class="n">DF_freq_planol_K_a_Gamma</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">DF_freq_calculades_planol</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;freq_calculades_planol.dat&quot;</span><span class="p">,</span>\
                                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dades_calculades_planol</span><span class="o">=</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;freq_calculades_planol.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dispersio3ers</span><span class="o">=</span><span class="p">(</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol3ers</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">524</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1500</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1350</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">1500</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">1350</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">860</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">860</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">380</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">480</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">410</span><span class="p">,</span><span class="mi">480</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">920</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">370</span><span class="p">,</span><span class="mi">900</span><span class="p">)))</span>

<span class="n">show</span><span class="p">(</span><span class="n">dispersio3ers</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">dispersio3ers</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/Dispersio3ers.pdf&quot;</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">dispersio3ers</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/Dispersio3ers.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_93_0.png" src="_images/formulacio_matriu_dinamica_93_0.png" />
</div>
</div>
</div>
<div class="section" id="id7">
<h3>Fins 4ts veïns<a class="headerlink" href="#id7" title="Link permanent a aquest títol">¶</a></h3>
<p>Ampliant lleugerament el codi emprat per considerar fins el quarts veïns millorem un poc l’ajust</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Autovalores en Gamma--------------------------------------------</span>
<span class="n">D_Gamma4ts_xy</span><span class="o">=</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Eq_Gamma_TO4ts</span><span class="o">=</span><span class="p">(</span><span class="n">D_Gamma4ts_xy</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">omegaGammaTO</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#----------------------------------------------------------------</span>

<span class="c1">#Autovalors en M-------------------------------------------------</span>

<span class="n">D_M4ts_xy</span><span class="o">=</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">,</span><span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>

<span class="c1">#Per calcular els autovalors en M simplifiquem la matriu</span>
<span class="n">D_M4ts_xy_simplificada</span><span class="o">=</span><span class="n">D_M4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_N</span><span class="o">=</span><span class="n">M_B</span><span class="p">)</span>

<span class="n">Valors_propis_M4ts</span><span class="o">=</span><span class="n">D_M4ts_xy_simplificada</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>

<span class="c1"># Y substituïm després en la solucio trobada</span>
<span class="n">Valors_propis_en_M4ts</span><span class="o">=</span><span class="p">[</span><span class="n">M_B</span><span class="o">*</span><span class="n">Valors_propis_M4ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="n">phi1rBN</span><span class="o">=</span><span class="n">phi1rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi1tiBN</span><span class="o">=</span><span class="n">phi1tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> 
    <span class="n">phi2rBB</span><span class="o">=</span><span class="n">phi2rBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span> <span class="n">phi2tiBB</span><span class="o">=</span><span class="n">phi2tiBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span>
    <span class="n">phi2rNN</span><span class="o">=</span><span class="n">phi2rNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span> <span class="n">phi2tiNN</span><span class="o">=</span><span class="n">phi2tiNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span>
    <span class="n">phi3rBN</span><span class="o">=</span><span class="n">phi3rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi3tiBN</span><span class="o">=</span><span class="n">phi3tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span>
    <span class="n">phi4rBN</span><span class="o">=</span><span class="n">phi4rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi4tiBN</span><span class="o">=</span><span class="n">phi4tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="c1">#Comprobem que realment son els valors propis de la matriu original</span>
<span class="n">show</span><span class="p">([</span><span class="n">det</span><span class="p">(</span><span class="n">D_M4ts_xy</span><span class="o">-</span><span class="n">Valors_propis_en_M4ts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>

<span class="c1">#Assignem a cada valor propi el su valor numèric</span>
<span class="n">Eq_M_TA4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M4ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMTA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_LO4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M4ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMLO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_LA4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMLA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_M_TO4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_M4ts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaMTO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#----------------------------------------------------------------</span>
<span class="n">Equacions_en_M</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_M_LO4ts</span><span class="p">,</span><span class="n">Eq_M_TO4ts</span><span class="p">,</span><span class="n">Eq_M_LA4ts</span><span class="p">,</span><span class="n">Eq_M_TA4ts</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">show</span><span class="p">(</span><span class="n">Equacions_en_M</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[0, 0, 0, 0\right]</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{14} \, \sqrt{\frac{441 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{49 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{392 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{3528 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{882 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{756 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{252 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{324 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{420 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{140 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{360 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{100 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{LO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{14} \, \sqrt{\frac{49 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{3528 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{392 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} - \frac{140 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{420 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{100 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{252 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{756 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{360 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{324 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{TO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{14} \, \sqrt{\frac{49 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{3528 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{392 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} - \frac{140 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{420 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{100 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{252 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{756 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{360 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{324 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{2,r}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,r}^{NN}}}{M_{N}} - \frac{{\phi_{2,ti}^{BB}}}{M_{B}} - \frac{{\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{LA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{1}{14} \, \sqrt{\frac{441 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{294 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{49 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{392 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{1176 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1176 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{3528 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{1764 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} - \frac{882 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{882 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{294 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{756 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{252 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{756 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{324 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{420 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{140 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{420 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{360 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{100 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{{\phi_{2,r}^{BB}}}{M_{B}} - \frac{{\phi_{2,r}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{2,ti}^{BB}}}{M_{B}} - \frac{3 \, {\phi_{2,ti}^{NN}}}{M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(M)_{TA}}^{2}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Autovalors en K</span>
<span class="n">D_K4ts_xy</span><span class="o">=</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1"># phi4tiBN=-phi4rBN)</span>
<span class="n">D_K4ts_xy_simplificada</span><span class="o">=</span><span class="n">D_K4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">M_N</span><span class="o">=</span><span class="n">M_B</span><span class="p">)</span>
<span class="n">Valors_propis_K4ts</span><span class="o">=</span><span class="n">D_K4ts_xy_simplificada</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>

<span class="n">Valors_propis_en_K4ts</span><span class="o">=</span><span class="p">[</span><span class="n">M_B</span><span class="o">*</span><span class="n">Valors_propis_K4ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="n">phi1rBN</span><span class="o">=</span><span class="n">phi1rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi1tiBN</span><span class="o">=</span><span class="n">phi1tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> 
    <span class="n">phi2rBB</span><span class="o">=</span><span class="n">phi2rBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span> <span class="n">phi2tiBB</span><span class="o">=</span><span class="n">phi2tiBB</span><span class="o">/</span><span class="n">M_B</span><span class="p">,</span>
    <span class="n">phi2rNN</span><span class="o">=</span><span class="n">phi2rNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span> <span class="n">phi2tiNN</span><span class="o">=</span><span class="n">phi2tiNN</span><span class="o">/</span><span class="n">M_N</span><span class="p">,</span>
    <span class="n">phi3rBN</span><span class="o">=</span><span class="n">phi3rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi3tiBN</span><span class="o">=</span><span class="n">phi3tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span>
    <span class="n">phi4rBN</span><span class="o">=</span><span class="n">phi4rBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">),</span> <span class="n">phi4tiBN</span><span class="o">=</span><span class="n">phi4tiBN</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M_N</span><span class="o">*</span><span class="n">M_B</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="n">Eq_K_LA4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K4ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKLA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_TO4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K4ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKTO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_TA4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKTA</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Eq_K_LO4ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">Valors_propis_en_K4ts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="n">omegaKLO</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">Equacions_en_K</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_K_LO4ts</span><span class="p">,</span><span class="n">Eq_K_TO4ts</span><span class="p">,</span><span class="n">Eq_K_LA4ts</span><span class="p">,</span><span class="n">Eq_K_TA4ts</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">show</span><span class="p">(</span><span class="n">Equacions_en_K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{3}{28} \, \sqrt{\frac{196 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{882 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{392 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{392 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} - \frac{728 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{676 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{728 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{1352 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{676 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{4 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{4 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{LO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{2 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{2 \, M_{B}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{TO}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{NN}}}{2 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{2 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{LA}}^{2}</script></html></div><div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{3}{28} \, \sqrt{\frac{196 \, {\phi_{1,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{1,ti}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{1,ti}^{BN}}^{2}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,r}^{BB}}^{2}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,r}^{NN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,r}^{NN}}^{2}}{M_{N}^{2}} + \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{BB}}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{BB}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,ti}^{BB}}^{2}}{M_{B}^{2}} - \frac{882 \, {\phi_{2,r}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{882 \, {\phi_{2,r}^{NN}} {\phi_{2,ti}^{NN}}}{M_{N}^{2}} - \frac{882 \, {\phi_{2,ti}^{BB}} {\phi_{2,ti}^{NN}}}{M_{B} M_{N}} + \frac{441 \, {\phi_{2,ti}^{NN}}^{2}}{M_{N}^{2}} + \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,ti}^{BN}} {\phi_{3,r}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{3,r}^{BN}}^{2}}{M_{B} M_{N}} - \frac{392 \, {\phi_{1,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{392 \, {\phi_{1,ti}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} - \frac{392 \, {\phi_{3,r}^{BN}} {\phi_{3,ti}^{BN}}}{M_{B} M_{N}} + \frac{196 \, {\phi_{3,ti}^{BN}}^{2}}{M_{B} M_{N}} - \frac{728 \, {\phi_{1,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{1,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{3,r}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{3,ti}^{BN}} {\phi_{4,r}^{BN}}}{M_{B} M_{N}} + \frac{676 \, {\phi_{4,r}^{BN}}^{2}}{M_{B} M_{N}} + \frac{728 \, {\phi_{1,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{1,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{728 \, {\phi_{3,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{728 \, {\phi_{3,ti}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} - \frac{1352 \, {\phi_{4,r}^{BN}} {\phi_{4,ti}^{BN}}}{M_{B} M_{N}} + \frac{676 \, {\phi_{4,ti}^{BN}}^{2}}{M_{B} M_{N}}} - \frac{3 \, {\phi_{1,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{1,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{9 \, {\phi_{2,r}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,r}^{NN}}}{4 \, M_{N}} - \frac{9 \, {\phi_{2,ti}^{BB}}}{4 \, M_{B}} - \frac{9 \, {\phi_{2,ti}^{NN}}}{4 \, M_{N}} - \frac{3 \, {\phi_{3,r}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{3,ti}^{BN}}}{2 \, \sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,r}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} - \frac{3 \, {\phi_{4,ti}^{BN}}}{\sqrt{M_{B}} \sqrt{M_{N}}} = {\omega(K)_{TA}}^{2}</script></html></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#----------------------------------------------------------------</span>
<span class="c1">#                 Càlcul de les constants de força</span>
<span class="n">valors_numerics_pla_emprats</span><span class="o">=</span><span class="p">[</span><span class="n">omegaGammaTO</span><span class="o">==</span><span class="n">omega_Gamma_TO</span><span class="p">,</span>\
                             <span class="n">omegaMLO</span><span class="o">==</span><span class="n">omega_M_LO</span><span class="p">,</span>\
                             <span class="n">omegaMTO</span><span class="o">==</span><span class="n">omega_M_TO</span><span class="p">,</span>\
                             <span class="n">omegaMLA</span><span class="o">==</span><span class="n">omega_M_LA</span><span class="p">,</span>\
                             <span class="n">omegaMTA</span><span class="o">==</span><span class="n">omega_M_TA</span><span class="p">,</span>\
                             <span class="n">omegaKLO</span><span class="o">==</span><span class="n">omega_K_LO</span><span class="p">,</span>\
                             <span class="n">omegaKTO</span><span class="o">==</span><span class="n">omega_K_TO</span><span class="p">,</span>\
                             <span class="n">omegaKLA</span><span class="o">==</span><span class="n">omega_K_LA</span><span class="p">,</span>\
                             <span class="n">omegaKTA</span><span class="o">==</span><span class="n">omega_K_TA</span><span class="p">,</span>\
                             <span class="n">M_B</span><span class="o">==</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">==</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span> \
                            <span class="p">]</span>
<span class="n">Equacionspla4ts</span><span class="o">=</span><span class="p">[</span><span class="n">Eq_Gamma_TO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>
                  <span class="n">Eq_M_LO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_TO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_LA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_M_TA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_LO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_TO4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_LA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">),</span>\
                  <span class="n">Eq_K_TA4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">valors_numerics_pla_emprats</span><span class="p">)]</span>

<span class="n">solucionspla4ts</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">Equacionspla4ts</span><span class="p">))),</span>\
                         <span class="p">[</span><span class="o">-</span><span class="mf">8000000.</span><span class="p">,</span><span class="o">-</span><span class="mf">75000.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
<span class="c1">#                         [-5332900.,1.,1.,1.,1.,1.,1.,1.,1.,1.])</span>
<span class="n">Solucionspla4ts</span><span class="o">=</span><span class="p">[</span><span class="n">phi1rBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                  <span class="n">phi1tiBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                  <span class="n">phi2rBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                  <span class="n">phi2tiBB</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>\
                  <span class="n">phi2rNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>\
                  <span class="n">phi2tiNN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>\
                  <span class="n">phi3rBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>\
                  <span class="n">phi3tiBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span>\
                  <span class="n">phi4rBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span>\
                  <span class="n">phi4tiBN</span><span class="o">==</span><span class="nb">round</span><span class="p">(</span><span class="n">solucionspla4ts</span><span class="p">[</span><span class="mi">9</span><span class="p">])]</span>
<span class="c1">#-----------------------------------------------------------------</span>
<span class="c1">#          Calculem les freqüències i grafiquem el diagrama de dispersió</span>
<span class="c1">#Freqüències de Gamma a M (i les guardem com un dataframe). Calculem 200 punts en este interval</span>
<span class="n">freq_planol_Gamma_a_M4ts</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">q_y</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_Gamma_a_M4ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_Gamma_a_M4ts</span><span class="p">)</span>
<span class="c1">#Freqüències de M a K (i les guardem com un dataframe). Calculem 100 punts en este interval</span>
<span class="n">freq_planol_M_a_K4ts</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">),</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_M_a_K4ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_M_a_K4ts</span><span class="p">)</span>

<span class="c1">#Freqüències de K a Gamma (i les guardem com un dataframe). Calculem 124 punts en este interval</span>

<span class="n">freq_planol_K_a_Gamma4ts</span><span class="o">=</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span>\
     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D4ts_xy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                    <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">)]))))</span>

<span class="n">DF_freq_planol_K_a_Gamma4ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">freq_planol_K_a_Gamma4ts</span><span class="p">)</span>

<span class="n">DF_freq_calculades_planol4ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">DF_freq_planol_Gamma_a_M4ts</span><span class="p">,</span><span class="n">DF_freq_planol_M_a_K4ts</span><span class="p">,</span>\
                                    <span class="n">DF_freq_planol_K_a_Gamma4ts</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">DF_freq_calculades_planol4ts</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;freq_calculades_planol4ts.dat&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dades_calculades_planol4ts</span><span class="o">=</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;freq_calculades_planol4ts.dat&quot;</span><span class="p">)</span>

<span class="n">dispersio4ts</span><span class="o">=</span><span class="p">(</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_perp_planol</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades_calculades_planol4ts</span><span class="p">[</span><span class="mi">300</span><span class="p">:</span><span class="mi">524</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[:</span><span class="mi">524</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">524</span><span class="p">:</span><span class="mi">1048</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1048</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">1572</span><span class="p">:</span><span class="mi">2096</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2096</span><span class="p">:</span><span class="mi">2620</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>\
<span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dades</span><span class="p">[</span><span class="mi">2620</span><span class="p">:</span><span class="mi">3144</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">300</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">line</span><span class="p">([(</span><span class="mi">524</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">524</span><span class="p">,</span><span class="mi">1600</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1500</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1350</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">1500</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">1350</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">860</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZO&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">860</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;ZA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">380</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">480</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;TA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">410</span><span class="p">,</span><span class="mi">480</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">920</span><span class="p">))</span><span class="o">+</span>\
<span class="n">text</span><span class="p">(</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">370</span><span class="p">,</span><span class="mi">900</span><span class="p">)))</span>

<span class="n">show</span><span class="p">(</span><span class="n">dispersio4ts</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/formulacio_matriu_dinamica_98_0.png" src="_images/formulacio_matriu_dinamica_98_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save</span><span class="p">(</span><span class="n">dispersio4ts</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/Dispersio4ts.pdf&quot;</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">dispersio4ts</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ticks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">524</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span> <span class="n">tick_formatter</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span><span class="s2">&quot;$M$&quot;</span><span class="p">,</span> <span class="s2">&quot;$K$&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">],</span><span class="mi">500</span><span class="p">],</span>\
     <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vector d</span><span class="se">\&#39;</span><span class="s1">ona reduït&#39;</span><span class="p">,</span><span class="s1">&#39;freqüència, $cm^{-1}$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;/home/casimir/Documents/Fisica/TFG/TFG-Semiconductores_2D/Grafiques/Dispersio4ts.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Podem observar que el model  proporciona un bon ajust per a les branques fora de pla, ZO i ZA, així com per a les acústiques en el pla, sobretot la TA. Per a la branca LA, sobretot en la part central, a altes freqüències, els resultats no són bons, però la corba té la forma pertinent (encara que les freqüències estan infravalorades).</p>
<p>A altes freqüències, per a les branques TO i sobretot LO el model no ajusta bé, el TO podem considerar que el model el descriu qualitativament.</p>
<p>Substituïm aquestes constants en la matriu <span class="math notranslate nohighlight">\(\mathbf D(\vec q)\)</span> <span class="math notranslate nohighlight">\(6x6\)</span> calcule els autovalors i autovectors per als 524 punts en que he discretitzat el recorregut per la primera zona de Brillouin. Tenim 6 autovalors i 6 autovectors en cadascun d’estos punts, de 6 components cada autovector (les 3 primeres son les components cartesianes del vector desplaçament per l’àtom de bor i les 3 últimes del de nitrogen). El resultat es guarda en un fitxer ,<em>matdyn_casi_4ts.modes</em>, amb el qual podem, emprant <a class="reference external" href="https://henriquemiranda.github.io/phononwebsite/index.html">TSS Physics - Home</a> visualitzar interactivament els modes de propagació al cristall de BN: polsant sobre qualsevol punt del diagrama de dispersió obtenim una simulació del moviment del àtoms del cristall:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="p">,</span><span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">([</span><span class="n">D4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
               <span class="n">q_x</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">q_y</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)])</span>

<span class="n">u2</span><span class="p">,</span><span class="n">v2</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">([</span><span class="n">D4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
               <span class="n">q_x</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">q_y</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)])</span>

<span class="n">u3</span><span class="p">,</span><span class="n">v3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">([</span><span class="n">D4ts</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Solucions4ts</span><span class="p">,</span> <span class="n">Solucionspla4ts</span><span class="p">,</span> <span class="n">M_B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">M_N</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
               <span class="n">q_x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="n">q_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex64&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;matdyn_casi_4ts.modes&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can not delete the file as it doesn&#39;t exists&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     diagonalizing the dynamical matrix ...</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">q_x</span><span class="p">,</span> <span class="n">q_y</span><span class="p">,</span> <span class="n">q_z</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="mi">199</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mf">0.0</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; q =       </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">q_x</span><span class="p">,</span><span class="n">q_y</span><span class="p">,</span><span class="n">q_z</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ordre</span><span class="o">=</span><span class="n">u1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">u1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">u1</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">ordre</span><span class="p">]</span>
        <span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">ordre</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;     omega(</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s1">2d</span><span class="si">}</span><span class="s1">) =      </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u1</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1"> [THz] =    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u1</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">11.6f</span><span class="si">}</span><span class="s1"> [cm-1]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>     
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     diagonalizing the dynamical matrix ...</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">q_x</span><span class="p">,</span> <span class="n">q_y</span><span class="p">,</span> <span class="n">q_z</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">99</span><span class="p">)),</span> <span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">99</span><span class="p">),</span> <span class="mf">0.0</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; q =       </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">q_x</span><span class="p">,</span><span class="n">q_y</span><span class="p">,</span><span class="n">q_z</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ordre</span><span class="o">=</span><span class="n">u2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">u2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">u2</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">ordre</span><span class="p">]</span>
        <span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">ordre</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;     omega(</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s1">2d</span><span class="si">}</span><span class="s1">) =      </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u2</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1"> [THz] =    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u2</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">11.6f</span><span class="si">}</span><span class="s1"> [cm-1]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>     
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>    

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">224</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;     diagonalizing the dynamical matrix ...</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">q_x</span><span class="p">,</span> <span class="n">q_y</span><span class="p">,</span> <span class="n">q_z</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">223</span><span class="p">),</span> <span class="mf">0.0</span> <span class="p">,</span> <span class="mf">0.0</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; q =       </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="s2">      </span><span class="si">%.4f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">q_x</span><span class="p">,</span><span class="n">q_y</span><span class="p">,</span><span class="n">q_z</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ordre</span><span class="o">=</span><span class="n">u3</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">u3</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">u3</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">ordre</span><span class="p">]</span>
        <span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">ordre</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;     omega(</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s1">2d</span><span class="si">}</span><span class="s1">) =      </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u3</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1"> [THz] =    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u3</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span><span class="si">:</span><span class="s1">11.6f</span><span class="si">}</span><span class="s1"> [cm-1]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ( </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">real_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">imag_part</span><span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="n">x</span><span class="p">][:,</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span><span class="si">:</span><span class="s1">9.6f</span><span class="si">}</span><span class="s1">   )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>     
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; **************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Solucionspla4ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[{\phi_{1,r}^{BN}} = \left(-6083041\right), {\phi_{1,ti}^{BN}} = \left(-1955334\right), {\phi_{2,r}^{BB}} = \left(-1181800\right), {\phi_{2,ti}^{BB}} = \left(-1310140\right), {\phi_{2,r}^{NN}} = \left(-264417\right), {\phi_{2,ti}^{NN}} = 1009685, {\phi_{3,r}^{BN}} = 253491, {\phi_{3,ti}^{BN}} = \left(-336637\right), {\phi_{4,r}^{BN}} = \left(-53183\right), {\phi_{4,ti}^{BN}} = 126435\right]</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://henriquemiranda.github.io/phononwebsite/phonon.html&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;100%&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;640&quot;</span> <span class="na">allowfullscreen</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\verb|<IPython.core.display.HTML|\phantom{\verb!x!}\verb|object>|</script></html></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            kernelName: "sagemath",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="introduccio.html" title="previous page">Introducció teòrica</a>
    <a class='right-next' id="next-link" href="Conclusions.html" title="next page">Conclusions / <em>Conclusions</em></a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          Per Casimiro Victoria Castillo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>